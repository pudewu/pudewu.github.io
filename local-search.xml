<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>JavaåŸºç¡€-æ³¨è§£æœºåˆ¶</title>
    <link href="/2021/11/05/Java%E6%B3%A8%E8%A7%A3%E6%9C%BA%E5%88%B6/"/>
    <url>/2021/11/05/Java%E6%B3%A8%E8%A7%A3%E6%9C%BA%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h2><h3 id="1-1-æ³¨è§£ï¼š"><a href="#1-1-æ³¨è§£ï¼š" class="headerlink" title="1.1 æ³¨è§£ï¼š"></a>1.1 <strong>æ³¨è§£ï¼š</strong></h3><blockquote><p>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œ<strong>æ³¨è§£æ˜¯ä¸€ç§æ ‡ç­¾ï¼Œå…¶å®è´¨ä¸Šå¯ä»¥è§†ä¸ºä¸€ç§ç‰¹æ®Šçš„æ³¨é‡Šï¼Œå¦‚æœæ²¡æœ‰è§£æå®ƒçš„ä»£ç ï¼Œå®ƒå¹¶ä¸æ¯”æ™®é€šæ³¨é‡Šå¼ºã€‚</strong>ã€‚</p></blockquote><p>è§£æä¸€ä¸ªæ³¨è§£å¾€å¾€æœ‰ä¸¤ç§å½¢å¼ï¼š</p><ul><li><strong>ç¼–è¯‘æœŸç›´æ¥çš„æ‰«æ</strong> - ç¼–è¯‘å™¨çš„æ‰«ææŒ‡çš„æ˜¯ç¼–è¯‘å™¨åœ¨å¯¹ java ä»£ç ç¼–è¯‘å­—èŠ‚ç çš„è¿‡ç¨‹ä¸­ä¼šæ£€æµ‹åˆ°æŸä¸ªç±»æˆ–è€…æ–¹æ³•è¢«ä¸€äº›æ³¨è§£ä¿®é¥°ï¼Œè¿™æ—¶å®ƒå°±ä¼šå¯¹äºè¿™äº›æ³¨è§£è¿›è¡ŒæŸäº›å¤„ç†ã€‚è¿™ç§æƒ…å†µåªé€‚ç”¨äº JDK å†…ç½®çš„æ³¨è§£ç±»ã€‚</li><li><strong>è¿è¡ŒæœŸçš„åå°„</strong> - å¦‚æœè¦è‡ªå®šä¹‰æ³¨è§£ï¼ŒJava ç¼–è¯‘å™¨æ— æ³•è¯†åˆ«å¹¶å¤„ç†è¿™ä¸ªæ³¨è§£ï¼Œå®ƒåªèƒ½æ ¹æ®è¯¥æ³¨è§£çš„ä½œç”¨èŒƒå›´æ¥é€‰æ‹©æ˜¯å¦ç¼–è¯‘è¿›å­—èŠ‚ç æ–‡ä»¶ã€‚å¦‚æœè¦å¤„ç†æ³¨è§£ï¼Œå¿…é¡»åˆ©ç”¨åå°„æŠ€æœ¯ï¼Œè¯†åˆ«è¯¥æ³¨è§£ä»¥åŠå®ƒæ‰€æºå¸¦çš„ä¿¡æ¯ï¼Œç„¶ååšç›¸åº”çš„å¤„ç†ã€‚</li></ul><h3 id="1-2æ³¨è§£ä¼˜ç‚¹"><a href="#1-2æ³¨è§£ä¼˜ç‚¹" class="headerlink" title="1.2æ³¨è§£ä¼˜ç‚¹"></a>1.2<strong>æ³¨è§£ä¼˜ç‚¹</strong></h3><ul><li><p>æ³¨è§£çš„å‡ºç°å¯ä»¥æ›¿ä»£ä¸€äº›ç°æœ‰çš„ç³»ç»Ÿï¼Œä¾‹å¦‚ XDocletï¼Œå®ƒæ˜¯ä¸€ç§ç‹¬ç«‹çš„æ–‡æ¡£åŒ–å·¥å…·ï¼Œä¸“é—¨è®¾è®¡ç”¨æ¥ç”Ÿæˆæ³¨è§£é£æ ¼çš„æ–‡æ¡£ã€‚ä¸ä¹‹ç›¸æ¯”ï¼Œæ³¨è§£æ˜¯çœŸæ­£è¯­è¨€å±‚çº§çš„æ¦‚å¿µï¼Œä»¥å‰æ„é€ å‡ºæ¥å°±äº«æœ‰ç¼–è¯‘å™¨çš„ç±»å‹æ£€æŸ¥ä¿æŠ¤ã€‚</p></li><li><p>æ³¨è§£åœ¨æºä»£ç çº§åˆ«ä¿å­˜æ‰€æœ‰ä¿¡æ¯è€Œä¸æ˜¯é€šè¿‡æ³¨é‡Šæ–‡å­—ï¼Œè¿™ä½¿å¾—ä»£ç æ›´åŠ æ•´æ´å’Œä¾¿äºç»´æŠ¤ã€‚é€šè¿‡ä½¿ç”¨æ‹“å±•çš„ annotation API æˆ–ç¨ååœ¨æœ¬ç« èŠ‚å¯ä»¥çœ‹åˆ°çš„å¤–éƒ¨çš„å­—èŠ‚ç å·¥å…·ç±»åº“ï¼Œä½ ä¼šæ‹¥æœ‰å¯¹æºä»£ç åŠå­—èŠ‚ç å¼ºå¤§çš„æ£€æŸ¥ä¸æ“ä½œèƒ½åŠ›ã€‚</p></li></ul><h3 id="1-3æ³¨è§£ç¼ºç‚¹"><a href="#1-3æ³¨è§£ç¼ºç‚¹" class="headerlink" title="1.3æ³¨è§£ç¼ºç‚¹:"></a>1.3<strong>æ³¨è§£ç¼ºç‚¹:</strong></h3><ul><li><p>å®ƒæ˜¯ä¸€ç§ä¾µå…¥å¼ç¼–ç¨‹ï¼Œå¢åŠ ç¨‹åºè€¦åˆåº¦ã€‚</p></li><li><p>è‡ªå®šä¹‰æ³¨è§£çš„å¤„ç†éœ€è¦åœ¨è¿è¡Œæ—¶ï¼Œé€šè¿‡åå°„æŠ€æœ¯æ¥è·å–å±æ€§ã€‚å¦‚æœæ³¨è§£æ‰€ä¿®é¥°çš„å…ƒç´ æ˜¯ç±»çš„é public æˆå‘˜ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åå°„è·å–ã€‚è¿™å°±è¿èƒŒäº†é¢å‘å¯¹è±¡çš„å°è£…æ€§ã€‚</p></li><li><p>æ³¨è§£æ‰€äº§ç”Ÿçš„é—®é¢˜ï¼Œç›¸å¯¹è€Œè¨€ï¼Œæ›´éš¾ä»¥ debug æˆ–å®šä½ã€‚</p></li></ul><h3 id="1-4-æ³¨è§£åº”ç”¨èŒƒå›´"><a href="#1-4-æ³¨è§£åº”ç”¨èŒƒå›´" class="headerlink" title="1.4 æ³¨è§£åº”ç”¨èŒƒå›´"></a><strong>1.4 æ³¨è§£åº”ç”¨èŒƒå›´</strong></h3><p>æ³¨è§£å¯ä»¥åº”ç”¨äºç±»ã€å­—æ®µã€æ–¹æ³•å’Œå…¶ä»–ç¨‹åºå…ƒç´ çš„å£°æ˜</p><p>JDK8 å¼€å§‹ï¼Œæ³¨è§£çš„åº”ç”¨èŒƒå›´è¿›ä¸€æ­¥æ‰©å¤§ï¼Œä»¥ä¸‹æ˜¯æ–°çš„åº”ç”¨èŒƒå›´ï¼š</p><p>ç±»å®ä¾‹åˆå§‹åŒ–è¡¨è¾¾å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">new</span> <span class="hljs-meta">@Interned</span> MyObject();<br></code></pre></td></tr></table></figure><p>ç±»å‹è½¬æ¢ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myString = (<span class="hljs-meta">@NonNull</span> String) str;<br></code></pre></td></tr></table></figure><p>å®ç°æ¥å£çš„å£°æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UnmodifiableList</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">implements</span></span><br><span class="hljs-class">    @<span class="hljs-title">Readonly</span> <span class="hljs-title">List</span>&lt;@<span class="hljs-title">Readonly</span> <span class="hljs-title">T</span>&gt; </span>&#123;&#125;<br></code></pre></td></tr></table></figure><p>æŠ›å‡ºå¼‚å¸¸å£°æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">monitorTemperature</span><span class="hljs-params">()</span></span><br><span class="hljs-function">    <span class="hljs-keyword">throws</span> @Critical TemperatureException </span>&#123;&#125;<br></code></pre></td></tr></table></figure><h2 id="2-å†…ç½®æ³¨è§£åŠå…ƒæ³¨è§£"><a href="#2-å†…ç½®æ³¨è§£åŠå…ƒæ³¨è§£" class="headerlink" title="2.å†…ç½®æ³¨è§£åŠå…ƒæ³¨è§£"></a>2.å†…ç½®æ³¨è§£åŠå…ƒæ³¨è§£</h2><h3 id="2-2-å†…ç½®æ³¨è§£"><a href="#2-2-å†…ç½®æ³¨è§£" class="headerlink" title="2.2 å†…ç½®æ³¨è§£"></a>2.2 å†…ç½®æ³¨è§£</h3><p>JDK ä¸­å†…ç½®äº†ä»¥ä¸‹æ³¨è§£ï¼š</p><ul><li><code>@Override</code></li><li><code>@Deprecated</code></li><li><code>@SuppressWarnnings</code></li><li><code>@SafeVarargs</code>ï¼ˆJDK7 å¼•å…¥ï¼‰</li><li><code>@FunctionalInterface</code>ï¼ˆJDK8 å¼•å…¥ï¼‰</li></ul><h4 id="2-2-1-Override"><a href="#2-2-1-Override" class="headerlink" title="2.2.1  @Override"></a><strong>2.2.1  @Override</strong></h4><p><strong>@Overrideç”¨äºè¡¨æ˜è¢«ä¿®é¥°æ–¹æ³•è¦†å†™äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚</strong></p><p>å¦‚æœè¯•å›¾ä½¿ç”¨ <code>@Override</code> æ ‡è®°ä¸€ä¸ªå®é™…ä¸Šå¹¶æ²¡æœ‰è¦†å†™çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œjava ç¼–è¯‘å™¨ä¼šå‘Šè­¦ã€‚</p><p><code>@Override</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OverrideAnnotationDemo</span> </span>&#123;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;getName&quot;</span>;<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Man</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Person</span> </span>&#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;override getName&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         *  æ”¾å¼€ä¸‹é¢çš„æ³¨é‡Šï¼Œç¼–è¯‘æ—¶ä¼šå‘Šè­¦</span><br><span class="hljs-comment">         */</span><br>       <span class="hljs-comment">/*</span><br><span class="hljs-comment">        @Override</span><br><span class="hljs-comment">        public String getName2() &#123;</span><br><span class="hljs-comment">            return &quot;override getName2&quot;;</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">        */</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-2-2-Deprecated"><a href="#2-2-2-Deprecated" class="headerlink" title="2.2.2@Deprecated"></a><strong>2.2.2@Deprecated</strong></h4><p><strong><code>@Deprecated</code> ç”¨äºæ ‡æ˜è¢«ä¿®é¥°çš„ç±»æˆ–ç±»æˆå‘˜ã€ç±»æ–¹æ³•å·²ç»åºŸå¼ƒã€è¿‡æ—¶ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚</strong></p><p><code>@Deprecated</code> æœ‰ä¸€å®šçš„<strong>å»¶ç»­æ€§</strong>ï¼šå¦‚æœæˆ‘ä»¬åœ¨ä»£ç ä¸­é€šè¿‡ç»§æ‰¿æˆ–è€…è¦†ç›–çš„æ–¹å¼ä½¿ç”¨äº†è¿‡æ—¶çš„ç±»æˆ–ç±»æˆå‘˜ï¼Œå³ä½¿å­ç±»æˆ–å­æ–¹æ³•æ²¡æœ‰æ ‡è®°ä¸º <code>@Deprecated</code>ï¼Œä½†ç¼–è¯‘å™¨ä»ç„¶ä¼šå‘Šè­¦ã€‚</p><blockquote><p> ğŸ”” æ³¨æ„ï¼š <code>@Deprecated</code> è¿™ä¸ªæ³¨è§£ç±»å‹å’Œ javadoc ä¸­çš„ <code>@deprecated</code> è¿™ä¸ª tag æ˜¯æœ‰åŒºåˆ«çš„ï¼šå‰è€…æ˜¯ java ç¼–è¯‘å™¨è¯†åˆ«çš„ï¼›è€Œåè€…æ˜¯è¢« javadoc å·¥å…·æ‰€è¯†åˆ«ç”¨æ¥ç”Ÿæˆæ–‡æ¡£ï¼ˆåŒ…å«ç¨‹åºæˆå‘˜ä¸ºä»€ä¹ˆå·²ç»è¿‡æ—¶ã€å®ƒåº”å½“å¦‚ä½•è¢«ç¦æ­¢æˆ–è€…æ›¿ä»£çš„æè¿°ï¼‰ã€‚</p></blockquote><h4 id="2-2-3-SuppressWarnnings"><a href="#2-2-3-SuppressWarnnings" class="headerlink" title="2.2.3 @SuppressWarnnings"></a><strong>2.2.3 @SuppressWarnnings</strong></h4><p><strong><code>@SuppressWarnings</code>ç”¨äºå…³é—­å¯¹ç±»ã€æ–¹æ³•ã€æˆå‘˜ç¼–è¯‘æ—¶äº§ç”Ÿçš„ç‰¹å®šè­¦å‘Šã€‚</strong></p><p><code>@SuppressWarning</code> ä¸æ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ã€‚å®ƒæœ‰ä¸€ä¸ªç±»å‹ä¸º <code>String[]</code> çš„æ•°ç»„æˆå‘˜ï¼Œè¿™ä¸ªæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯è¦å…³é—­çš„å‘Šè­¦ç±»å‹ã€‚å¯¹äº javac ç¼–è¯‘å™¨æ¥è®²ï¼Œå¯¹ <code>-Xlint</code> é€‰é¡¹æœ‰æ•ˆçš„è­¦å‘Šåä¹ŸåŒæ ·å¯¹ <code>@SuppressWarings</code> æœ‰æ•ˆï¼ŒåŒæ—¶ç¼–è¯‘å™¨ä¼šå¿½ç•¥æ‰æ— æ³•è¯†åˆ«çš„è­¦å‘Šåã€‚</p><p><code>@SuppressWarning</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;, &quot;unchecked&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SuppressWarningsAnnotationDemo</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SuppressDemo</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>        <span class="hljs-keyword">private</span> T value;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setValue</span><span class="hljs-params">(T <span class="hljs-keyword">var</span>)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.value = <span class="hljs-keyword">var</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&#123;&quot;deprecation&quot;&#125;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SuppressDemo d = <span class="hljs-keyword">new</span> SuppressDemo();<br>        d.setValue(<span class="hljs-string">&quot;å—äº¬&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;åœ°åï¼š&quot;</span> + d.getValue());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>@SuppressWarnings</code> æ³¨è§£çš„å¸¸è§å‚æ•°å€¼çš„ç®€å•è¯´æ˜ï¼š</p><ul><li><code>deprecation</code> - ä½¿ç”¨äº†ä¸èµæˆä½¿ç”¨çš„ç±»æˆ–æ–¹æ³•æ—¶çš„è­¦å‘Šï¼›</li><li><code>unchecked</code> - æ‰§è¡Œäº†æœªæ£€æŸ¥çš„è½¬æ¢æ—¶çš„è­¦å‘Šï¼Œä¾‹å¦‚å½“ä½¿ç”¨é›†åˆæ—¶æ²¡æœ‰ç”¨æ³›å‹ (Generics) æ¥æŒ‡å®šé›†åˆä¿å­˜çš„ç±»å‹;</li><li><code>fallthrough</code> - å½“ Switch ç¨‹åºå—ç›´æ¥é€šå¾€ä¸‹ä¸€ç§æƒ…å†µè€Œæ²¡æœ‰ Break æ—¶çš„è­¦å‘Š;</li><li><code>path</code> - åœ¨ç±»è·¯å¾„ã€æºæ–‡ä»¶è·¯å¾„ç­‰ä¸­æœ‰ä¸å­˜åœ¨çš„è·¯å¾„æ—¶çš„è­¦å‘Š;</li><li><code>serial</code> - å½“åœ¨å¯åºåˆ—åŒ–çš„ç±»ä¸Šç¼ºå°‘ serialVersionUID å®šä¹‰æ—¶çš„è­¦å‘Š;</li><li><code>finally</code> - ä»»ä½• finally å­å¥ä¸èƒ½æ­£å¸¸å®Œæˆæ—¶çš„è­¦å‘Š;</li><li><code>all</code> - æ‰€æœ‰çš„è­¦å‘Šã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SuppressWarnings(&#123;&quot;uncheck&quot;, &quot;deprecation&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InternalAnnotationDemo</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@SuppressWarnings</span> æ ‡è®°æ¶ˆé™¤å½“å‰ç±»çš„å‘Šè­¦ä¿¡æ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@SuppressWarnings(&#123;&quot;deprecation&quot;&#125;)</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method1</span><span class="hljs-params">()</span> </span>&#123;<br>            System.out.println(<span class="hljs-string">&quot;call method1&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@Deprecated</span> æ ‡è®°å½“å‰æ–¹æ³•ä¸ºåºŸå¼ƒæ–¹æ³•ï¼Œä¸å»ºè®®ä½¿ç”¨</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-meta">@Deprecated</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method2</span><span class="hljs-params">()</span> </span>&#123;<br>            System.out.println(<span class="hljs-string">&quot;call method2&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@Deprecated</span> æ ‡è®°å½“å‰ç±»ä¸ºåºŸå¼ƒç±»ï¼Œä¸å»ºè®®ä½¿ç”¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Deprecated</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">A</span> </span>&#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@Override</span> æ ‡è®°æ˜¾ç¤ºæŒ‡æ˜å½“å‰æ–¹æ³•è¦†å†™äº†çˆ¶ç±»æˆ–æ¥å£çš„æ–¹æ³•</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method1</span><span class="hljs-params">()</span> </span>&#123; &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        A obj = <span class="hljs-keyword">new</span> B();<br>        obj.method1();<br>        obj.method2();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-2-4-SafeVarargs"><a href="#2-2-4-SafeVarargs" class="headerlink" title="2.2.4 @SafeVarargs"></a><strong>2.2.4 @SafeVarargs</strong></h4><p><code>@SafeVarargs</code> åœ¨ JDK7 ä¸­å¼•å…¥ã€‚</p><p><strong><code>@SafeVarargs</code>çš„ä½œç”¨æ˜¯ï¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œåœ¨å¯å˜é•¿å‚æ•°ä¸­çš„æ³›å‹æ˜¯ç±»å‹å®‰å…¨çš„ã€‚å¯å˜é•¿å‚æ•°æ˜¯ä½¿ç”¨æ•°ç»„å­˜å‚¨çš„ï¼Œè€Œæ•°ç»„å’Œæ³›å‹ä¸èƒ½å¾ˆå¥½çš„æ··åˆä½¿ç”¨ã€‚</strong></p><p>ç®€å•çš„è¯´ï¼Œæ•°ç»„å…ƒç´ çš„æ•°æ®ç±»å‹åœ¨ç¼–è¯‘å’Œè¿è¡Œæ—¶éƒ½æ˜¯ç¡®å®šçš„ï¼Œè€Œæ³›å‹çš„æ•°æ®ç±»å‹åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šä¸‹æ¥ã€‚å› æ­¤ï¼Œå½“æŠŠä¸€ä¸ªæ³›å‹å­˜å‚¨åˆ°æ•°ç»„ä¸­æ—¶ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µæ— æ³•ç¡®è®¤æ•°æ®ç±»å‹æ˜¯å¦åŒ¹é…ï¼Œå› æ­¤ä¼šç»™å‡ºè­¦å‘Šä¿¡æ¯ï¼›å³å¦‚æœæ³›å‹çš„çœŸå®æ•°æ®ç±»å‹æ— æ³•å’Œå‚æ•°æ•°ç»„çš„ç±»å‹åŒ¹é…ï¼Œä¼šå¯¼è‡´ <code>ClassCastException</code> å¼‚å¸¸ã€‚</p><p><code>@SafeVarargs</code> æ³¨è§£ä½¿ç”¨èŒƒå›´ï¼š</p><ul><li><code>@SafeVarargs</code> æ³¨è§£å¯ä»¥ç”¨äºæ„é€ æ–¹æ³•ã€‚</li><li><code>@SafeVarargs</code> æ³¨è§£å¯ä»¥ç”¨äº <code>static</code> æˆ– <code>final</code> æ–¹æ³•ã€‚</li></ul><p><code>@SafeVarargs</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SafeVarargsAnnotationDemo</span> </span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ­¤æ–¹æ³•å®é™…ä¸Šå¹¶ä¸å®‰å…¨ï¼Œä¸ä½¿ç”¨æ­¤æ³¨è§£ï¼Œç¼–è¯‘æ—¶ä¼šå‘Šè­¦</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@SafeVarargs</span><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">wrongMethod</span><span class="hljs-params">(List&lt;String&gt;... stringLists)</span> </span>&#123;<br>        Object[] array = stringLists;<br>        List&lt;Integer&gt; tmpList = Arrays.asList(<span class="hljs-number">42</span>);<br>        array[<span class="hljs-number">0</span>] = tmpList; <span class="hljs-comment">// è¯­æ³•é”™è¯¯ï¼Œä½†æ˜¯ç¼–è¯‘ä¸å‘Šè­¦</span><br>        String s = stringLists[<span class="hljs-number">0</span>].get(<span class="hljs-number">0</span>); <span class="hljs-comment">// è¿è¡Œæ—¶æŠ¥ ClassCastException</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        List&lt;String&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        list.add(<span class="hljs-string">&quot;A&quot;</span>);<br>        list.add(<span class="hljs-string">&quot;B&quot;</span>);<br><br>        List&lt;String&gt; list2 = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        list.add(<span class="hljs-string">&quot;1&quot;</span>);<br>        list.add(<span class="hljs-string">&quot;2&quot;</span>);<br><br>        wrongMethod(list, list2);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç ï¼Œå¦‚æœä¸ä½¿ç”¨ <code>@SafeVarargs</code> ï¼Œç¼–è¯‘æ—¶ä¼šå‘Šè­¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">[WARNING] SafeVarargsAnnotationDemo.java: æŸäº›è¾“å…¥æ–‡ä»¶ä½¿ç”¨äº†æœªç»æ£€æŸ¥æˆ–ä¸å®‰å…¨çš„æ“ä½œã€‚<br>[WARNING] SafeVarargsAnnotationDemo.java: æœ‰å…³è¯¦ç»†ä¿¡æ¯, è¯·ä½¿ç”¨ -Xlint:unchecked é‡æ–°ç¼–è¯‘ã€‚<br></code></pre></td></tr></table></figure><h4 id="2-2-5-FunctionalInterface"><a href="#2-2-5-FunctionalInterface" class="headerlink" title="2.2.5 @FunctionalInterface"></a><strong>2.2.5 @FunctionalInterface</strong></h4><p><code>@FunctionalInterface</code> åœ¨ JDK8 å¼•å…¥ã€‚</p><p><strong><code>@FunctionalInterface</code>ç”¨äºæŒ‡ç¤ºè¢«ä¿®é¥°çš„æ¥å£æ˜¯å‡½æ•°å¼æ¥å£ã€‚</strong></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªæ¥å£ç¬¦åˆâ€å‡½æ•°å¼æ¥å£â€å®šä¹‰ï¼Œä¸åŠ  <code>@FunctionalInterface</code> ä¹Ÿæ²¡å…³ç³»ï¼›ä½†å¦‚æœç¼–å†™çš„ä¸æ˜¯å‡½æ•°å¼æ¥å£ï¼Œå´ä½¿ç”¨ <code>@FunctionInterface</code>ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</p><p>ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ï¼Ÿ</p><p><strong>å‡½æ•°å¼æ¥å£(Functional Interface)å°±æ˜¯ä¸€ä¸ªæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ªéæŠ½è±¡æ–¹æ³•çš„æ¥å£</strong>ã€‚å‡½æ•°å¼æ¥å£å¯ä»¥è¢«éšå¼è½¬æ¢ä¸º lambda è¡¨è¾¾å¼ã€‚</p><p>å‡½æ•°å¼æ¥å£çš„ç‰¹ç‚¹ï¼š</p><ul><li>æ¥å£æœ‰ä¸”åªèƒ½æœ‰ä¸ªä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼ˆæŠ½è±¡æ–¹æ³•åªæœ‰æ–¹æ³•å®šä¹‰ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼‰ã€‚</li><li>ä¸èƒ½åœ¨æ¥å£ä¸­è¦†å†™ Object ç±»ä¸­çš„ public æ–¹æ³•ï¼ˆå†™äº†ç¼–è¯‘å™¨ä¹Ÿä¼šæŠ¥é”™ï¼‰ã€‚</li><li>å…è®¸æœ‰ default å®ç°æ–¹æ³•ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FunctionalInterfaceAnnotationDemo</span> </span>&#123;<br><br>    <span class="hljs-meta">@FunctionalInterface</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Func1</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">printMessage</span><span class="hljs-params">(T message)</span></span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@FunctionalInterface</span> ä¿®é¥°çš„æ¥å£ä¸­å®šä¹‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç¼–è¯‘æ—¶ä¼šæŠ¥é”™</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> &lt;T&gt;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-comment">/*@FunctionalInterface</span><br><span class="hljs-comment">    public interface Func2&lt;T&gt; &#123;</span><br><span class="hljs-comment">        void printMessage(T message);</span><br><span class="hljs-comment">        void printMessage2(T message);</span><br><span class="hljs-comment">    &#125;*/</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Func1 func1 = message -&gt; System.out.println(message);<br>        func1.printMessage(<span class="hljs-string">&quot;Hello&quot;</span>);<br>        func1.printMessage(<span class="hljs-number">100</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-3-å…ƒæ³¨è§£"><a href="#2-3-å…ƒæ³¨è§£" class="headerlink" title="2.3 å…ƒæ³¨è§£"></a>2.3 å…ƒæ³¨è§£</h3><p>Java è¯­è¨€ä¸­ç›®å‰æœ‰ 5 ç§æ ‡å‡†æ³¨è§£ï¼ˆå‰é¢ä»‹ç»è¿‡ï¼‰ï¼Œä»¥åŠ 5 ç§å…ƒæ³¨è§£ã€‚å…ƒæ³¨è§£ç”¨äºæ³¨è§£å…¶ä»–çš„æ³¨è§£</p><p><strong>@Target</strong></p><p><strong><code>@Target</code> æŒ‡å®šæ³¨è§£å¯ä»¥ä¿®é¥°çš„å…ƒç´ ç±»å‹ã€‚</strong></p><p>**<code>@Target</code> **æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.ANNOTATION_TYPE)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Target &#123;<br>    ElementType[] value();<br>&#125;<br><br></code></pre></td></tr></table></figure><p><code>ElementType</code> æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå®ƒå®šä¹‰äº†è¢« <code>@Target</code> ä¿®é¥°çš„æ³¨è§£å¯ä»¥åº”ç”¨çš„èŒƒå›´ï¼š</p><ul><li><code>ElementType.ANNOTATION_TYPE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ³¨è§£ç±»å‹ã€‚</li><li><code>ElementType.CONSTRUCTOR</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ„é€ å‡½æ•°ã€‚</li><li><code>ElementType.FIELD</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºå­—æ®µæˆ–å±æ€§ã€‚</li><li><code>ElementType.LOCAL_VARIABLE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºå±€éƒ¨å˜é‡ã€‚</li><li><code>ElementType.METHOD</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ–¹æ³•ã€‚</li><li><code>ElementType.PACKAGE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºåŒ…å£°æ˜ã€‚</li><li><code>ElementType.PARAMETER</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ–¹æ³•çš„å‚æ•°ã€‚</li><li><code>ElementType.TYPE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºç±»çš„ä»»ä½•å…ƒç´ ã€‚</li></ul><p><code>@Target</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.TYPE)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Table &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ•°æ®è¡¨åç§°æ³¨è§£ï¼Œé»˜è®¤å€¼ä¸ºç±»åç§°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">tableName</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;className&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">@Target(ElementType.FIELD)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> NoDBColumn &#123;&#125;<br></code></pre></td></tr></table></figure><p><strong>@Retention</strong></p><p><code>@Retention</code><strong>æŒ‡æ˜äº†æ³¨è§£çš„ä¿ç•™çº§åˆ«</strong></p><p><code>@Retention</code>æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target(ElementType.ANNOTATION_TYPE)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Retention &#123;<br>    <span class="hljs-function">RetentionPolicy <span class="hljs-title">value</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>RetentionPolicy</code> æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå®ƒå®šä¹‰äº†è¢« <code>@Retention</code> ä¿®é¥°çš„æ³¨è§£æ‰€æ”¯æŒçš„ä¿ç•™çº§åˆ«ï¼š</p><ul><li><code>RetentionPolicy.SOURCE</code> - æ ‡è®°çš„æ³¨è§£ä»…åœ¨æºæ–‡ä»¶ä¸­æœ‰æ•ˆï¼Œç¼–è¯‘å™¨ä¼šå¿½ç•¥ã€‚</li><li><code>RetentionPolicy.CLASS</code> - æ ‡è®°çš„æ³¨è§£åœ¨ class æ–‡ä»¶ä¸­æœ‰æ•ˆï¼ŒJVM ä¼šå¿½ç•¥ã€‚</li><li><code>RetentionPolicy.RUNTIME</code> - æ ‡è®°çš„æ³¨è§£åœ¨è¿è¡Œæ—¶æœ‰æ•ˆã€‚</li></ul><p><code>@Retention</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.FIELD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Column &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">name</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;fieldName&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">setFuncName</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;setField&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getFuncName</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;getField&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">defaultDBValue</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">false</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>@Documented</strong></p><p><code>@Documented</code>è¡¨ç¤ºæ— è®ºä½•æ—¶ä½¿ç”¨æŒ‡å®šçš„æ³¨è§£ï¼Œéƒ½åº”ä½¿ç”¨ Javadocï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œæ³¨é‡Šä¸åŒ…å«åœ¨ Javadoc ä¸­ï¼‰</p><p><code>@Documented</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.FIELD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Column &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">name</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;fieldName&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">setFuncName</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;setField&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getFuncName</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;getField&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">defaultDBValue</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">false</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>@Interited</strong></p><p><strong><code>@Inherited</code> è¡¨ç¤ºæ³¨è§£ç±»å‹å¯ä»¥è¢«ç»§æ‰¿ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸æ˜¯è¿™æ ·ï¼‰</strong>ã€‚</p><p>è¡¨ç¤ºè‡ªåŠ¨ç»§æ‰¿æ³¨è§£ç±»å‹ã€‚ å¦‚æœæ³¨è§£ç±»å‹å£°æ˜ä¸­å­˜åœ¨ <code>@Inherited</code> å…ƒæ³¨è§£ï¼Œåˆ™æ³¨è§£æ‰€ä¿®é¥°ç±»çš„æ‰€æœ‰å­ç±»éƒ½å°†ä¼šç»§æ‰¿æ­¤æ³¨è§£ã€‚</p><blockquote><p>ğŸ”” æ³¨æ„ï¼š<code>@Inherited</code> æ³¨è§£ç±»å‹æ˜¯è¢«æ ‡æ³¨è¿‡çš„ç±»çš„å­ç±»æ‰€ç»§æ‰¿ã€‚ç±»å¹¶ä¸ä»å®ƒæ‰€å®ç°çš„æ¥å£ç»§æ‰¿æ³¨è§£ï¼Œæ–¹æ³•å¹¶ä¸ä»å®ƒæ‰€è¦†å†™çš„æ–¹æ³•ç»§æ‰¿æ³¨è§£ã€‚</p><p>æ­¤å¤–ï¼Œå½“ <code>@Inherited</code> ç±»å‹æ ‡æ³¨çš„æ³¨è§£çš„ <code>@Retention</code> æ˜¯ <code>RetentionPolicy.RUNTIME</code>ï¼Œåˆ™åå°„ API å¢å¼ºäº†è¿™ç§ç»§æ‰¿æ€§ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ <code>java.lang.reflect</code> å»æŸ¥è¯¢ä¸€ä¸ª <code>@Inherited</code> ç±»å‹çš„æ³¨è§£æ—¶ï¼Œåå°„ä»£ç æ£€æŸ¥å°†å±•å¼€å·¥ä½œï¼šæ£€æŸ¥ç±»å’Œå…¶çˆ¶ç±»ï¼Œç›´åˆ°å‘ç°æŒ‡å®šçš„æ³¨è§£ç±»å‹è¢«å‘ç°ï¼Œæˆ–è€…åˆ°è¾¾ç±»ç»§æ‰¿ç»“æ„çš„é¡¶å±‚ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Inherited</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Greeting &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">FontColor</span></span>&#123; BULE,RED,GREEN&#125;;<br>    <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function">FontColor <span class="hljs-title">fontColor</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> FontColor.GREEN</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>@Repeatable</strong></p><p><strong><code>@Repeatable</code> è¡¨ç¤ºæ³¨è§£å¯ä»¥é‡å¤ä½¿ç”¨ï¼ˆJava 8æ–°ç‰¹æ€§ï¼‰ã€‚</strong></p><p>ä»¥ Spring <code>@Scheduled</code> ä¸ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(&#123;ElementType.METHOD, ElementType.ANNOTATION_TYPE&#125;)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Schedules &#123;<br>Scheduled[] value();<br>&#125;<br><br><span class="hljs-meta">@Target(&#123;ElementType.METHOD, ElementType.ANNOTATION_TYPE&#125;)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Repeatable(Schedules.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Scheduled &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åº”ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TaskRunner</span> </span>&#123;<br><br>    <span class="hljs-meta">@Scheduled(&quot;0 0/15 * * * ?&quot;)</span><br>    <span class="hljs-meta">@Scheduled(&quot;0 0 12 * ?&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">task1</span><span class="hljs-params">()</span> </span>&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="3-åŸºæœ¬è¯­æ³•"><a href="#3-åŸºæœ¬è¯­æ³•" class="headerlink" title="3.åŸºæœ¬è¯­æ³•"></a>3.åŸºæœ¬è¯­æ³•</h2><p>åœ¨ä¸‹é¢ä¸¾ä¾‹ä¸­ï¼Œä½¿ç”¨@Testå¯¹<code>testExcute</code>è¿›è¡Œæ³¨è§£ã€‚è¯¥æ³¨è§£æœ¬èº«ä¸åšä»»ä½•æ“ä½œï¼Œä½†æ˜¯ç¼–è¯‘å™¨è¦ä¿è¯ç±»è·¯å¾„ä¸Šæœ‰<code>@Test</code>æ³¨è§£çš„å®šä¹‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestTable</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Executing ... &quot;</span>);<br>    &#125;<br><br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testExecute</span><span class="hljs-params">()</span> </span>&#123;<br>        execute();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¢«æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•å’Œå…¶ä»–çš„æ–¹æ³•æ²¡æœ‰ä»»ä½•åŒºåˆ«,æ³¨è§£ <code>@Test</code>å¯ä»¥å’Œä»»ä½•ä¿®é¥°ç¬¦å…±åŒç”¨äºæ–¹æ³•ï¼Œè¯¸å¦‚ <strong>public</strong>ã€<strong>static</strong> æˆ– <strong>void</strong>ã€‚ä»è¯­æ³•çš„è§’åº¦ä¸Šçœ‹ï¼Œæ³¨è§£çš„ä½¿ç”¨æ–¹å¼å’Œä¿®é¥°ç¬¦çš„ä½¿ç”¨æ–¹å¼ä¸€è‡´ã€‚</p><h3 id="3-1-å®šä¹‰æ³¨è§£"><a href="#3-1-å®šä¹‰æ³¨è§£" class="headerlink" title="3.1 å®šä¹‰æ³¨è§£"></a>3.1 å®šä¹‰æ³¨è§£</h3><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªæ³¨è§£çš„å®šä¹‰ã€‚æ³¨è§£çš„å®šä¹‰çœ‹èµ·æ¥å¾ˆåƒæ¥å£çš„å®šä¹‰ã€‚äº‹å®ä¸Šï¼Œå®ƒä»¬å’Œå…¶ä»– Java æ¥å£ä¸€æ ·ï¼Œä¹Ÿä¼šè¢«ç¼–è¯‘æˆ class æ–‡ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Test &#123;&#125;<br></code></pre></td></tr></table></figure><p>é™¤äº† @ ç¬¦å·ä¹‹å¤–ï¼Œ <code>@Test</code> çš„å®šä¹‰çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªç©ºæ¥å£ã€‚æ³¨è§£çš„å®šä¹‰ä¹Ÿéœ€è¦ä¸€äº›å…ƒæ³¨è§£ï¼ˆmeta-annoationï¼‰ï¼Œæ¯”å¦‚ <code>@Target</code> å’Œ <code>@Retention</code>ã€‚<code>@Target</code> å®šä¹‰ä½ çš„æ³¨è§£å¯ä»¥åº”ç”¨åœ¨å“ªé‡Œï¼ˆä¾‹å¦‚æ˜¯æ–¹æ³•è¿˜æ˜¯å­—æ®µï¼‰ã€‚<code>@Retention</code> å®šä¹‰äº†æ³¨è§£åœ¨å“ªé‡Œå¯ç”¨ï¼Œåœ¨æºä»£ç ä¸­(SOURCE)ï¼Œclass æ–‡ä»¶(CLASS)ä¸­æˆ–è€…æ˜¯åœ¨è¿è¡Œæ—¶(RUNTIME)ã€‚</p><blockquote><p> æ ‡è®°æ³¨è§£</p></blockquote><p>ä¸åŒ…å«ä»»ä½•å…ƒç´ çš„æ³¨è§£ç§°ä¸ºæ ‡è®°æ³¨è§£ï¼ˆmarker annotationï¼‰ï¼Œä¾‹å¦‚ä¸Šä¾‹ä¸­çš„ <code>@Test</code> å°±æ˜¯æ ‡è®°æ³¨è§£ã€‚</p><h3 id="3-2-æ³¨è§£ä½¿ç”¨"><a href="#3-2-æ³¨è§£ä½¿ç”¨" class="headerlink" title="3.2 æ³¨è§£ä½¿ç”¨"></a>3.2 æ³¨è§£ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> UseCase &#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">id</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function">String <span class="hljs-title">description</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;no description&quot;</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„ <strong>id</strong> å’Œ <strong>description</strong> ä¸æ–¹æ³•å®šä¹‰ç±»ä¼¼ã€‚ç”±äºç¼–è¯‘å™¨ä¼šå¯¹ <strong>id</strong> è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå› æ­¤å°†è·Ÿè¸ªæ•°æ®åº“ä¸ç”¨ä¾‹æ–‡æ¡£å’Œæºä»£ç ç›¸å…³è”æ˜¯å¯é çš„æ–¹å¼ã€‚<strong>description</strong> å…ƒç´ æ‹¥æœ‰ä¸€ä¸ª <strong>default</strong> å€¼ï¼Œå¦‚æœåœ¨æ³¨è§£æŸä¸ªæ–¹æ³•æ—¶æ²¡æœ‰ç»™å‡º <strong>description</strong> çš„å€¼ã€‚åˆ™è¯¥æ³¨è§£çš„å¤„ç†å™¨ä¼šä½¿ç”¨æ­¤å…ƒç´ çš„é»˜è®¤å€¼ã€‚</p><p>ä»¥ä¸‹ä¾‹å­ä¸­ï¼Œå°†æœ‰ä¸‰ä¸ªæ–¹æ³•è¢«æ³¨è§£ä¸ºç”¨ä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PasswordUtils</span> </span>&#123;<br><br>    <span class="hljs-meta">@UseCase(id = 2,description = &quot;Passwords must contain at least one numeric&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">validatePassword</span><span class="hljs-params">(String password)</span> </span>&#123;<br><br>        <span class="hljs-keyword">return</span> (password.matches(<span class="hljs-string">&quot;\\w*\\d\\w*&quot;</span>));<br>    &#125;<br><br>    <span class="hljs-meta">@UseCase(id = 3)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">encryptPassword</span><span class="hljs-params">(String passwd)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> StringBuilder(passwd)<br>                .reverse().toString();<br>    &#125;<br><br>    <span class="hljs-meta">@UseCase(id = 4,description = &quot;New passwords can&#x27;t equal previously used ones&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">checkForNewPassword</span><span class="hljs-params">(List&lt;String&gt; prevPasswords, String passwd)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> !prevPasswords.contains(passwd);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨è§£çš„å…ƒç´ åœ¨ä½¿ç”¨æ—¶è¡¨ç°ä¸º å-å€¼ å¯¹çš„å½¢å¼ï¼Œå¹¶ä¸”éœ€è¦æ”¾ç½®åœ¨ <code>@UseCase</code> å£°æ˜ä¹‹åçš„æ‹¬å·å†…ã€‚åœ¨ <code>encryptPassword()</code> æ–¹æ³•çš„æ³¨è§£ä¸­ï¼Œå¹¶æ²¡æœ‰ç»™å‡º <strong>description</strong> çš„é»˜è®¤å€¼ï¼Œæ‰€ä»¥åœ¨ <strong>@interface UseCase</strong> çš„æ³¨è§£å¤„ç†å™¨åˆ†æå¤„ç†è¿™ä¸ªç±»çš„æ—¶å€™ä¼šä½¿ç”¨è¯¥å…ƒç´ çš„é»˜è®¤å€¼ã€‚</p><h3 id="3-3-æ³¨è§£å¤„ç†å™¨"><a href="#3-3-æ³¨è§£å¤„ç†å™¨" class="headerlink" title="3.3 æ³¨è§£å¤„ç†å™¨"></a>3.3 æ³¨è§£å¤„ç†å™¨</h3><blockquote><p>å¦‚æœæ²¡æœ‰ç”¨äºè¯»å–æ³¨è§£çš„å·¥å…·ï¼Œé‚£ä¹ˆæ³¨è§£ä¸ä¼šæ¯”æ³¨é‡Šæ›´æœ‰ç”¨ã€‚ä½¿ç”¨æ³¨è§£ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„éƒ¨åˆ†å°±æ˜¯ï¼Œåˆ›å»ºä¸ä½¿ç”¨æ³¨è§£å¤„ç†å™¨ã€‚Java æ‹“å±•äº†åå°„æœºåˆ¶çš„ API ç”¨äºå¸®åŠ©ä½ åˆ›é€ è¿™ç±»å·¥å…·ã€‚åŒæ—¶ä»–è¿˜æä¾›äº† javac ç¼–è¯‘å™¨é’©å­åœ¨ç¼–è¯‘æ—¶ä½¿ç”¨æ³¨è§£ã€‚</p></blockquote><p>ä¸‹é¢æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ³¨è§£å¤„ç†å™¨ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥è¯»å–è¢«æ³¨è§£çš„ <strong>PasswordUtils</strong> ç±»ï¼Œå¹¶ä¸”ä½¿ç”¨åå°„æœºåˆ¶æ¥å¯»æ‰¾ <strong>@UseCase</strong> æ ‡è®°ã€‚ç»™å®šä¸€ç»„ <strong>id</strong> å€¼ï¼Œç„¶ååˆ—å‡ºåœ¨ <strong>PasswordUtils</strong> ä¸­æ‰¾åˆ°çš„ç”¨ä¾‹ï¼Œä»¥åŠç¼ºå¤±çš„ç”¨ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UseCaseTracker</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">trackUseCases</span><span class="hljs-params">(List&lt;Integer&gt; useCases,Class&lt;?&gt; cl)</span> </span>&#123;<br><br>        <span class="hljs-keyword">for</span> (Method method : cl.getDeclaredMethods()) &#123;<br>            UseCase useCase = method.getAnnotation(UseCase.class);<br><br>            <span class="hljs-keyword">if</span> (useCase != <span class="hljs-keyword">null</span> ) &#123;<br>                System.out.println(<span class="hljs-string">&quot;Found Use Case&quot;</span> + useCase.id() + <span class="hljs-string">&quot;\n&quot;</span> + useCase.description());<br>                useCases.remove(Integer.valueOf(useCase.id()));<br>            &#125;<br>        &#125;<br><br>        useCases.forEach(e -&gt; &#123;<br>            System.out.println(<span class="hljs-string">&quot;Missing use case &quot;</span> + e);<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        List&lt;Integer&gt; useCases = IntStream.range(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>).boxed().collect(Collectors.toList());<br><br>        trackUseCases(useCases,PasswordUtils.class);<br><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è¯´æ˜:</strong></p><p>è¿™ä¸ªç¨‹åºç”¨äº†ä¸¤ä¸ªåå°„çš„æ–¹æ³•ï¼š<code>getDeclaredMethods()</code> å’Œ <code>getAnnotation()</code>ï¼Œå®ƒä»¬éƒ½å±äº <strong>AnnotatedElement</strong> æ¥å£ï¼ˆ<strong>Class</strong>ï¼Œ<strong>Method</strong> ä¸ <strong>Field</strong> ç±»éƒ½å®ç°äº†è¯¥æ¥å£ï¼‰ã€‚<code>getAnnotation()</code> æ–¹æ³•è¿”å›æŒ‡å®šç±»å‹çš„æ³¨è§£å¯¹è±¡ï¼Œåœ¨æœ¬ä¾‹ä¸­å°±æ˜¯ â€œ<strong>UseCase</strong>â€ã€‚å¦‚æœè¢«æ³¨è§£çš„æ–¹æ³•ä¸Šæ²¡æœ‰è¯¥ç±»å‹çš„æ³¨è§£ï¼Œè¿”å›å€¼å°±ä¸º <strong>null</strong>ã€‚æˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>id()</code> å’Œ <code>description()</code> æ–¹æ³•æ¥æå–å…ƒç´ å€¼ã€‚æ³¨æ„ <code>encryptPassword()</code> æ–¹æ³•åœ¨æ³¨è§£çš„æ—¶å€™æ²¡æœ‰æŒ‡å®š <strong>description</strong> çš„å€¼ï¼Œå› æ­¤å¤„ç†å™¨åœ¨å¤„ç†å®ƒå¯¹åº”çš„æ³¨è§£æ—¶ï¼Œé€šè¿‡ <code>description()</code> å–å¾—çš„æ˜¯é»˜è®¤å€¼ â€œno descriptionâ€ã€‚</p><h3 id="3-4-æ³¨è§£å…ƒç´ "><a href="#3-4-æ³¨è§£å…ƒç´ " class="headerlink" title="3.4 æ³¨è§£å…ƒç´ "></a>3.4 æ³¨è§£å…ƒç´ </h3><p>åœ¨ <strong>UseCase.java</strong> ä¸­å®šä¹‰çš„ <strong>@UseCase</strong> çš„æ ‡ç­¾åŒ…å« int å…ƒç´  <strong>id</strong> å’Œ String å…ƒç´  <strong>description</strong>ã€‚æ³¨è§£å…ƒç´ å¯ç”¨çš„ç±»å‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>æ‰€æœ‰åŸºæœ¬ç±»å‹ï¼ˆintã€floatã€boolean ç­‰ï¼‰</li><li>String</li><li>Class</li><li>enum</li><li>Annotation</li><li>ä»¥ä¸Šç±»å‹çš„æ•°ç»„</li></ul><p>å¦‚æœä½ ä½¿ç”¨äº†å…¶ä»–ç±»å‹ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥é”™ã€‚æ³¨æ„ï¼Œä¹Ÿä¸å…è®¸ä½¿ç”¨ä»»ä½•åŒ…è£…ç±»å‹ï¼Œä½†æ˜¯ç”±äºè‡ªåŠ¨è£…ç®±çš„å­˜åœ¨ï¼Œè¿™ä¸ç®—æ˜¯ä»€ä¹ˆé™åˆ¶ã€‚æ³¨è§£ä¹Ÿå¯ä»¥ä½œä¸ºå…ƒç´ çš„ç±»å‹ã€‚ç¨åä½ ä¼šçœ‹åˆ°ï¼Œæ³¨è§£åµŒå¥—æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æŠ€å·§ã€‚</p><h3 id="3-5-é»˜è®¤å€¼é™åˆ¶"><a href="#3-5-é»˜è®¤å€¼é™åˆ¶" class="headerlink" title="3.5 é»˜è®¤å€¼é™åˆ¶"></a>3.5 é»˜è®¤å€¼é™åˆ¶</h3><p>ç¼–è¯‘å™¨å¯¹äºå…ƒç´ çš„é»˜è®¤å€¼æœ‰äº›è¿‡äºæŒ‘å‰”ã€‚é¦–å…ˆï¼Œå…ƒç´ ä¸èƒ½æœ‰ä¸ç¡®å®šçš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…ƒç´ è¦ä¹ˆæœ‰é»˜è®¤å€¼ï¼Œè¦ä¹ˆå°±åœ¨ä½¿ç”¨æ³¨è§£æ—¶æä¾›å…ƒç´ çš„å€¼ã€‚</p><p>è¿™é‡Œæœ‰å¦å¤–ä¸€ä¸ªé™åˆ¶ï¼šä»»ä½•éåŸºæœ¬ç±»å‹çš„å…ƒç´ ï¼Œ æ— è®ºæ˜¯åœ¨æºä»£ç å£°æ˜æ—¶è¿˜æ˜¯åœ¨æ³¨è§£æ¥å£ä¸­å®šä¹‰é»˜è®¤å€¼æ—¶ï¼Œéƒ½ä¸èƒ½ä½¿ç”¨ null ä½œä¸ºå…¶å€¼ã€‚è¿™ä¸ªé™åˆ¶ä½¿å¾—å¤„ç†å™¨å¾ˆéš¾è¡¨ç°ä¸€ä¸ªå…ƒç´ çš„å­˜åœ¨æˆ–è€…ç¼ºå¤±çš„çŠ¶æ€ï¼Œå› ä¸ºåœ¨æ¯ä¸ªæ³¨è§£çš„å£°æ˜ä¸­ï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½å­˜åœ¨ï¼Œå¹¶ä¸”å…·æœ‰ç›¸åº”çš„å€¼ã€‚ä¸ºäº†ç»•å¼€è¿™ä¸ªçº¦æŸï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œæ¯”å¦‚ç©ºå­—ç¬¦ä¸²æˆ–è€…è´Ÿæ•°ç”¨äºè¡¨è¾¾æŸä¸ªå…ƒç´ ä¸å­˜åœ¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// annotations/SimulatingNull.java</span><br><span class="hljs-keyword">import</span> java.lang.annotation.*;<br><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> SimulatingNull &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">id</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> -1</span>;<br>    <span class="hljs-function">String <span class="hljs-title">description</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªåœ¨å®šä¹‰æ³¨è§£çš„ä¹ æƒ¯ç”¨æ³•ã€‚</p><h2 id="4-æ³¨è§£ä½¿ç”¨ç¤ºä¾‹"><a href="#4-æ³¨è§£ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="4. æ³¨è§£ä½¿ç”¨ç¤ºä¾‹"></a>4. æ³¨è§£ä½¿ç”¨ç¤ºä¾‹</h2><p>çŸ¥é“ä»¥ä¸Šè¯­æ³•åŠåŸºæœ¬ä½¿ç”¨åï¼Œä¸‹é¢å¼•ç”¨(ã€ŠTinking in Javaã€‹)ä¾‹å­æ¥ç¤ºä¾‹åˆ©ç”¨è¿è¡Œæ—¶æ³¨è§£æ¥ç»„è£…æ•°æ®åº“SQLçš„æ„å»ºè¯­å¥çš„è¿‡ç¨‹</p><blockquote><p>è¡¨æ³¨è§£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.TYPE)</span><span class="hljs-comment">//åªèƒ½åº”ç”¨äºç±»ä¸Š</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><span class="hljs-comment">//ä¿å­˜åˆ°è¿è¡Œæ—¶</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> DBTable &#123;<br>    <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨è§£Stringç±»å‹çš„å­—æ®µ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.FIELD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> SQLString &#123;<br><br>    <span class="hljs-comment">//å¯¹åº”æ•°æ®åº“è¡¨çš„åˆ—å</span><br>    <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;&quot;</span>;<br><br>    <span class="hljs-comment">//åˆ—ç±»å‹åˆ†é…çš„é•¿åº¦ï¼Œå¦‚varchar(30)çš„30</span><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">value</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> 0</span>;<br><br>    <span class="hljs-function">Constraints <span class="hljs-title">constraint</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> @Constraints</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨è§£SQLIntegerç±»å‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.FIELD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> SQLInteger &#123;<br><br>    <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;&quot;</span>;<br><br>    <span class="hljs-function">Constraints <span class="hljs-title">constraints</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> @Constraints</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>çº¦æŸæ³¨è§£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.FIELD)</span><span class="hljs-comment">//åªèƒ½åº”ç”¨åœ¨å­—æ®µä¸Š</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Constraints &#123;<br>    <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦ä½œä¸ºä¸»é”®çº¦æŸ</span><br>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">primaryKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">false</span></span>;<br>    <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦å…è®¸ä¸ºnull</span><br>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">allowNull</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">false</span></span>;<br>    <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦å”¯ä¸€</span><br>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">unique</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">false</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ•°æ®åº“è¡¨Memberå¯¹åº”å®ä¾‹ç±»bean</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@DBTable(name = &quot;MEMBER&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Member</span> </span>&#123;<br>    <span class="hljs-meta">@SQlString(30)</span><br>    String firstName;<br><br>    <span class="hljs-meta">@SQlString(50)</span><br>    String lastName;<br><br>    <span class="hljs-meta">@SQLInteger</span><br>    Integer age;<br><br>    <span class="hljs-meta">@SQlString(value = 30,constraints = @Constraints(primaryKey = true))</span><br>    String reference;<br><br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> memberCount;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getFirstName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> firstName;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getLastName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> lastName;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getReference</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> reference;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> reference; &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å®šä¹‰4ä¸ªæ³¨è§£ï¼Œåˆ†åˆ«æ˜¯@DBTable(ç”¨äºç±»ä¸Š)ã€@Constraints(ç”¨äºå­—æ®µä¸Š)ã€ @SQLString(ç”¨äºå­—æ®µä¸Š)ã€@SQLString(ç”¨äºå­—æ®µä¸Š)å¹¶åœ¨Memberç±»ä¸­ä½¿ç”¨è¿™äº›æ³¨è§£ï¼Œè¿™äº›æ³¨è§£çš„ä½œç”¨çš„æ˜¯ç”¨äºå¸®åŠ©æ³¨è§£å¤„ç†å™¨ç”Ÿæˆåˆ›å»ºæ•°æ®åº“è¡¨MEMBERçš„æ„å»ºè¯­å¥ï¼Œåœ¨è¿™é‡Œæœ‰ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†åµŒå¥—æ³¨è§£@Constraintsï¼Œè¯¥æ³¨è§£ä¸»è¦ç”¨äºåˆ¤æ–­å­—æ®µæ˜¯å¦ä¸ºnullæˆ–è€…å­—æ®µæ˜¯å¦å”¯ä¸€ã€‚å¿…é¡»æ¸…æ¥šè®¤è¯†åˆ°ä¸Šè¿°æä¾›çš„æ³¨è§£ç”Ÿå‘½å‘¨æœŸå¿…é¡»ä¸º@Retention(RetentionPolicy.RUNTIME)ï¼Œå³è¿è¡Œæ—¶ï¼Œè¿™æ ·æ‰å¯ä»¥ä½¿ç”¨åå°„æœºåˆ¶è·å–å…¶ä¿¡æ¯ã€‚æœ‰äº†ä¸Šè¿°æ³¨è§£å’Œä½¿ç”¨ï¼Œå‰©ä½™çš„å°±æ˜¯ç¼–å†™ä¸Šè¿°çš„æ³¨è§£å¤„ç†å™¨äº†ï¼Œå‰é¢æˆ‘ä»¬èŠäº†å¾ˆå¤šæ³¨è§£ï¼Œå…¶å¤„ç†å™¨è¦ä¹ˆæ˜¯Javaè‡ªèº«å·²æä¾›ã€è¦ä¹ˆæ˜¯æ¡†æ¶å·²æä¾›çš„ï¼Œæˆ‘ä»¬è‡ªå·±éƒ½æ²¡æœ‰æ¶‰åŠåˆ°æ³¨è§£å¤„ç†å™¨çš„ç¼–å†™ï¼Œä½†ä¸Šè¿°å®šä¹‰å¤„ç†SQLçš„æ³¨è§£ï¼Œå…¶å¤„ç†å™¨å¿…é¡»ç”±æˆ‘ä»¬è‡ªå·±ç¼–å†™äº†ï¼Œå¦‚ä¸‹:</p><h3 id="å®ç°å¤„ç†å™¨"><a href="#å®ç°å¤„ç†å™¨" class="headerlink" title="å®ç°å¤„ç†å™¨"></a>å®ç°å¤„ç†å™¨</h3><p>å¤„ç†å™¨å°†è¯»å–ä¸€ä¸ªç±»æ–‡ä»¶ï¼Œæ£€æŸ¥ä¸Šé¢çš„æ•°æ®åº“æ³¨è§£ï¼Œå¹¶ç”Ÿæˆç”¨äºåˆ›å»ºæ•°æ®åº“çš„ SQL å‘½ä»¤ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TableCreator</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createTableSql</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException </span>&#123;<br>        <span class="hljs-keyword">if</span> (args.length &lt; <span class="hljs-number">0</span>) &#123;<br>            System.out.println(<br>                    <span class="hljs-string">&quot;arguments: annotated classes&quot;</span>);<br>            System.exit(<span class="hljs-number">0</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (String className : args) &#123;<br>            Class&lt;?&gt; cl = Class.forName(className);<br><br>            DBTable dbTable = cl.getAnnotation(DBTable.class);<br><br>            <span class="hljs-keyword">if</span> (dbTable == <span class="hljs-keyword">null</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;No DBTable annotations in class &quot;</span> + className);<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br><br>            String tableName = dbTable.name();<br><br>            <span class="hljs-keyword">if</span> (tableName.length() &lt; <span class="hljs-number">1</span>)<br>                tableName = cl.getName().toUpperCase();<br><br>            List&lt;String&gt; columnDefs = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>            <span class="hljs-keyword">for</span> (Field field : cl.getDeclaredFields()) &#123;<br>                String columnName = <span class="hljs-keyword">null</span>;<br>                Annotation[] annotations = field.getDeclaredAnnotations();<br>                <span class="hljs-keyword">if</span> (annotations.length &lt; <span class="hljs-number">1</span>) &#123;<br>                    <span class="hljs-keyword">continue</span>;<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (annotations[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> SQLInteger) &#123;<br>                    SQLInteger sqlInteger = (SQLInteger) annotations[<span class="hljs-number">0</span>];<br><br>                    <span class="hljs-keyword">if</span> (sqlInteger.name().length() &lt; <span class="hljs-number">1</span> ) &#123;<br>                        columnName = field.getName().toUpperCase();<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        columnName = sqlInteger.name();<br>                    &#125;<br><br>                    columnDefs.add(columnName + <span class="hljs-string">&quot; INT &quot;</span> + getConstraints(sqlInteger.constraints()));<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (annotations[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> SQlString) &#123;<br>                    SQlString sQlString = (SQlString) annotations[<span class="hljs-number">0</span>];<br>                    <span class="hljs-keyword">if</span> (sQlString.name().length() &lt; <span class="hljs-number">1</span>) &#123;<br>                        columnName = field.getName().toUpperCase();<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        columnName = sQlString.name();<br>                    &#125;<br><br>                    columnDefs.add(columnName + <span class="hljs-string">&quot; VARCHAR(&quot;</span> + sQlString.value() + <span class="hljs-string">&quot;)&quot;</span>  + getConstraints(sQlString.constraints()));<br>                &#125;<br><br>            &#125;<br><br>            StringBuilder createCommand = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">&quot;CREATE TABLE &quot;</span> + tableName + <span class="hljs-string">&quot;(&quot;</span>);<br><br>            <span class="hljs-keyword">for</span> (String columnDef : columnDefs) &#123;<br>                createCommand.append(<span class="hljs-string">&quot;\n&quot;</span> + columnDef + <span class="hljs-string">&quot;,&quot;</span>);<br><br>            &#125;<br><br>            String tableCreate = createCommand.substring(<br>                    <span class="hljs-number">0</span>, createCommand.length() - <span class="hljs-number">1</span>) + <span class="hljs-string">&quot;);&quot;</span>;<br>            System.out.println(<span class="hljs-string">&quot;Table Creation SQL for &quot;</span> +<br>                    className + <span class="hljs-string">&quot; is:\n&quot;</span> + tableCreate);<br><br><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getConstraints</span><span class="hljs-params">(Constraints con)</span> </span>&#123;<br>        String constraints = <span class="hljs-string">&quot;&quot;</span>;<br><br>        <span class="hljs-keyword">if</span> (!con.allowNull())<br>            constraints += <span class="hljs-string">&quot; NOT NULL&quot;</span>;<br>        <span class="hljs-keyword">if</span> (con.primaryKey())<br>            constraints += <span class="hljs-string">&quot; PRIMARY KEY&quot;</span>;<br><br>        <span class="hljs-keyword">if</span> (con.unique())<br>            constraints += <span class="hljs-string">&quot; UNIQUE&quot;</span>;<br>        <span class="hljs-keyword">return</span> constraints;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        String[] arg = &#123;<span class="hljs-string">&quot;com.example.basic.annotation.example.Member&quot;</span>&#125;;<br>        createTableSql(arg);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æœ€ç»ˆè¾“å‡ºç»“æœå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">Table Creation SQL for com.example.basic.annotation.example.Member is:<br>CREATE TABLE MEMBER(<br>FIRSTNAME VARCHAR(30),<br>LASTNAME VARCHAR(50),<br>AGE INT ,<br>REFERENCE VARCHAR(30) PRIMARY KEY);<br></code></pre></td></tr></table></figure><p>é€šè¿‡å¤„ç†å™¨å¯ä»¥çœ‹å‡ºæ˜¯åŸºäºåå°„æ¥è¿›è¡Œå¤„ç†ï¼Œæˆ‘ä»¬é€šè¿‡ä¼ é€’Memberçš„å…¨è·¯å¾„åé€šè¿‡Class.forName()æ–¹æ³•è·å–åˆ°Memberçš„classå¯¹è±¡ï¼Œç„¶ååˆ©ç”¨Classå¯¹è±¡ä¸­çš„æ–¹æ³•è·å–æ‰€æœ‰æˆå‘˜å­—æ®µFieldï¼Œæœ€ååˆ©ç”¨field.getDeclaredAnnotations()éå†æ¯ä¸ªFieldä¸Šçš„æ³¨è§£å†é€šè¿‡æ³¨è§£çš„ç±»å‹åˆ¤æ–­æ¥æ„å»ºå»ºè¡¨çš„SQLè¯­å¥ã€‚è¿™ä¾¿æ˜¯åˆ©ç”¨æ³¨è§£ç»“åˆåå°„æ¥æ„å»ºSQLè¯­å¥çš„ç®€å•çš„å¤„ç†å™¨æ¨¡å‹ã€‚</p><p>å‚è€ƒ:</p><p>ã€ŠThinking in Javaã€‹</p><p><a href="https://dunwu.github.io/javacore/basics/java-annotation.html#_4-1-%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%AE%9A%E4%B9%89">https://dunwu.github.io/javacore/basics/java-annotation.html#_4-1-%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%AE%9A%E4%B9%89</a></p><p><a href="https://blog.csdn.net/javazejian/article/details/71860633">https://blog.csdn.net/javazejian/article/details/71860633</a></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaåŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaåŸºç¡€-æ³›å‹</title>
    <link href="/2021/10/24/Java%E5%9F%BA%E7%A1%80-%E6%B3%9B%E5%9E%8B/"/>
    <url>/2021/10/24/Java%E5%9F%BA%E7%A1%80-%E6%B3%9B%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><blockquote><p>æ³›å‹æ˜¯Java SE 1.5çš„æ–°ç‰¹æ€§ï¼Œæ³›å‹çš„æœ¬è´¨æ˜¯å‚æ•°åŒ–ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚è¿™ç§å‚æ•°ç±»å‹å¯ä»¥ç”¨åœ¨ç±»ã€æ¥å£å’Œæ–¹æ³•çš„åˆ›å»ºä¸­ï¼Œåˆ†åˆ«ç§°ä¸ºæ³›å‹ç±»ã€æ³›å‹æ¥å£ã€æ³›å‹æ–¹æ³•ã€‚<a href="http://baike.baidu.com/view/229611.htm">Javaè¯­è¨€</a>å¼•å…¥æ³›å‹çš„å¥½å¤„æ˜¯å®‰å…¨ç®€å•ã€‚</p><p>åœ¨Java SE 1.5ä¹‹å‰ï¼Œæ²¡æœ‰æ³›å‹çš„<a href="http://baike.baidu.com/view/780206.htm">æƒ…å†µ</a>çš„ä¸‹ï¼Œé€šè¿‡å¯¹ç±»å‹Objectçš„å¼•ç”¨æ¥å®ç°å‚æ•°çš„â€œä»»æ„åŒ–â€ï¼Œâ€œä»»æ„åŒ–â€å¸¦æ¥çš„ç¼ºç‚¹æ˜¯è¦åšæ˜¾å¼çš„<a href="http://baike.baidu.com/view/2886403.htm">å¼ºåˆ¶ç±»å‹è½¬æ¢</a>ï¼Œè€Œè¿™ç§è½¬æ¢æ˜¯è¦æ±‚å¼€å‘è€…å¯¹<a href="http://baike.baidu.com/view/2245196.htm">å®é™…å‚æ•°</a>ç±»å‹å¯ä»¥é¢„çŸ¥çš„æƒ…å†µä¸‹è¿›è¡Œçš„ã€‚å¯¹äºå¼ºåˆ¶ç±»å‹è½¬æ¢é”™è¯¯çš„æƒ…å†µï¼Œ<a href="http://baike.baidu.com/view/487018.htm">ç¼–è¯‘å™¨</a>å¯èƒ½ä¸æç¤ºé”™è¯¯ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™æ‰å‡ºç°å¼‚å¸¸ï¼Œè¿™æ˜¯ä¸€ä¸ªå®‰å…¨éšæ‚£ã€‚<br> æ³›å‹çš„å¥½å¤„æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™æ£€æŸ¥<a href="http://baike.baidu.com/view/1965709.htm">ç±»å‹å®‰å…¨</a>ï¼Œå¹¶ä¸”æ‰€æœ‰çš„<a href="http://baike.baidu.com/view/965170.htm">å¼ºåˆ¶è½¬æ¢</a>éƒ½æ˜¯è‡ªåŠ¨å’Œ<a href="http://baike.baidu.com/view/2852863.htm">éšå¼</a>çš„ï¼Œä»¥æé«˜ä»£ç çš„é‡ç”¨ç‡ã€‚</p></blockquote><h4 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p><strong>Boxç±»å®šä¹‰ä¸ºä¸€ä¸ªæ³›å‹ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> T object;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">set</span><span class="hljs-params">(T object)</span> </span>&#123; <span class="hljs-keyword">this</span>.object = object; &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> object; &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>åˆ›å»ºä¸€ä¸ªBoxå¯¹è±¡ï¼Œä¸å¸¦æ³›å‹å‚æ•°ï¼Œå‘ç°è·å–å¯¹è±¡çš„æ—¶å€™éœ€è¦å¼ºåˆ¶è½¬æ¢</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Box box2 = <span class="hljs-keyword">new</span> Box();<br>box2.set(<span class="hljs-keyword">new</span> Apple());<br>Apple apple = (Apple) box2.get();<br></code></pre></td></tr></table></figure><p><strong>åˆ›å»ºä¸€ä¸ªBoxå¯¹è±¡ï¼Œå¸¦æ³›å‹å‚æ•°ï¼Œè·å–å¯¹è±¡çš„æ—¶å€™å°±ä¸éœ€è¦å¼ºåˆ¶è½¬æ¢</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Box&lt;Apple&gt; box = <span class="hljs-keyword">new</span> Box&lt;Apple&gt;();<br>box.set(<span class="hljs-keyword">new</span> Apple());<br>Apple apple = box.get();<br></code></pre></td></tr></table></figure><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><strong>æ³›å‹çœå»äº†å¼ºåˆ¶è½¬æ¢ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶å€™æ£€æŸ¥ç±»å‹å®‰å…¨ï¼Œå¯ä»¥ç”¨åœ¨ç±»ï¼Œæ–¹æ³•ï¼Œæ¥å£ä¸Š</strong></p><blockquote><p>æ³›å‹çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯<strong>å‚æ•°åŒ–ç±»å‹</strong>ï¼Œä½¿ç”¨å‚æ•°æŒ‡å®šæ–¹æ³•ç±»å‹ï¼Œè€Œéç¡¬ç¼–ç ã€‚æ³›å‹çš„å‡ºç°å¸¦ç»™æˆ‘ä»¬å¾ˆå¤šå¥½å¤„ï¼Œå…¶ä¸­æœ€é‡è¦çš„è«è¿‡äºå¯¹é›†åˆç±»çš„æ”¹è¿›ï¼Œé¿å…äº†ä»»æ„ç±»å‹éƒ½å¯ä»¥ä¸¢åˆ°åŒä¸€ä¸ªé›†åˆé‡Œçš„ä¸å¯é é—®é¢˜ã€‚</p></blockquote><h3 id="æ³›å‹ä½¿ç”¨ç®€ä»‹"><a href="#æ³›å‹ä½¿ç”¨ç®€ä»‹" class="headerlink" title="æ³›å‹ä½¿ç”¨ç®€ä»‹"></a>æ³›å‹ä½¿ç”¨ç®€ä»‹</h3><p>æ³›å‹ä¸€èˆ¬æœ‰ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼šæ³›å‹ç±»ã€æ³›å‹æ¥å£å’Œæ³›å‹æ–¹æ³•ã€‚</p><p><strong>æ³›å‹ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> T member;<br>&#125;<br>...<br><span class="hljs-comment">// åˆå§‹åŒ–æ—¶æŒ‡å®šæ³›å‹ç±»å‹</span><br>Test&lt;String&gt; instance = <span class="hljs-keyword">new</span> Test&lt;String&gt;();<br></code></pre></td></tr></table></figure><p><strong>æ³›å‹æ¥å£</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">TestInterface</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(T param)</span></span>;<br>&#125;<br><br><span class="hljs-comment">// å®ç°ç±»æŒ‡å®šæ³›å‹ç±»å‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">TestInterface</span>&lt;<span class="hljs-title">String</span>&gt; </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(String param)</span> </span>&#123;...&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>æ³›å‹æ–¹æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åœ¨æ–¹æ³•å‰æ·»åŠ &lt;T&gt;,æ³›å‹ç±»å‹å¯ç”¨äºè¿”å›å€¼ä¹Ÿå¯ç”¨äºå‚æ•°</span><br><span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">function</span><span class="hljs-params">(T param)</span></span>;<br>...<br>function(<span class="hljs-string">&quot;123&quot;</span>); <span class="hljs-comment">// ç¼–è¯‘å™¨è‡ªåŠ¨è¯†åˆ«Tä¸ºString</span><br></code></pre></td></tr></table></figure><h3 id="æ³›å‹é€šé…ç¬¦Tï¼ŒEï¼ŒKï¼ŒVåŒºåˆ«"><a href="#æ³›å‹é€šé…ç¬¦Tï¼ŒEï¼ŒKï¼ŒVåŒºåˆ«" class="headerlink" title="æ³›å‹é€šé…ç¬¦Tï¼ŒEï¼ŒKï¼ŒVåŒºåˆ«"></a>æ³›å‹é€šé…ç¬¦Tï¼ŒEï¼ŒKï¼ŒVåŒºåˆ«</h3><p>T,E,K,Véƒ½å±äºjavaæ³›å‹çš„é€šé…ç¬¦,åˆšå¼€å§‹æˆ‘çœ‹åˆ°è¿™ä¹ˆå¤šé€šé…ç¬¦ï¼Œä¸€ä¸‹æ™•äº†ï¼Œè¿™å‡ ä¸ªå…¶å®<strong>æ²¡ä»€ä¹ˆåŒºåˆ«</strong>ï¼Œåªä¸è¿‡æ˜¯ä¸€ä¸ªçº¦å®šå¥½çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯è¯´</p><blockquote><p><strong>ä½¿ç”¨å¤§å†™å­—æ¯A,B,C,Dâ€¦â€¦X,Y,Zå®šä¹‰çš„ï¼Œå°±éƒ½æ˜¯æ³›å‹ï¼ŒæŠŠTæ¢æˆAä¹Ÿä¸€æ ·ï¼Œè¿™é‡ŒTåªæ˜¯åå­—ä¸Šçš„æ„ä¹‰è€Œå·²</strong></p><ul><li><strong>ï¼Ÿ</strong> è¡¨ç¤ºä¸ç¡®å®šçš„javaç±»å‹</li><li><strong>T (type)</strong> è¡¨ç¤ºå…·ä½“çš„ä¸€ä¸ªjavaç±»å‹</li><li><strong>K V (key value)</strong> åˆ†åˆ«ä»£è¡¨javaé”®å€¼ä¸­çš„Key Value</li><li><strong>E (element)</strong> ä»£è¡¨Element</li></ul></blockquote><p><strong>ä¸¾ä¾‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;    <br>  <span class="hljs-keyword">public</span> List&lt;T&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;T&gt;();   <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Test&lt;String&gt; test = <span class="hljs-keyword">new</span> Test&lt;String&gt;();<br>        test.list.add(<span class="hljs-string">&quot;hello&quot;</span>);<br>        System.out.println(test.list);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span>&lt;<span class="hljs-title">A</span>&gt; </span>&#123;    <br>  <span class="hljs-keyword">public</span> List&lt;A&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;A&gt;();   <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Test&lt;String&gt; test = <span class="hljs-keyword">new</span> Test&lt;String&gt;();<br>        test.list.add(<span class="hljs-string">&quot;hello&quot;</span>);<br>        System.out.println(test.list);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å°†Tæ¢æˆäº†Aï¼Œåœ¨æ‰§è¡Œæ•ˆæœä¸Šæ˜¯æ²¡æœ‰ä»»ä½•åŒºåˆ«çš„ï¼Œåªä¸è¿‡æˆ‘ä»¬çº¦å®šå¥½äº†Tä»£è¡¨typeï¼Œæ‰€ä»¥è¿˜æ˜¯<strong>æŒ‰ç…§çº¦å®šè§„èŒƒæ¥æ¯”è¾ƒå¥½</strong>ï¼Œå¢åŠ äº†ä»£ç çš„å¯è¯»æ€§ã€‚</p><p>å¦‚æœè¦å®šä¹‰<strong>å¤šä¸ª</strong>æ³›å‹å‚æ•°ï¼Œæ¯”å¦‚è¯´ä¸¤ä¸ªæ³›å‹å‚æ•°</p><p>å¾ˆå…¸å‹çš„ä¸€ä¸ªä¾‹å­æ˜¯Mapçš„key,valueæ³›å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªè¿™æ ·çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Mymap</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> K <span class="hljs-title">getKey</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">getValue</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MymapImpl</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">Mymap</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt; </span>&#123;<br><br>    <span class="hljs-keyword">private</span> K key;<br>    <span class="hljs-keyword">private</span> V value;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MymapImpl</span><span class="hljs-params">(K key, V value)</span> </span>&#123;<br>    <span class="hljs-keyword">this</span>.key = key;<br>    <span class="hljs-keyword">this</span>.value = value;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> K <span class="hljs-title">getKey</span><span class="hljs-params">()</span>   </span>&#123; <span class="hljs-keyword">return</span> key; &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> value; &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±å¯ä»¥ä¼ å…¥ä»»æ„ç±»å‹ï¼Œåˆ›å»ºå®ä¾‹äº†ï¼Œä¸ç”¨è½¬åŒ–ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Mymap&lt;String, Integer&gt; mp1= <span class="hljs-keyword">new</span> MymapImpl&lt;String, Integer&gt;(<span class="hljs-string">&quot;Even&quot;</span>, <span class="hljs-number">8</span>);<br>Mymap&lt;String, String&gt;  mp2= <span class="hljs-keyword">new</span> MymapImpl&lt;String, String&gt;(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);<br>Mymap&lt;Integer, Integer&gt; mp3= <span class="hljs-keyword">new</span> MymapImpl&lt;Integer, Integer&gt;(<span class="hljs-number">888</span>, <span class="hljs-number">888</span>);<br></code></pre></td></tr></table></figure><p>å¦‚æœè¦å®šä¹‰<strong>è¶…è¿‡ä¸¤ä¸ªï¼Œä¸‰ä¸ªæˆ–ä¸‰ä¸ªä»¥ä¸Š</strong>çš„æ³›å‹å‚æ•°å¯ä»¥ä½¿ç”¨<strong>T1, T2, â€¦, Tn</strong>ï¼Œåƒè¿™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span>&lt;<span class="hljs-title">T1</span>,<span class="hljs-title">T2</span>,<span class="hljs-title">T3</span>&gt; </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(T1 t1,T2 t2,T3 t3)</span></span>&#123;<br>        System.out.println(t1.getClass());<br>        System.out.println(t2.getClass());<br>        System.out.println(t3.getClass());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="List-lt-T-gt-ï¼ŒList-lt-Object-gt-ï¼ŒList-lt-gt-åŒºåˆ«"><a href="#List-lt-T-gt-ï¼ŒList-lt-Object-gt-ï¼ŒList-lt-gt-åŒºåˆ«" class="headerlink" title="List&lt;T&gt;ï¼ŒList&lt; Object &gt;ï¼ŒList&lt;?&gt;åŒºåˆ«"></a><code>List&lt;T&gt;</code>ï¼ŒList&lt; Object &gt;ï¼ŒList&lt;?&gt;åŒºåˆ«</h3><blockquote><p><strong><code>ArrayList&lt;T&gt;</code> al=new ArrayList&lt; T&gt;();</strong> æŒ‡å®šé›†åˆå…ƒç´ åªèƒ½æ˜¯Tç±»å‹</p><p><strong>ArrayList&lt; ?&gt; al=new ArrayList&lt; ?&gt;();</strong> é›†åˆå…ƒç´ å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œè¿™ç§æ²¡æœ‰æ„ä¹‰ï¼Œä¸€èˆ¬æ˜¯æ–¹æ³•ä¸­ï¼Œåªæ˜¯ä¸ºäº†è¯´æ˜ç”¨æ³•</p></blockquote><p><strong>ArrayList&lt;? extends E&gt; al=new ArrayList&lt;? extends E&gt;();</strong></p><p>æ³›å‹çš„é™å®šï¼š</p><p><strong>? extends E</strong>:æ¥æ”¶Eç±»å‹æˆ–è€…Eçš„å­ç±»å‹ã€‚</p><p><strong>? super E</strong>:æ¥æ”¶Eç±»å‹æˆ–è€…Eçš„çˆ¶ç±»å‹ã€‚</p><ul><li>Objectå’ŒTä¸åŒç‚¹åœ¨äºï¼ŒObjectæ˜¯ä¸€ä¸ªå®æ‰“å®çš„ç±»,å¹¶æ²¡æœ‰æ³›æŒ‡è°ï¼Œè€ŒTå¯ä»¥æ³›æŒ‡Objectï¼Œæ¯”æ–¹<strong>public void printList(List&lt; T&gt; list){}<strong>æ–¹æ³•ä¸­å¯ä»¥ä¼ å…¥</strong>List&lt; Object&gt; list</strong>ç±»å‹å‚æ•°ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥<strong>List&lt; String&gt; list</strong>ç±»å‹å‚æ•°ï¼Œä½†æ˜¯<strong>public void printList(List&lt; Object&gt; list){}<strong>å°±åªå¯ä»¥ä¼ å…¥</strong>List&lt; Object&gt; list</strong>ç±»å‹å‚æ•°ï¼Œå› ä¸ºObjectç±»å‹å¹¶æ²¡æœ‰æ³›æŒ‡è°ï¼Œæ˜¯ä¸€ä¸ªç¡®å®šçš„ç±»å‹ã€‚</li><li>?å’ŒTåŒºåˆ«æ˜¯:?æ˜¯ä¸€ä¸ªä¸ç¡®å®šç±»ï¼Œï¼Ÿå’ŒTéƒ½è¡¨ç¤ºä¸ç¡®å®šçš„ç±»å‹ ï¼Œä½†å¦‚æœæ˜¯Tçš„è¯ï¼Œå‡½æ•°é‡Œé¢å¯ä»¥å¯¹Tè¿›è¡Œæ“ä½œï¼Œæ¯”æ–¹ T car = getCar()ï¼Œè€Œä¸èƒ½ç”¨ï¼Ÿ car = getCar()ã€‚</li></ul><p>ä»¥ä¸‹ä¸¾ä¾‹æ¯”è¾ƒä¸‰ç§æƒ…å†µ:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestDifferenceBetweenObjectAndT</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">printList1</span><span class="hljs-params">(List&lt;Object&gt; list)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (Object elem : list)<br>            System.out.println(elem + <span class="hljs-string">&quot; &quot;</span>);<br>        System.out.println();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">printList2</span><span class="hljs-params">(List&lt;T&gt; list)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (T elem : list)<br>            System.out.println(elem + <span class="hljs-string">&quot; &quot;</span>);<br>        System.out.println();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>  <span class="hljs-keyword">void</span> <span class="hljs-title">printList3</span><span class="hljs-params">(List&lt;?&gt; list)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i&lt;list.size();i++)<br>            System.out.println(list.get(i) + <span class="hljs-string">&quot; &quot;</span>);<br>        System.out.println();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        List&lt;Integer&gt; test1 = Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);<br>        List&lt;String&gt;  test2 = Arrays.asList(<span class="hljs-string">&quot;one&quot;</span>, <span class="hljs-string">&quot;two&quot;</span>, <span class="hljs-string">&quot;three&quot;</span>);<br>        List&lt;Object&gt; test3 = Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;two&quot;</span>, <span class="hljs-number">1.23</span>);<br>        List&lt;Fruit&gt; test4 = Arrays.asList(<span class="hljs-keyword">new</span> Apple(), <span class="hljs-keyword">new</span> Banana());<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        * ä¸‹é¢è¿™å¥ä¼šç¼–è¯‘æŠ¥é”™ï¼Œå› ä¸ºå‚æ•°ä¸èƒ½è½¬åŒ–æˆåŠŸ</span><br><span class="hljs-comment">        * */</span><br>        printList1(test4);<br>        <span class="hljs-comment">/**/</span><br><span class="hljs-comment">        printList1(test3);</span><br><span class="hljs-comment">        printList1(test3);</span><br><span class="hljs-comment">        printList2(test1);</span><br><span class="hljs-comment">        printList2(test2);</span><br><span class="hljs-comment">        printList2(test3);</span><br><span class="hljs-comment">        printList3(test1);</span><br><span class="hljs-comment">        printList3(test2);</span><br><span class="hljs-comment">        printList3(test3);</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">&#125;</span><br></code></pre></td></tr></table></figure><h3 id="Tï¼ŒClass-lt-T-gt-ï¼ŒClass-lt-gt-åŒºåˆ«"><a href="#Tï¼ŒClass-lt-T-gt-ï¼ŒClass-lt-gt-åŒºåˆ«" class="headerlink" title="Tï¼ŒClass&lt;T&gt;ï¼ŒClass&lt;?&gt;åŒºåˆ«"></a>Tï¼Œ<code>Class&lt;T&gt;</code>ï¼ŒClass&lt;?&gt;åŒºåˆ«</h3><p>Tæ˜¯ä¸€ç§å…·ä½“çš„ç±»ï¼Œä¾‹å¦‚String,List,Mapâ€¦â€¦ç­‰ç­‰ï¼Œè¿™äº›éƒ½æ˜¯å±äºå…·ä½“çš„ç±»</p><p>Classæ˜¯ä»€ä¹ˆå‘¢ï¼ŒClassä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œä½†Classæ˜¯å­˜æ”¾ä¸Šé¢String,List,Mapâ€¦â€¦ç±»ä¿¡æ¯çš„ä¸€ä¸ªç±»</p><p>å¦‚ä½•è·å–åˆ°Classç±»å‘¢ï¼Œæœ‰ä¸‰ç§æ–¹å¼ï¼š</p><p><strong>1.è°ƒç”¨Objectç±»çš„getClass()æ–¹æ³•æ¥å¾—åˆ°Classå¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„äº§ç”ŸClasså¯¹è±¡çš„æ–¹æ³•ã€‚</strong></p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">List list = <span class="hljs-keyword">null</span>;<br>Class clazz = list.getClass();<br></code></pre></td></tr></table></figure><p><strong>2.ä½¿ç”¨Classç±»çš„ä¸­é™æ€forName()æ–¹æ³•è·å¾—ä¸å­—ç¬¦ä¸²å¯¹åº”çš„Classå¯¹è±¡ã€‚</strong></p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz = Class.forName(<span class="hljs-string">&quot;xx.xx.xx.xx.People&quot;</span>);<br></code></pre></td></tr></table></figure><p><strong>3.è·å–Classç±»å‹å¯¹è±¡çš„ç¬¬ä¸‰ä¸ªæ–¹æ³•éå¸¸ç®€å•ã€‚å¦‚æœTæ˜¯ä¸€ä¸ªJavaç±»å‹ï¼Œé‚£ä¹ˆT.classå°±ä»£è¡¨äº†åŒ¹é…çš„ç±»å¯¹è±¡ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Class clazz = List.class;<br></code></pre></td></tr></table></figure><p><strong>Classç±»æ˜¯åˆ›å»ºå‡ºæ¥äº†ï¼Œä½†æ˜¯Class&lt; T&gt;å’ŒClass&lt;?&gt;é€‚ç”¨äºä»€ä¹ˆæ—¶å€™</strong></p><p>ä½¿ç”¨Class&lt; T&gt;å’ŒClass&lt; ?&gt;å¤šå‘ç”Ÿåœ¨åå°„åœºæ™¯ä¸‹ï¼Œå…ˆçœ‹çœ‹å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨æ³›å‹ï¼Œåå°„åˆ›å»ºä¸€ä¸ªç±»æ˜¯ä»€ä¹ˆæ ·çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">People people = (People) Class.forName(<span class="hljs-string">&quot;xx.xx.People&quot;</span>).newInstance();<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°äº†ä¹ˆï¼Œéœ€è¦å¼ºè½¬ï¼Œå¦‚æœåå°„çš„ç±»å‹ä¸æ˜¯Peopleç±»ï¼Œå°±ä¼šæŠ¥<strong>java.lang.ClassCastException</strong>é”™è¯¯ã€‚</p><p>ä½¿ç”¨Class<T>æ³›å‹åï¼Œä¸ç”¨å¼ºè½¬äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">createInstance</span><span class="hljs-params">(Class&lt;T&gt; clazz)</span> <span class="hljs-keyword">throws</span> IllegalAccessException, InstantiationException </span>&#123;<br>        <span class="hljs-keyword">return</span> clazz.newInstance();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span>  <span class="hljs-keyword">throws</span> IllegalAccessException, InstantiationException  </span>&#123;<br>            Fruit fruit= createInstance(Fruit .class);<br>            People people= createInstance(People.class);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£Class&lt; T&gt;å’ŒClass&lt; ?&gt;æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p><strong>Class&lt; T&gt;åœ¨å®ä¾‹åŒ–çš„æ—¶å€™ï¼ŒTè¦æ›¿æ¢æˆå…·ä½“ç±»</strong></p><p><strong>Class&lt;?&gt;å®ƒæ˜¯ä¸ªé€šé…æ³›å‹ï¼Œ?å¯ä»¥ä»£è¡¨ä»»ä½•ç±»å‹ï¼Œä¸»è¦ç”¨äºå£°æ˜æ—¶çš„é™åˆ¶æƒ…å†µ</strong></p><p>ä¾‹å¦‚å¯ä»¥å£°æ˜ä¸€ä¸ª</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Class&lt;?&gt; clazz;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä½ ä¸èƒ½å£°æ˜ä¸€ä¸ª</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Class&lt;T&gt; clazz;<br></code></pre></td></tr></table></figure><p>å› ä¸ºTéœ€è¦æŒ‡å®šç±»å‹<br>æ‰€ä»¥å½“ï¼Œä¸çŸ¥é“å®šå£°æ˜ä»€ä¹ˆç±»å‹çš„Classçš„æ—¶å€™å¯ä»¥å®šä¹‰ä¸€ä¸ªClass&lt; ?&gt;,Class&lt;?&gt;å¯ä»¥ç”¨äºå‚æ•°ç±»å‹å®šä¹‰ï¼Œæ–¹æ³•è¿”å›å€¼å®šä¹‰ç­‰ã€‚</p><h3 id="æ·±å…¥Javaæ³›å‹"><a href="#æ·±å…¥Javaæ³›å‹" class="headerlink" title="æ·±å…¥Javaæ³›å‹"></a>æ·±å…¥Javaæ³›å‹</h3><h4 id="Javaçš„ä¼ªæ³›å‹å’Œç±»å‹æ“¦é™¤"><a href="#Javaçš„ä¼ªæ³›å‹å’Œç±»å‹æ“¦é™¤" class="headerlink" title="Javaçš„ä¼ªæ³›å‹å’Œç±»å‹æ“¦é™¤"></a>Javaçš„ä¼ªæ³›å‹å’Œç±»å‹æ“¦é™¤</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;String&gt; strList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>List&lt;Integer&gt; intList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>System.out.println(strList.getClass() == intList.getClass()); <span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><p>å¯¹å¦‚ä¸Šéƒ¨åˆ†ä»£ç ï¼Œç›¸ä¿¡å¤šæ•°äººæ¥è§¦åˆ°æ³›å‹çš„ç¬¬ä¸€æ—¶åˆ»éƒ½è®¤ä¸ºè¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»å‹ï¼Œåç¼–è¯‘å…¶å­—èŠ‚ç è·å¾—ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">ArrayList var1 = <span class="hljs-keyword">new</span> ArrayList();<br>ArrayList var2 = <span class="hljs-keyword">new</span> ArrayList();<br>System.out.println(var1.getClass() == var2.getClass());<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°ä¸¤ä¸ªåˆ—è¡¨éƒ½å˜æˆArrayListç±»å‹ï¼Œå¦‚æœå¤§å®¶å¯¹Jdk1.5ä¹‹å‰çš„ç‰ˆæœ¬è¿˜æœ‰å°è±¡å°±å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸€æ®µåç¼–è¯‘çš„ä»£ç å°±æ˜¯Javaé›†åˆæœ€åˆçš„ä½¿ç”¨å½¢å¼ã€‚å› æ­¤ï¼ŒJavaæ³›å‹çš„æ˜¯é€šè¿‡<strong>ç¼–è¯‘æœŸå°†æ³›å‹çš„å®é™…ç±»å‹æ“¦é™¤ä¸ºåŸå§‹ç±»å‹(é€šå¸¸ä¸ºObject)å®ç°çš„ä¼ªæ³›å‹</strong>ã€‚</p><p>æ‰€è°“ä¼ªæ³›å‹ï¼Œæ˜¯ç›¸å¯¹C++çš„â€çœŸæ³›å‹â€(å¼‚æ„æ‰©å±•ï¼Œå¯è§å‚è€ƒç¬¬ä¸‰æ¡)ï¼Œåœ¨Javaä¸­ï¼Œç”±äºç¼–è¯‘åæ“¦é™¤äº†å…·ä½“ç±»å‹ï¼Œåœ¨<strong>æ³›å‹ä»£ç å†…éƒ¨</strong>ï¼Œæ— æ³•è·å¾—ä»»ä½•æœ‰å…³æ³›å‹å‚æ•°ç±»å‹çš„ä¿¡æ¯ï¼Œåœ¨è¿è¡ŒæœŸä»£ç æ‰€æŒæœ‰çš„ä¹Ÿåªæ˜¯æ“¦é™¤åçš„åŸå§‹ç±»å‹ï¼Œä¹Ÿå°±æ„å‘³ç€åœ¨è¿è¡ŒæœŸå¯ä»¥é€šè¿‡åå°„çš„æ–¹å¼ä¸ºæ³›å‹ç±»ä¼ å…¥ä»»ä½•åŸå§‹ç±»å‹çš„å‚æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GenericTest</span> </span>&#123;<br><br>    <span class="hljs-keyword">public</span> List&lt;Integer&gt; ints = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        GenericTest test = <span class="hljs-keyword">new</span> GenericTest();<br>        List&lt;GenericTest&gt; list = (List&lt;GenericTest&gt;) GenericTest.class.getDeclaredField(<span class="hljs-string">&quot;ints&quot;</span>).get(test);<br>        list.add(<span class="hljs-keyword">new</span> GenericTest());<br>        System.out.println(test.ints.get(<span class="hljs-number">0</span>));   <span class="hljs-comment">// æ‰“å°GenericTestå˜é‡åœ°å€</span><br>        <span class="hljs-keyword">int</span> number = test.ints.get(<span class="hljs-number">0</span>);  <span class="hljs-comment">// ç±»å‹è½¬æ¢æŠ›å‡ºå¼‚å¸¸</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ³›å‹ä»£ç å†…éƒ¨æ˜¯æŒ‡æ³›å‹ç±»æˆ–æ³›å‹æ–¹æ³•å†…éƒ¨ã€‚</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Generic</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Class <span class="hljs-title">getTClass</span><span class="hljs-params">()</span> </span>&#123;  <span class="hljs-comment">//æ— æ³•è·å– &#125;</span><br>&#125;<br><span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">Class <span class="hljs-title">getParamClass</span><span class="hljs-params">(T param)</span> </span>&#123; <span class="hljs-comment">//æ— æ³•è·å– &#125;</span><br><br></code></pre></td></tr></table></figure><p>åœ¨æ³›å‹å¤–éƒ¨å¯ä»¥è·å–å·²æŒ‡å®šçš„æ³›å‹å‚æ•°ç±»å‹ï¼Œé€šè¿‡<code>javap -v</code>æŸ¥çœ‹<code>Constant Pool</code>ï¼Œå¯çœ‹åˆ°å…·ä½“ç±»å‹è®°å½•åœ¨<code>Signature</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Outer</span> </span><br><span class="hljs-class">    <span class="hljs-title">private</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">String</span>&gt; <span class="hljs-title">list</span> </span>= <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();  <span class="hljs-comment">//å¯ä»¥è·å–listçš„å…·ä½“ç±»å‹</span><br>&#125;<br></code></pre></td></tr></table></figure><p>äº‹å®ä¸Šåœ¨Javaæ¨å‡ºæ³›å‹æ—¶ï¼ŒC++çš„æ¨¡æ¿æ³›å‹å·²ç»ç›¸å½“æˆç†Ÿï¼Œè®¾è®¡è€…ä¹Ÿå¹¶éæ²¡æœ‰èƒ½åŠ›å®ç°åŒ…å«å…·ä½“ç±»å‹çš„æ³›å‹ï¼Œä½¿ç”¨ç±»å‹æ“¦é™¤æœ€é‡è¦çš„åŸå› è¿˜æ˜¯ä¸ºäº†ä¿æŒ<strong>å…¼å®¹æ€§</strong>ã€‚å‡è®¾<code>ArrayList&lt;String&gt;</code>å’Œ<code>ArrayList</code>ç¼–è¯‘åæ˜¯ä¸åŒçš„classï¼Œé‚£ä¹ˆä¸ºäº†å…¼å®¹æ—§ä»£ç æ­£å¸¸è¿è¡Œï¼Œå¿…é¡»å¹³è¡Œçš„æ·»åŠ ä¸€å¥—æ³›å‹é›†åˆå¹¶åœ¨åç»­ç‰ˆæœ¬ä¸­åŒæ—¶ç»´æŠ¤ï¼Œè€Œé›†åˆç±»ä½œä¸ºå¤§é‡ä½¿ç”¨çš„åŸºç¡€å·¥å…·ç±»ï¼Œå¼€å‘è€…ä¸å¾—ä¸ä¸ºæ­¤æ‰¿æ‹…å¤§é‡ä»£ç åˆ‡æ¢çš„é£é™©(å‚è€ƒ<code>Vector</code>å’Œ<code>HashTable</code>çš„å¸¦æ¥çš„é—ç•™é—®é¢˜)ï¼Œå› æ­¤ç›¸è¾ƒäºå…¼å®¹æ€§çš„å–èˆï¼Œé‡‡ç”¨ç±»å‹æ“¦é™¤å®ç°æ³›å‹ç®—æ˜¯æŠ˜ä¸­æ–¹æ¡ˆã€‚</p><h3 id="Javaæ³›å‹çš„ä¸Šä¸‹ç•Œ"><a href="#Javaæ³›å‹çš„ä¸Šä¸‹ç•Œ" class="headerlink" title="Javaæ³›å‹çš„ä¸Šä¸‹ç•Œ"></a>Javaæ³›å‹çš„ä¸Šä¸‹ç•Œ</h3><p>å‰é¢è¯´åˆ°æ³›å‹ä¼šè¢«æ“¦é™¤ä¸ºåŸå§‹ç±»å‹ï¼Œä¸€èˆ¬æ˜¯<code>Object</code>ã€‚å¦‚æœæ³›å‹å£°æ˜ä¸º<code>&lt;? extends Number&gt;</code>ï¼Œå°±ä¼šè¢«æ“¦é™¤ä¸º<code>Number</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Number&gt; numbers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>List&lt;Integer&gt; integers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>numbers = integers;<span class="hljs-comment">// compile error</span><br></code></pre></td></tr></table></figure><p>è€ƒè™‘ä»¥ä¸Šä»£ç ï¼Œ<code>numbers</code>å¯ä»¥å¢åŠ <code>Integer</code>ç±»å‹çš„å…ƒç´ ï¼Œç›´è§‰ä¸Š<code>integers</code>åº”è¯¥ä¹Ÿå¯ä»¥èµ‹å€¼ç»™<code>numbers</code>ã€‚ç”±äºç±»å‹æ“¦é™¤ï¼ŒJavaåœ¨ç¼–è¯‘æœŸé™å®šäº†åªæœ‰ç›¸åŒç±»å‹çš„æ³›å‹å®ä¾‹æ‰å¯ä»¥äº’ç›¸èµ‹å€¼ï¼Œä½†è¿™æ ·å°±è¿èƒŒäº†Javaçš„å¤šæ€ï¼Œä¸ºäº†è§£å†³æ³›å‹è½¬æ¢çš„é—®é¢˜ï¼ŒJavaå¼•å…¥äº†ä¸Šä¸‹é™<code>&lt;? extends A&gt;</code>å’Œ<code>&lt;? super B&gt;</code>ä¸¤ç§æœºåˆ¶ã€‚</p><p><strong>1.ä¸Šç•Œ</strong></p><p>å¦‚æœæ³›å‹å£°æ˜ä¸º<code>&lt;? extends A&gt;</code>ï¼Œå³å£°æ˜è¯¥æ³›å‹çš„ä¸Šç•Œä¹Ÿå³æ“¦é™¤åçš„åŸå§‹ç±»å‹ä¸º<code>A</code>ï¼ŒåŒæ—¶è¯¥æ³›å‹ç±»çš„å®ä¾‹å¯ä»¥å¼•ç”¨<code>A</code>å­ç±»çš„æ³›å‹å®ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä¸Šç•Œä¿è¯å–å‡ºæ¥çš„å…ƒç´ ä¸€å®šæ˜¯Numberï¼Œä½†æ— æ³•çº¦æŸæ”¾å…¥çš„ç±»å‹</span><br>List&lt;Integer&gt; integers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>List&lt;Float&gt; floats = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(); <br>List&lt;? extends Number&gt; numbers = integers;<span class="hljs-comment">// numbers = floats; ä¹Ÿå¯ä»¥</span><br>numbers.get(<span class="hljs-number">0</span>);<span class="hljs-comment">// okï¼Œæ€»èƒ½ä¿è¯å–å‡ºçš„ä¸€å®šæ˜¯Number</span><br>numbers.put(<span class="hljs-number">1</span>);<span class="hljs-comment">// compile errorï¼Œæ— æ³•ä¿è¯æ”¾å…¥çš„æ˜¯å¦ç¬¦åˆçº¦æŸ</span><br></code></pre></td></tr></table></figure><p><strong>2.ä¸‹ç•Œ</strong></p><p>å¦‚æœæ³›å‹å£°æ˜ä¸º<code>&lt;? super B&gt;</code>ï¼Œå³å£°æ˜è¯¥æ³›å‹çš„ä¸‹ç•Œä¸º<code>B</code>ï¼ŒåŸå§‹ç±»å‹ä»ä¸º<code>Object</code>ï¼ŒåŒæ—¶è¯¥æ³›å‹ç±»çš„å®åŠ›å¯ä»¥å¼•ç”¨<code>B</code>çˆ¶ç±»çš„æ³›å‹å®ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å‡è®¾ä¸‰ä¸ªç»§æ‰¿ç±» Child -&gt; Father -&gt; GrandFather</span><br><span class="hljs-comment">// ä¸‹ç•Œä¿è¯å†™å…¥çš„å…ƒç´ ä¸€å®šæ˜¯Childï¼Œä½†æ— æ³•ç¡®å®šå–å‡ºçš„ç±»å‹</span><br>List&lt;Father&gt; fathers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>List&lt;GrandFather&gt; grandFathers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>List&lt;? <span class="hljs-keyword">super</span> Child&gt; childs = fathers;<span class="hljs-comment">// childs = grandFathers; ä¹Ÿå¯ä»¥</span><br>numbers.put(<span class="hljs-keyword">new</span> Child());<span class="hljs-comment">//okï¼Œæ€»èƒ½ä¿è¯å®é™…å®¹å™¨å¯æ¥å—Child</span><br>Child ele = (Child) numbers.get(<span class="hljs-number">0</span>);<span class="hljs-comment">// runtime errorï¼Œæ— æ³•ç¡®å®šå¾—åˆ°çš„å…·ä½“ç±»å‹</span><br></code></pre></td></tr></table></figure><p>åœ¨Javaä¸­ï¼Œæ ¹æ®é‡Œå¼æ›¿æ¢åŸåˆ™ï¼Œå‘ä¸Šè½¬å‹æ˜¯é»˜è®¤åˆæ³•çš„ï¼Œå‘ä¸‹è½¬å‹åˆ™éœ€è¦å¼ºåˆ¶è½¬æ¢ï¼Œå¦‚ä¸èƒ½è½¬æ¢åˆ™æŠ¥é”™ã€‚åœ¨<code>extends</code>çš„<code>get</code>å’Œ<code>super</code>çš„<code>put</code>åœºæ™¯ä¸­ï¼Œä¸€å®šå¯ä»¥ä¿è¯è¯»å–/æ”¾å…¥çš„å…ƒç´ æ˜¯å¯ä»¥å‘ä¸Šè½¬å‹çš„ï¼Œè€Œåœ¨<code>extends</code>çš„<code>put</code>å’Œ<code>super</code>çš„<code>get</code>ä¸­ï¼Œåˆ™æ— æ³•ç¡®è®¤å¯è½¬çš„ç±»å‹ï¼Œå› æ­¤<code>extends</code>åªèƒ½è¯»å–ï¼Œ<code>super</code>åªèƒ½å†™å…¥ã€‚</p><blockquote><p>å½“ç„¶å¦‚æœä½¿ç”¨superæ—¶ï¼Œå–å‡ºçš„å¯¹è±¡ä»¥Objectå­˜æ”¾ï¼Œä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºsuperæ“¦é™¤åçš„åŸå§‹ç±»å‹ä¸ºObjectã€‚</p></blockquote><p>å‚è€ƒã€ŠEffective Javaã€‹ä¸­ç»™å‡ºçš„<code>PECS</code>ä½¿ç”¨å»ºè®®ã€‚</p><blockquote><p>ä¸ºäº†è·å¾—æœ€å¤§é™åº¦çš„çµæ´»æ€§ï¼Œè¦åœ¨è¡¨ç¤ºç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…çš„è¾“å…¥å‚æ•°ä¸Šä½¿ç”¨é€šé…ç¬¦ç±»å‹ã€‚</p><p>å¦‚æœå‚æ•°åŒ–ç±»å‹è¡¨ç¤ºä¸€ä¸ªTç”Ÿäº§è€…ï¼Œå°±ä½¿ç”¨&lt;? extends T&gt;ã€‚ producer-extends</p><p>å¦‚æœå‚æ•°åŒ–ç±»å‹è¡¨ç¤ºä¸€ä¸ªTæ¶ˆè´¹è€…ï¼Œå°±ä½¿ç”¨&lt;? super T&gt;ã€‚consumer-super</p><p>å¦‚æœæŸä¸ªè¾“å…¥å‚æ•°å³æ˜¯ç”Ÿäº§è€…åˆæ˜¯æ¶ˆè´¹è€…ï¼Œé‚£ä¹ˆé€šé…ç¬¦ç±»å‹å¯¹ä½ å°±æ²¡ä»€ä¹ˆå¥½å¤„äº†ã€‚</p></blockquote><p><strong>ä¸ªäººè®¤ä¸º</strong>å¯¹è¿™æ®µè¯çš„æ­£ç¡®ç†è§£æ˜¯ä»¥æ³›å‹ä¸ºç¬¬ä¸€è§†è§’åˆ‡å…¥ï¼Œå³å½“<strong>æ³›å‹ç±»å‹æœ¬èº«ä½œä¸ºç”Ÿäº§è€…æä¾›åŠŸèƒ½</strong>(è¢«è¯»å–)æ—¶ä½¿ç”¨<code>extends</code>ï¼Œåä¹‹(è¢«å†™å…¥)ä½¿ç”¨<code>super</code>ã€‚è€Œéå¸¸è§„æ„ä¹‰ä¸Šç”Ÿäº§è€…è¦å†™å…¥çš„å®¹å™¨é‡‡ç”¨<code>extends</code>ï¼Œæ¶ˆè´¹è€…è¯»å–çš„å®¹å™¨ä½¿ç”¨<code>super</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">// producerï¼Œæ­¤æ—¶è¿”å›å€¼ä½œä¸ºç”Ÿäº§åçš„ç»“æœæä¾›ç»™æ¶ˆè´¹è€…</span><br>List&lt;? extends A&gt; writeBuffer(...);<br><span class="hljs-comment">// consumerï¼Œæ­¤æ—¶è¿”å›å€¼ä½œä¸ºæ¶ˆè´¹åçš„ç»“æœæä¾›ç»™ç”Ÿäº§è€…</span><br>List&lt;? <span class="hljs-keyword">super</span> B&gt; readBuffer(...);<br></code></pre></td></tr></table></figure><h3 id="Javaæ³›å‹çš„å¤šæ€"><a href="#Javaæ³›å‹çš„å¤šæ€" class="headerlink" title="Javaæ³›å‹çš„å¤šæ€"></a>Javaæ³›å‹çš„å¤šæ€</h3><p>æ³›å‹ç±»ä¹Ÿå¯ä»¥è¢«ç»§æ‰¿ï¼Œæ³›å‹ç±»ä¸»è¦æœ‰ä¸¤ç§ç»§æ‰¿æ–¹å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Father</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123; <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(T param)</span></span>&#123;<br>    <br>  &#125; <br>&#125;<br><span class="hljs-comment">// æ³›å‹ç»§æ‰¿ï¼ŒChildä¾ç„¶æ˜¯æ³›å‹ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Child</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">Father</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123; <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(T param)</span></span>&#123;&#125; <br>&#125;<br><span class="hljs-comment">// æŒ‡å®šæ³›å‹ç±»å‹ï¼ŒStringChildä¸ºå…·ä½“ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringChild</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Father</span>&lt;<span class="hljs-title">String</span>&gt; </span>&#123; <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(String param)</span></span>&#123;&#125; <br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“<code>@Override</code>æ˜¯ä¿æŒç­¾åä¸å˜ä¸”é‡å†™çˆ¶ç±»æ–¹æ³•ï¼ŒæŸ¥çœ‹<code>Father</code>ç±»å­—èŠ‚ç ï¼Œå…¶ä¸­testæ–¹æ³•è¢«æ“¦é™¤ä¸º<code>void test(Object param)</code>ï¼›åœ¨<code>StringChild</code>ä¸­ï¼Œæ–¹æ³•ç­¾åä¸º<code>void test(String param)</code>ã€‚åˆ°æ­¤è¯»è€…å¯èƒ½æ„è¯†åˆ°ï¼Œè¿™æ ¹æœ¬ä¸æ˜¯é‡å†™è€Œæ˜¯é‡è½½(<code>Overload</code>)ã€‚</p><p>æŸ¥çœ‹<code>StringChild</code>çš„å­—èŠ‚ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">...<br>#<span class="hljs-number">3</span> = Methodref<br>...<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(java.lang.String)</span></span>;<br>    ...<br>    invokespecial #<span class="hljs-number">3</span> <span class="hljs-comment">// Method StringChild.test:(Ljava/lang.Object;) V</span><br>    ...<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(java.lang.Object)</span></span>;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å…¶ä¸­å®é™…åŒ…å«äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªå‚æ•°æ˜¯<code>String</code>ä¸€ä¸ªæ˜¯<code>Object</code>ï¼Œåè€…æ‰æ˜¯å¯¹çˆ¶ç±»æ–¹æ³•çš„é‡å†™ï¼Œå‰è€…é€šè¿‡invokeè½¬åˆ°å¯¹åè€…çš„è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯JVMåœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨æ·»åŠ çš„ï¼Œä¹Ÿå«åš<strong>æ¡¥æ–¹æ³•</strong>ã€‚åŒæ—¶è¿˜æœ‰ä¸€ç‚¹éœ€è¦æåŠï¼Œç¤ºä¾‹ä¸­çš„ä»£ç æ˜¯ä»¥æ³›å‹å‚æ•°ä½œä¸ºå…¥å‚ï¼Œä½œä¸ºè¿”å›ç±»å‹çš„è¯ä¼šäº§ç”Ÿ<code>Object test()</code>å’Œ<code>String test()</code>ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åœ¨å¸¸è§„çš„ç¼–ç ä¸­æ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ï¼Œä½†JVMä¸ºæ³›å‹å¤šæ€çš„å®ç°å…è®¸äº†è¿™ä¸ªä¸åˆè§„çš„å­˜åœ¨ã€‚</p><h3 id="Javaæ³›å‹ä½¿ç”¨çš„å±€é™"><a href="#Javaæ³›å‹ä½¿ç”¨çš„å±€é™" class="headerlink" title="Javaæ³›å‹ä½¿ç”¨çš„å±€é™"></a>Javaæ³›å‹ä½¿ç”¨çš„å±€é™</h3><ul><li>åŸºæœ¬ç±»å‹æ— æ³•æ“¦é™¤ä¸ºåŸå§‹ç±»å‹<code>Object</code>ï¼Œå› æ­¤èŒƒå‹ä¸æ”¯æŒåŸºæœ¬ç±»å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;<span class="hljs-keyword">int</span>&gt; intList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(); <span class="hljs-comment">// æ— æ³•ç¼–è¯‘</span><br></code></pre></td></tr></table></figure><ul><li>ç”±äºç±»å‹æ“¦é™¤ï¼Œæ³›å‹ä»£ç å†…éƒ¨åœ¨è¿è¡ŒæœŸæ— æ³•è·å¾—å…·ä½“ç±»å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">T instance = <span class="hljs-keyword">new</span> T();   <span class="hljs-comment">// ä¸èƒ½ç›´æ¥ä½¿ç”¨æ³›å‹åˆå§‹åŒ–</span><br><span class="hljs-keyword">if</span> (t instanceOf T);    <span class="hljs-comment">// ä¸èƒ½åˆ¤æ–­æ³›å‹ç±»å‹</span><br>T[] array = <span class="hljs-keyword">new</span> T[]&#123;&#125;;  <span class="hljs-comment">// ä¸èƒ½åˆ›å»ºæ³›å‹æ•°ç»„</span><br></code></pre></td></tr></table></figure><ul><li>ç”±äºé™æ€èµ„æºåŠ è½½å…ˆäºç±»å‹å®ä¾‹åŒ–ï¼Œä¸èƒ½åœ¨é™æ€ä»£ç å—å¼•ç”¨æ³›å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Error</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Generic</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> T t;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> T <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-keyword">return</span> t;&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><ul><li>å¼‚å¸¸ç±»å‹çš„æ´¾ç”Ÿç±»ä¸èƒ½æ·»åŠ æ³›å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å‡è®¾ç»§æ‰¿å®ç°ä¸€ä¸ªæ³›å‹å¼‚å¸¸</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SomeException</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">Exception</span>...</span><br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-title">try</span> </span>&#123;<br>    ...<br>&#125; <span class="hljs-keyword">catch</span>(SomeException&lt;Integer&gt; | SomeException&lt;String&gt; ex) &#123;<br>    <span class="hljs-comment">//ç”±äºç±»å‹æ“¦é™¤ï¼Œæ— æ³•æ•è·å¤šä¸ªæ³›å‹å¼‚å¸¸</span><br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><p>å‚è€ƒ:</p><hr><p>ç¨‹åºé±¼:<a href="https://www.jianshu.com/p/95f349258afb">https://www.jianshu.com/p/95f349258afb</a><br>æ‹‰å¤«å¾·é²:<a href="https://juejin.cn/post/6996285441943011341">https://juejin.cn/post/6996285441943011341</a></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaåŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaåŸºç¡€æ¦‚å¿µ</title>
    <link href="/2021/10/24/Java%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2021/10/24/Java%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="åŸºç¡€æ¦‚å¿µä¸å¸¸è¯†"><a href="#åŸºç¡€æ¦‚å¿µä¸å¸¸è¯†" class="headerlink" title="åŸºç¡€æ¦‚å¿µä¸å¸¸è¯†"></a>åŸºç¡€æ¦‚å¿µä¸å¸¸è¯†</h2><h3 id="Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹"><a href="#Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹" class="headerlink" title="Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹"></a>Javaè¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹</h3><ol><li>ç®€å•æ˜“å­¦ï¼›</li><li>é¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰ï¼›</li><li>å¹³å°æ— å…³æ€§(Javaè™šæ‹Ÿæœºå®ç°å¹³å°æ— å…³æ€§)ï¼›</li><li>æ”¯æŒå¤šçº¿ç¨‹ï¼›</li><li>å¯é æ€§ï¼›</li><li>å®‰å…¨æ€§ï¼›</li><li>æ”¯æŒç½‘ç»œç¼–ç¨‹å¹¶ä¸”å¾ˆæ–¹ä¾¿(Javaè¯­è¨€è¯ç”Ÿæœ¬èº«å°±æ˜¯ä¸ºç®€åŒ–ç½‘ç»œç¼–ç¨‹è®¾è®¡çš„ï¼Œå› æ­¤Javaè¯­è¨€ä¸ä»…æ”¯æŒç½‘ç»œç¼–ç¨‹è€Œä¸”å¾ˆæ–¹ä¾¿)ï¼›</li><li>ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜ï¼›</li></ol><h3 id="JVM-vs-JDK-vs-JRE"><a href="#JVM-vs-JDK-vs-JRE" class="headerlink" title="JVM vs JDK vs JRE"></a>JVM vs JDK vs JRE</h3><h4 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h4><p>Javaè™šæ‹Ÿæœº(JVM)æ˜¯è¿è¡ŒJavaå­—èŠ‚ç çš„è™šæ‹Ÿæœºã€‚JVMæœ‰é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„ç‰¹å®šå®ç°(Windowsï¼ŒLinuxï¼ŒMacos)ï¼Œç›®çš„æ˜¯ä½¿ç”¨ç›¸åŒçš„å­—èŠ‚ç ,ä»–ä»¬éƒ½ä¼šç»™å‡ºç›¸åŒçš„ç»“æœã€‚</p><h4 id="ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„"><a href="#ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„" class="headerlink" title="ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„"></a>ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„</h4><blockquote><p>åœ¨Javaä¸­ï¼ŒJVMå¯ä»¥ç†è§£çš„ä»£ç å°±å«åš <code>å­—èŠ‚ç </code> (å³æ‰©å±•åä¸º<code>.class</code>çš„æ–‡ä»¶)ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚Javaè¯­è¨€é€šè¿‡å­—èŠ‚ç çš„æ–¹å¼ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†ä¼ ç»Ÿè§£å‹è¯­è¨€æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼ŒåŒæ—¶åˆä¿ç•™è§£é‡Šå‹è¯­è¨€å¯ç§»å€¼çš„ç‰¹ç‚¹ã€‚æ‰€ä»¥Javaç¨‹åºè¿è¡Œæ—¶æ¯”è¾ƒé«˜æ•ˆï¼Œè€Œä¸”ï¼Œç”±äºå­—èŠ‚ç å¹¶ä¸é’ˆå¯¹ä¸€ç§ç‰¹å®šçš„æœºå™¨ï¼Œå› æ­¤ï¼ŒJavaç¨‹åºæ— éœ€é‡æ–°ç¼–è¯‘ä¾¿å¯åœ¨å¤šç§ä¸åŒæ“ä½œç³»ç»Ÿçš„è®¡ç®—æœºä¸Šè¿è¡Œã€‚</p></blockquote><p> <strong>Java ç¨‹åºä»æºä»£ç åˆ°è¿è¡Œä¸€èˆ¬æœ‰ä¸‹é¢ 3 æ­¥ï¼š</strong> </p><p><img src="/img/work/1634221350574.png"></p><p>æˆ‘ä»¬éœ€è¦æ ¼å¤–æ³¨æ„çš„æ˜¯.class -&gt; æœºå™¨ç ã€‚åœ¨è¿™ä¸€æ­¥JVMç±»åŠ è½½å™¨é¦–å…ˆåŠ è½½å­—èŠ‚ç æ–‡ä»¶ï¼Œç„¶åé€šè¿‡è§£é‡Šå™¨é€è¡Œè§£é‡Šæ‰§è¡Œï¼Œè¿™ç§æ–¹å¼çš„æ‰§è¡Œé€Ÿåº¦ä¼šç›¸å¯¹æ¯”è¾ƒæ…¢ã€‚è€Œä¸”ï¼Œæœ‰äº›æ–¹æ³•å’Œä»£ç å—æ˜¯ç»å¸¸éœ€è¦è¢«è°ƒç”¨çš„(ä¹Ÿå°±æ˜¯æ‰€è°“çš„çƒ­ç‚¹ä»£ç )ï¼Œæ‰€ä»¥åé¢å¼•è¿›äº†JITç¼–è¯‘å™¨ï¼Œè€ŒJITç¼–è¯‘å™¨å±äºè¿è¡Œæ—¶ç¼–è¯‘ã€‚å½“JITç¼–è¯‘å™¨å®Œæˆç¬¬ä¸€æ¬¡ç¼–è¯‘ä¹‹åï¼Œå…¶ä¼šå°†å­—èŠ‚ç å¯¹åº”çš„æœºå™¨ç ä¿å­˜ä¸‹æ¥ï¼Œä¸‹æ¬¡å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚è€Œæˆ‘ä»¬çŸ¥é“ï¼Œæœºå™¨ç çš„è¿è¡Œæ•ˆç‡è‚¯å®šé«˜äºJavaè§£é‡Šå™¨çš„ã€‚è¿™ä¹Ÿè§£é‡Šäº†æˆ‘ä»¬ä¸ºä»€ä¹ˆç»å¸¸ä¼šè¯´Javaæ˜¯ç¼–è¯‘ä¸è§£é‡Šå…±å­˜çš„è¯­è¨€ã€‚</p><blockquote><p> HotSpot é‡‡ç”¨äº†æƒ°æ€§è¯„ä¼°(Lazy Evaluation)çš„åšæ³•ï¼Œæ ¹æ®äºŒå…«å®šå¾‹ï¼Œæ¶ˆè€—å¤§éƒ¨åˆ†ç³»ç»Ÿèµ„æºçš„åªæœ‰é‚£ä¸€å°éƒ¨åˆ†çš„ä»£ç ï¼ˆçƒ­ç‚¹ä»£ç ï¼‰ï¼Œè€Œè¿™ä¹Ÿå°±æ˜¯ JIT æ‰€éœ€è¦ç¼–è¯‘çš„éƒ¨åˆ†ã€‚JVM ä¼šæ ¹æ®ä»£ç æ¯æ¬¡è¢«æ‰§è¡Œçš„æƒ…å†µæ”¶é›†ä¿¡æ¯å¹¶ç›¸åº”åœ°åšå‡ºä¸€äº›ä¼˜åŒ–ï¼Œå› æ­¤æ‰§è¡Œçš„æ¬¡æ•°è¶Šå¤šï¼Œå®ƒçš„é€Ÿåº¦å°±è¶Šå¿«ã€‚JDK 9 å¼•å…¥äº†ä¸€ç§æ–°çš„ç¼–è¯‘æ¨¡å¼ AOT(Ahead of Time Compilation)ï¼Œå®ƒæ˜¯ç›´æ¥å°†å­—èŠ‚ç ç¼–è¯‘æˆæœºå™¨ç ï¼Œè¿™æ ·å°±é¿å…äº† JIT é¢„çƒ­ç­‰å„æ–¹é¢çš„å¼€é”€ã€‚JDK æ”¯æŒåˆ†å±‚ç¼–è¯‘å’Œ AOT åä½œä½¿ç”¨ã€‚ä½†æ˜¯ ï¼ŒAOT ç¼–è¯‘å™¨çš„ç¼–è¯‘è´¨é‡æ˜¯è‚¯å®šæ¯”ä¸ä¸Š JIT ç¼–è¯‘å™¨çš„ã€‚ </p></blockquote><p> <strong>æ€»ç»“ï¼š</strong> </p><p> Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰æ˜¯è¿è¡Œ Java å­—èŠ‚ç çš„è™šæ‹Ÿæœº ã€‚ JVM æœ‰é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„ç‰¹å®šå®ç°ï¼ˆWindowsï¼ŒLinuxï¼ŒmacOSï¼‰ï¼Œç›®çš„æ˜¯ä½¿ç”¨ç›¸åŒçš„å­—èŠ‚ç ï¼Œ  å®ƒä»¬éƒ½ä¼šç»™å‡ºç›¸åŒçš„ç»“æœã€‚å­—èŠ‚ç å’Œä¸åŒç³»ç»Ÿçš„ JVM å®ç°æ˜¯ Java è¯­è¨€â€œä¸€æ¬¡ç¼–è¯‘ï¼Œéšå¤„å¯ä»¥è¿è¡Œâ€çš„å…³é”®æ‰€åœ¨ã€‚ </p><h4 id="JDK-å’Œ-JRE"><a href="#JDK-å’Œ-JRE" class="headerlink" title="JDK å’Œ JRE"></a>JDK å’Œ JRE</h4><p>JDK æ˜¯ Java Development Kit ç¼©å†™ï¼Œå®ƒæ˜¯åŠŸèƒ½é½å…¨çš„ Java SDKã€‚å®ƒæ‹¥æœ‰ JRE æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡ï¼Œè¿˜æœ‰ç¼–è¯‘å™¨(javacï¼‰å’Œå·¥å…·ï¼ˆå¦‚ javadoc å’Œ jdbï¼‰ã€‚å®ƒèƒ½å¤Ÿåˆ›å»ºå’Œç¼–è¯‘ç¨‹åºã€‚ </p><p>JRE æ˜¯ Java è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒæ˜¯è¿è¡Œå·²ç¼–è¯‘ Java ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å†…å®¹çš„é›†åˆï¼ŒåŒ…æ‹¬ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰ï¼ŒJava ç±»åº“ï¼Œjava å‘½ä»¤å’Œå…¶ä»–çš„ä¸€äº›åŸºç¡€æ„ä»¶ã€‚ä½†æ˜¯ï¼Œå®ƒä¸èƒ½ç”¨äºåˆ›å»ºæ–°ç¨‹åºã€‚ </p><p>å¦‚æœä½ åªæ˜¯ä¸ºäº†è¿è¡Œä¸€ä¸‹ Java ç¨‹åºçš„è¯ï¼Œé‚£ä¹ˆä½ åªéœ€è¦å®‰è£… JRE å°±å¯ä»¥äº†ã€‚å¦‚æœä½ éœ€è¦è¿›è¡Œä¸€äº› Java ç¼–ç¨‹æ–¹é¢çš„å·¥ä½œï¼Œé‚£ä¹ˆä½ å°±éœ€è¦å®‰è£… JDK äº†ã€‚ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯ç»å¯¹çš„ã€‚æœ‰æ—¶ï¼Œå³ä½¿æ‚¨ä¸æ‰“ç®—åœ¨è®¡ç®—æœºä¸Šè¿›è¡Œä»»ä½• Java å¼€å‘ï¼Œä»ç„¶éœ€è¦å®‰è£… JDKã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦ä½¿ç”¨ JSP éƒ¨ç½² Web åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆä»æŠ€æœ¯ä¸Šè®²ï¼Œæ‚¨åªæ˜¯åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¸­è¿è¡Œ Java ç¨‹åºã€‚é‚£ä½ ä¸ºä»€ä¹ˆéœ€è¦ JDK å‘¢ï¼Ÿå› ä¸ºåº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¼šå°† JSP è½¬æ¢ä¸º Java servletï¼Œå¹¶ä¸”éœ€è¦ä½¿ç”¨ JDK æ¥ç¼–è¯‘ servletã€‚ </p><h3 id="Java-è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜"><a href="#Java-è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜" class="headerlink" title="Java è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜"></a>Java è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜</h3><p>é«˜çº§ç¼–ç¨‹è¯­è¨€æŒ‰ç…§ç¨‹åºçš„æ‰§è¡Œæ–¹å¼åˆ†ä¸ºç¼–è¯‘å‹å’Œè§£é‡Šå‹ä¸¤ç§ã€‚ç®€å•æ¥è¯´ï¼Œç¼–è¯‘å‹è¯­è¨€æ˜¯æŒ‡ç¼–è¯‘å™¨é’ˆå¯¹ç‰¹å®šçš„æ“ä½œç³»ç»Ÿå°†æºä»£ç ä¸€æ¬¡æ€§ç¿»è¯‘æˆå¯è¢«è¯¥å¹³å°æ‰§è¡Œçš„æœºå™¨ç ï¼›è§£é‡Šå‹è¯­è¨€æ˜¯æŒ‡è§£é‡Šå™¨å¯¹æºç¨‹åºé€è¡Œè§£é‡Šæˆç‰¹å®šå¹³å°çš„æœºå™¨ç å¹¶ç«‹å³æ‰§è¡Œã€‚æ¯”å¦‚ï¼Œä½ æƒ³é˜…è¯»ä¸€æœ¬è‹±æ–‡åè‘—ï¼Œä½ å¯ä»¥æ‰¾ä¸€ä¸ªè‹±æ–‡ç¿»è¯‘äººå‘˜å¸®åŠ©ä½ é˜…è¯»ï¼Œ æœ‰ä¸¤ç§é€‰æ‹©æ–¹å¼ï¼Œä½ å¯ä»¥å…ˆç­‰ç¿»è¯‘äººå‘˜å°†å…¨æœ¬çš„è‹±æ–‡åè‘—ï¼ˆä¹Ÿå°±æ˜¯æºç ï¼‰éƒ½ç¿»è¯‘æˆæ±‰è¯­ï¼Œå†å»é˜…è¯»ï¼Œä¹Ÿå¯ä»¥è®©ç¿»è¯‘äººå‘˜ç¿»è¯‘ä¸€æ®µï¼Œä½ åœ¨æ—è¾¹é˜…è¯»ä¸€æ®µï¼Œæ…¢æ…¢æŠŠä¹¦è¯»å®Œã€‚</p><p>Java è¯­è¨€æ—¢å…·æœ‰ç¼–è¯‘å‹è¯­è¨€çš„ç‰¹å¾ï¼Œä¹Ÿå…·æœ‰è§£é‡Šå‹è¯­è¨€çš„ç‰¹å¾ï¼Œå› ä¸º Java ç¨‹åºè¦ç»è¿‡å…ˆç¼–è¯‘ï¼Œåè§£é‡Šä¸¤ä¸ªæ­¥éª¤ï¼Œç”± Java ç¼–å†™çš„ç¨‹åºéœ€è¦å…ˆç»è¿‡ç¼–è¯‘æ­¥éª¤ï¼Œç”Ÿæˆå­—èŠ‚ç ï¼ˆ<code>*.class</code> æ–‡ä»¶ï¼‰ï¼Œè¿™ç§å­—èŠ‚ç å¿…é¡»ç”± Java è§£é‡Šå™¨æ¥è§£é‡Šæ‰§è¡Œã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸º Java è¯­è¨€ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜ã€‚</p><h3 id="Java-å’Œ-C-çš„åŒºåˆ«"><a href="#Java-å’Œ-C-çš„åŒºåˆ«" class="headerlink" title="Java å’Œ C++çš„åŒºåˆ«"></a>Java å’Œ C++çš„åŒºåˆ«</h3><ul><li>éƒ½æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒå°è£…ã€ç»§æ‰¿å’Œå¤šæ€</li><li>Java ä¸æä¾›æŒ‡é’ˆæ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨</li><li>Java çš„ç±»æ˜¯å•ç»§æ‰¿çš„ï¼ŒC++ æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶ Java çš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚</li><li>Java æœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†åƒåœ¾å›æ”¶æœºåˆ¶(GC)ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜ã€‚</li><li>C ++åŒæ—¶æ”¯æŒæ–¹æ³•é‡è½½å’Œæ“ä½œç¬¦é‡è½½ï¼Œä½†æ˜¯ Java åªæ”¯æŒæ–¹æ³•é‡è½½ï¼ˆæ“ä½œç¬¦é‡è½½å¢åŠ äº†å¤æ‚æ€§ï¼Œè¿™ä¸ Java æœ€åˆçš„è®¾è®¡æ€æƒ³ä¸ç¬¦ï¼‰ã€‚</li></ul><h2 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h2><h3 id="åŸºæœ¬ç±»å‹"><a href="#åŸºæœ¬ç±»å‹" class="headerlink" title="åŸºæœ¬ç±»å‹"></a>åŸºæœ¬ç±»å‹</h3><p>å…«ä¸ªåŸºæœ¬ç±»å‹</p><ul><li>byteï¼ˆå­—èŠ‚å‹ï¼‰</li><li>shortï¼ˆçŸ­æ•´å‹ï¼‰</li><li>intï¼ˆæ•´å‹ï¼‰</li><li>longï¼ˆé•¿æ•´å‹ï¼‰</li><li>floatï¼ˆå•ç²¾åº¦æµ®ç‚¹å‹ï¼‰</li><li>doubleï¼ˆåŒç²¾åº¦æµ®ç‚¹å‹ï¼‰</li><li>booleanï¼ˆå¸ƒå°”å‹ï¼‰</li><li>charï¼ˆå­—ç¬¦å‹ï¼‰</li></ul><h3 id="å¯¹åº”åŒ…è£…ç±»"><a href="#å¯¹åº”åŒ…è£…ç±»" class="headerlink" title="å¯¹åº”åŒ…è£…ç±»"></a>å¯¹åº”åŒ…è£…ç±»</h3><ul><li>Byte</li><li>Short</li><li>Integer</li><li>Long</li><li>Float</li><li>Double</li><li>Boolean</li><li>Character</li></ul><h3 id="è¯¦ç»†åˆ’åˆ†"><a href="#è¯¦ç»†åˆ’åˆ†" class="headerlink" title="è¯¦ç»†åˆ’åˆ†"></a>è¯¦ç»†åˆ’åˆ†</h3><p><strong>å…·ä½“å¯åˆ†ä¸ºå››ç±»</strong></p><ul><li>æ•´å‹ byte short int long</li><li>æµ®ç‚¹å‹ float double</li><li>é€»è¾‘å‹ boolean</li><li>å­—ç¬¦å‹ char</li></ul><h3 id="å…«ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é»˜è®¤å€¼"><a href="#å…«ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é»˜è®¤å€¼" class="headerlink" title="å…«ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é»˜è®¤å€¼"></a>å…«ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é»˜è®¤å€¼</h3><p><img src="/img/work/image-20211021215018133.png"></p><p>åŸºæœ¬ç±»å‹éƒ½æœ‰å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼ŒåŸºæœ¬ç±»å‹ä¸å…¶å¯¹åº”çš„åŒ…è£…ç±»å‹ä¹‹é—´çš„èµ‹å€¼ä½¿ç”¨è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±å®Œæˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Integer x = <span class="hljs-number">2</span>;     <span class="hljs-comment">// è£…ç®±</span><br><span class="hljs-keyword">int</span> y = x;         <span class="hljs-comment">// æ‹†ç®±</span><br></code></pre></td></tr></table></figure><h3 id="ç¼“å­˜æ± "><a href="#ç¼“å­˜æ± " class="headerlink" title="ç¼“å­˜æ± "></a>ç¼“å­˜æ± </h3><p>new Integer(123) ä¸ Integer.valueOf(123) çš„åŒºåˆ«åœ¨äº:</p><ul><li>new Integer(123) æ¯æ¬¡éƒ½ä¼šæ–°å»ºä¸€ä¸ªå¯¹è±¡</li><li>Integer.valueOf(123) ä¼šä½¿ç”¨ç¼“å­˜æ± ä¸­çš„å¯¹è±¡ï¼Œå¤šæ¬¡è°ƒç”¨ä¼šå–å¾—åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">Integer x = <span class="hljs-keyword">new</span> Integer(<span class="hljs-number">123</span>);<br>Integer y = <span class="hljs-keyword">new</span> Integer(<span class="hljs-number">123</span>);<br>System.out.println(x == y);    <span class="hljs-comment">// false</span><br>Integer z = Integer.valueOf(<span class="hljs-number">123</span>);<br>Integer k = Integer.valueOf(<span class="hljs-number">123</span>);<br>System.out.println(z == k);   <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p><strong>valueOf() æ–¹æ³•çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å…ˆåˆ¤æ–­å€¼æ˜¯å¦åœ¨ç¼“å­˜æ± ä¸­ï¼Œå¦‚æœåœ¨çš„è¯å°±ç›´æ¥è¿”å›ç¼“å­˜æ± çš„å†…å®¹ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title">valueOf</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)<br>        <span class="hljs-keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Integer(i);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>åœ¨ Java 8 ä¸­ï¼ŒInteger ç¼“å­˜æ± çš„å¤§å°é»˜è®¤ä¸º -128~127ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> low = -<span class="hljs-number">128</span>;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> high;<br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Integer cache[];<br><br><span class="hljs-keyword">static</span> &#123;<br>    <span class="hljs-comment">// high value may be configured by property</span><br>    <span class="hljs-keyword">int</span> h = <span class="hljs-number">127</span>;<br>    String integerCacheHighPropValue =<br>        sun.misc.VM.getSavedProperty(<span class="hljs-string">&quot;java.lang.Integer.IntegerCache.high&quot;</span>);<br>    <span class="hljs-keyword">if</span> (integerCacheHighPropValue != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">int</span> i = parseInt(integerCacheHighPropValue);<br>            i = Math.max(i, <span class="hljs-number">127</span>);<br>            <span class="hljs-comment">// Maximum array size is Integer.MAX_VALUE</span><br>            h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="hljs-number">1</span>);<br>        &#125; <span class="hljs-keyword">catch</span>( NumberFormatException nfe) &#123;<br>            <span class="hljs-comment">// If the property cannot be parsed into an int, ignore it.</span><br>        &#125;<br>    &#125;<br>    high = h;<br><br>    cache = <span class="hljs-keyword">new</span> Integer[(high - low) + <span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">int</span> j = low;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; cache.length; k++)<br>        cache[k] = <span class="hljs-keyword">new</span> Integer(j++);<br><br>    <span class="hljs-comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span><br>    <span class="hljs-keyword">assert</span> IntegerCache.high &gt;= <span class="hljs-number">127</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ä¼š<strong>åœ¨ç¼“å†²æ± èŒƒå›´å†…çš„åŸºæœ¬ç±»å‹</strong>è‡ªåŠ¨è£…ç®±è¿‡ç¨‹è°ƒç”¨ valueOf() æ–¹æ³•ï¼Œå› æ­¤å¤šä¸ª Integer å®ä¾‹ä½¿ç”¨è‡ªåŠ¨è£…ç®±æ¥åˆ›å»ºå¹¶ä¸”å€¼ç›¸åŒï¼Œé‚£ä¹ˆå°±ä¼šå¼•ç”¨ç›¸åŒçš„å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Integer m = <span class="hljs-number">123</span>;<br>Integer n = <span class="hljs-number">123</span>;<br>System.out.println(m == n); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>åŸºæœ¬ç±»å‹å¯¹åº”çš„ç¼“å†²æ± å¦‚ä¸‹:</p><ul><li>boolean values true and false</li><li>all byte values</li><li>short values between -128 and 127</li><li>int values between -128 and 127</li><li>char in the range \u0000 to \u007F</li></ul><p>åœ¨ä½¿ç”¨è¿™äº›åŸºæœ¬ç±»å‹å¯¹åº”çš„åŒ…è£…ç±»å‹æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å†²æ± ä¸­çš„å¯¹è±¡ã€‚</p><p>å¦‚æœåœ¨ç¼“å†²æ± ä¹‹å¤–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Integer m = <span class="hljs-number">323</span>;<br>Integer n = <span class="hljs-number">323</span>;<br>System.out.println(m == n); <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><h3 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h3><p>String è¢«å£°æ˜ä¸º finalï¼Œå› æ­¤å®ƒä¸å¯è¢«ç»§æ‰¿ã€‚</p><p>å†…éƒ¨ä½¿ç”¨ char æ•°ç»„å­˜å‚¨æ•°æ®ï¼Œè¯¥æ•°ç»„è¢«å£°æ˜ä¸º finalï¼Œè¿™æ„å‘³ç€ value æ•°ç»„åˆå§‹åŒ–ä¹‹åå°±ä¸èƒ½å†å¼•ç”¨å…¶å®ƒæ•°ç»„ã€‚å¹¶ä¸” String å†…éƒ¨æ²¡æœ‰æ”¹å˜ value æ•°ç»„çš„æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥ä¿è¯ String ä¸å¯å˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">String</span></span><br><span class="hljs-class">    <span class="hljs-keyword">implements</span> <span class="hljs-title">java</span>.<span class="hljs-title">io</span>.<span class="hljs-title">Serializable</span>, <span class="hljs-title">Comparable</span>&lt;<span class="hljs-title">String</span>&gt;, <span class="hljs-title">CharSequence</span> </span>&#123;<br>    <span class="hljs-comment">/** The value is used for character storage. */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">char</span> value[];<br><br></code></pre></td></tr></table></figure><h3 id="ä¸å¯å˜çš„å¥½å¤„"><a href="#ä¸å¯å˜çš„å¥½å¤„" class="headerlink" title="ä¸å¯å˜çš„å¥½å¤„"></a>ä¸å¯å˜çš„å¥½å¤„</h3><p><strong>1. å¯ä»¥ç¼“å­˜ hash å€¼</strong></p><p>å› ä¸º String çš„ hash å€¼ç»å¸¸è¢«ä½¿ç”¨ï¼Œä¾‹å¦‚ String ç”¨åš HashMap çš„ keyã€‚ä¸å¯å˜çš„ç‰¹æ€§å¯ä»¥ä½¿å¾— hash å€¼ä¹Ÿä¸å¯å˜ï¼Œå› æ­¤åªéœ€è¦è¿›è¡Œä¸€æ¬¡è®¡ç®—ã€‚</p><p><strong>2. String Pool çš„éœ€è¦</strong></p><p>å¦‚æœä¸€ä¸ª String å¯¹è±¡å·²ç»è¢«åˆ›å»ºè¿‡äº†ï¼Œé‚£ä¹ˆå°±ä¼šä» String Pool ä¸­å–å¾—å¼•ç”¨ã€‚åªæœ‰ String æ˜¯ä¸å¯å˜çš„ï¼Œæ‰å¯èƒ½ä½¿ç”¨ String Poolã€‚</p><p><img src="/img/work/image-20211021222448391.png"></p><p><strong>3. å®‰å…¨æ€§</strong></p><p>String ç»å¸¸ä½œä¸ºå‚æ•°ï¼ŒString ä¸å¯å˜æ€§å¯ä»¥ä¿è¯å‚æ•°ä¸å¯å˜ã€‚ä¾‹å¦‚åœ¨ä½œä¸ºç½‘ç»œè¿æ¥å‚æ•°çš„æƒ…å†µä¸‹å¦‚æœ String æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆåœ¨ç½‘ç»œè¿æ¥è¿‡ç¨‹ä¸­ï¼ŒString è¢«æ”¹å˜ï¼Œæ”¹å˜ String å¯¹è±¡çš„é‚£ä¸€æ–¹ä»¥ä¸ºç°åœ¨è¿æ¥çš„æ˜¯å…¶å®ƒä¸»æœºï¼Œè€Œå®é™…æƒ…å†µå´ä¸ä¸€å®šæ˜¯ã€‚</p><p><strong>4. çº¿ç¨‹å®‰å…¨</strong></p><p>String ä¸å¯å˜æ€§å¤©ç”Ÿå…·å¤‡çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å®‰å…¨åœ°ä½¿ç”¨ã€‚</p><h3 id="String-StringBuffer-and-StringBuilder"><a href="#String-StringBuffer-and-StringBuilder" class="headerlink" title="String, StringBuffer and StringBuilder"></a>String, StringBuffer and StringBuilder</h3><p><strong>1. å¯å˜æ€§</strong></p><ul><li>String ä¸å¯å˜</li><li>StringBuffer å’Œ StringBuilder å¯å˜</li></ul><p><strong>2. çº¿ç¨‹å®‰å…¨</strong></p><ul><li>String ä¸å¯å˜ï¼Œå› æ­¤æ˜¯çº¿ç¨‹å®‰å…¨çš„</li><li>StringBuilder ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</li><li>StringBuffer æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå†…éƒ¨ä½¿ç”¨ synchronized è¿›è¡ŒåŒæ­¥</li></ul><h3 id="String-intern"><a href="#String-intern" class="headerlink" title="String.intern()"></a>String.intern()</h3><p>ä½¿ç”¨ String.intern() å¯ä»¥ä¿è¯ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²å˜é‡å¼•ç”¨åŒä¸€çš„å†…å­˜å¯¹è±¡ã€‚</p><p>ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œs1 å’Œ s2 é‡‡ç”¨ new String() çš„æ–¹å¼æ–°å»ºäº†ä¸¤ä¸ªä¸åŒå¯¹è±¡ï¼Œè€Œ s3 æ˜¯é€šè¿‡ s1.intern() æ–¹æ³•å–å¾—ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ã€‚intern() é¦–å…ˆæŠŠ s1 å¼•ç”¨çš„å¯¹è±¡æ”¾åˆ° String Pool(å­—ç¬¦ä¸²å¸¸é‡æ± )ä¸­ï¼Œç„¶åè¿”å›è¿™ä¸ªå¯¹è±¡å¼•ç”¨ã€‚å› æ­¤ s3 å’Œ s1 å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡æ± çš„å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">String s1 = <span class="hljs-keyword">new</span> String(<span class="hljs-string">&quot;aaa&quot;</span>);<br>String s2 = <span class="hljs-keyword">new</span> String(<span class="hljs-string">&quot;aaa&quot;</span>);<br>System.out.println(s1 == s2);           <span class="hljs-comment">// false</span><br>String s3 = s1.intern();<br>System.out.println(s1.intern() == s3);  <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæ˜¯é‡‡ç”¨ â€œbbbâ€ è¿™ç§ä½¿ç”¨åŒå¼•å·çš„å½¢å¼åˆ›å»ºå­—ç¬¦ä¸²å®ä¾‹ï¼Œä¼šè‡ªåŠ¨åœ°å°†æ–°å»ºçš„å¯¹è±¡æ”¾å…¥ String Pool ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">String s4 = <span class="hljs-string">&quot;bbb&quot;</span>;<br>String s5 = <span class="hljs-string">&quot;bbb&quot;</span>;<br>System.out.println(s4 == s5);  <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>åœ¨ Java 7 ä¹‹å‰ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± è¢«æ”¾åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ï¼Œå®ƒå±äºæ°¸ä¹…ä»£ã€‚è€Œåœ¨ Java 7ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± è¢«ç§»åˆ° Native Method ä¸­ã€‚è¿™æ˜¯å› ä¸ºæ°¸ä¹…ä»£çš„ç©ºé—´æœ‰é™ï¼Œåœ¨å¤§é‡ä½¿ç”¨å­—ç¬¦ä¸²çš„åœºæ™¯ä¸‹ä¼šå¯¼è‡´ OutOfMemoryError é”™è¯¯ã€‚</p><h2 id="è¿ç®—"><a href="#è¿ç®—" class="headerlink" title="è¿ç®—"></a>è¿ç®—</h2><h3 id="å‚æ•°ä¼ é€’"><a href="#å‚æ•°ä¼ é€’" class="headerlink" title="å‚æ•°ä¼ é€’"></a>å‚æ•°ä¼ é€’</h3><p>Java çš„å‚æ•°æ˜¯ä»¥å€¼ä¼ é€’çš„å½¢å¼ä¼ å…¥æ–¹æ³•ä¸­ï¼Œè€Œä¸æ˜¯å¼•ç”¨ä¼ é€’ã€‚</p><p>ä»¥ä¸‹ä»£ç ä¸­ Dog dog çš„ dog æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå­˜å‚¨çš„æ˜¯å¯¹è±¡çš„åœ°å€ã€‚åœ¨å°†ä¸€ä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œæœ¬è´¨ä¸Šæ˜¯å°†å¯¹è±¡çš„åœ°å€ä»¥å€¼çš„æ–¹å¼ä¼ é€’åˆ°å½¢å‚ä¸­ã€‚å› æ­¤åœ¨æ–¹æ³•ä¸­æ”¹å˜æŒ‡é’ˆå¼•ç”¨çš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæŒ‡é’ˆæ­¤æ—¶æŒ‡å‘çš„æ˜¯å®Œå…¨ä¸åŒçš„å¯¹è±¡ï¼Œä¸€æ–¹æ”¹å˜å…¶æ‰€æŒ‡å‘å¯¹è±¡çš„å†…å®¹å¯¹å¦ä¸€æ–¹æ²¡æœ‰å½±å“ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>&#123;<br>    String name;<br><br>    Dog(String name) &#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function">String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function">String <span class="hljs-title">getObjectAddress</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.toString();<br>    &#125;<br>&#125;<br><br><br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PassByValueExample</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Dog dog = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">&quot;A&quot;</span>);<br>        System.out.println(dog.getObjectAddress()); <span class="hljs-comment">// Dog@4554617c</span><br>        func(dog);<br>        System.out.println(dog.getObjectAddress()); <span class="hljs-comment">// Dog@4554617c</span><br>        System.out.println(dog.getName());          <span class="hljs-comment">// A</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">(Dog dog)</span> </span>&#123;<br>        System.out.println(dog.getObjectAddress()); <span class="hljs-comment">// Dog@4554617c</span><br>        dog = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">&quot;B&quot;</span>);<br>        System.out.println(dog.getObjectAddress()); <span class="hljs-comment">// Dog@74a14482</span><br>        System.out.println(dog.getName());          <span class="hljs-comment">// B</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ä½†æ˜¯å¦‚æœåœ¨æ–¹æ³•ä¸­æ”¹å˜å¯¹è±¡çš„å­—æ®µå€¼ä¼šæ”¹å˜åŸå¯¹è±¡è¯¥å­—æ®µå€¼ï¼Œå› ä¸ºæ”¹å˜çš„æ˜¯åŒä¸€ä¸ªåœ°å€æŒ‡å‘çš„å†…å®¹ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PassByValueExample</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Dog dog = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">&quot;A&quot;</span>);<br>        func(dog);<br>        System.out.println(dog.getName());          <span class="hljs-comment">// B</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">(Dog dog)</span> </span>&#123;<br>        dog.setName(<span class="hljs-string">&quot;B&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="float-ä¸-double"><a href="#float-ä¸-double" class="headerlink" title="float ä¸ double"></a>float ä¸ double</h3><p>1.1 å­—é¢é‡å±äº double ç±»å‹ï¼Œä¸èƒ½ç›´æ¥å°† 1.1 ç›´æ¥èµ‹å€¼ç»™ float å˜é‡ï¼Œå› ä¸ºè¿™æ˜¯å‘ä¸‹è½¬å‹ã€‚Java ä¸èƒ½éšå¼æ‰§è¡Œå‘ä¸‹è½¬å‹ï¼Œå› ä¸ºè¿™ä¼šä½¿å¾—ç²¾åº¦é™ä½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">float</span> f = <span class="hljs-number">1.1</span>;  <span class="hljs-comment">//ç¼–è¯‘é”™è¯¯</span><br></code></pre></td></tr></table></figure><p>1.1f å­—é¢é‡æ‰æ˜¯ float ç±»å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">float</span> f = <span class="hljs-number">1.1f</span>;<br></code></pre></td></tr></table></figure><h3 id="éšå¼ç±»å‹è½¬æ¢"><a href="#éšå¼ç±»å‹è½¬æ¢" class="headerlink" title="éšå¼ç±»å‹è½¬æ¢"></a>éšå¼ç±»å‹è½¬æ¢</h3><p>å› ä¸ºå­—é¢é‡ 1 æ˜¯ int ç±»å‹ï¼Œå®ƒæ¯” short ç±»å‹ç²¾åº¦è¦é«˜ï¼Œå› æ­¤ä¸èƒ½éšå¼åœ°å°† int ç±»å‹ä¸‹è½¬å‹ä¸º short ç±»å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">short</span> s1 = <span class="hljs-number">1</span>;<br>s1 = s1 + <span class="hljs-number">1</span>;  <span class="hljs-comment">//ç¼–è¯‘é”™è¯¯</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä½¿ç”¨ += è¿ç®—ç¬¦å¯ä»¥æ‰§è¡Œéšå¼ç±»å‹è½¬æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">s1 += <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„è¯­å¥ç›¸å½“äºå°† s1 + 1 çš„è®¡ç®—ç»“æœè¿›è¡Œäº†å‘ä¸‹è½¬å‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">s1 = (<span class="hljs-keyword">short</span>) (s1 + <span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><h3 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h3><p>ä» Java 7 å¼€å§‹ï¼Œå¯ä»¥åœ¨ switch æ¡ä»¶åˆ¤æ–­è¯­å¥ä¸­ä½¿ç”¨ String å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">String s = <span class="hljs-string">&quot;a&quot;</span>;<br><span class="hljs-keyword">switch</span> (s) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;a&quot;</span>:<br>        System.out.println(<span class="hljs-string">&quot;aaa&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;b&quot;</span>:<br>        System.out.println(<span class="hljs-string">&quot;bbb&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>switch ä¸æ”¯æŒ longï¼Œæ˜¯å› ä¸º switch çš„è®¾è®¡åˆè¡·æ˜¯å¯¹é‚£äº›åªæœ‰å°‘æ•°çš„å‡ ä¸ªå€¼è¿›è¡Œç­‰å€¼åˆ¤æ–­ï¼Œå¦‚æœå€¼è¿‡äºå¤æ‚ï¼Œé‚£ä¹ˆè¿˜æ˜¯ç”¨ if æ¯”è¾ƒåˆé€‚ã€‚</strong></p><h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><h3 id="è®¿é—®æƒé™"><a href="#è®¿é—®æƒé™" class="headerlink" title="è®¿é—®æƒé™"></a>è®¿é—®æƒé™</h3><p>Java ä¸­æœ‰ä¸‰ä¸ªè®¿é—®æƒé™ä¿®é¥°ç¬¦: privateã€protected ä»¥åŠ publicï¼Œå¦‚æœä¸åŠ è®¿é—®ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºåŒ…çº§å¯è§ã€‚</p><p>å¯ä»¥å¯¹ç±»æˆ–ç±»ä¸­çš„æˆå‘˜(å­—æ®µä»¥åŠæ–¹æ³•)åŠ ä¸Šè®¿é—®ä¿®é¥°ç¬¦ã€‚</p><ul><li>ç±»å¯è§è¡¨ç¤ºå…¶å®ƒç±»å¯ä»¥ç”¨è¿™ä¸ªç±»åˆ›å»ºå®ä¾‹å¯¹è±¡ã€‚</li><li>æˆå‘˜å¯è§è¡¨ç¤ºå…¶å®ƒç±»å¯ä»¥ç”¨è¿™ä¸ªç±»çš„å®ä¾‹å¯¹è±¡è®¿é—®åˆ°è¯¥æˆå‘˜ï¼›</li></ul><p>protected ç”¨äºä¿®é¥°æˆå‘˜ï¼Œè¡¨ç¤ºåœ¨ç»§æ‰¿ä½“ç³»ä¸­æˆå‘˜å¯¹äºå­ç±»å¯è§ï¼Œä½†æ˜¯è¿™ä¸ªè®¿é—®ä¿®é¥°ç¬¦å¯¹äºç±»æ²¡æœ‰æ„ä¹‰ã€‚</p><p>è®¾è®¡è‰¯å¥½çš„æ¨¡å—ä¼šéšè—æ‰€æœ‰çš„å®ç°ç»†èŠ‚ï¼ŒæŠŠå®ƒçš„ API ä¸å®ƒçš„å®ç°æ¸…æ™°åœ°éš”ç¦»å¼€æ¥ã€‚æ¨¡å—ä¹‹é—´åªé€šè¿‡å®ƒä»¬çš„ API è¿›è¡Œé€šä¿¡ï¼Œä¸€ä¸ªæ¨¡å—ä¸éœ€è¦çŸ¥é“å…¶ä»–æ¨¡å—çš„å†…éƒ¨å·¥ä½œæƒ…å†µï¼Œè¿™ä¸ªæ¦‚å¿µè¢«ç§°ä¸ºä¿¡æ¯éšè—æˆ–å°è£…ã€‚å› æ­¤è®¿é—®æƒé™åº”å½“å°½å¯èƒ½åœ°ä½¿æ¯ä¸ªç±»æˆ–è€…æˆå‘˜ä¸è¢«å¤–ç•Œè®¿é—®ã€‚</p><p>å¦‚æœå­ç±»çš„æ–¹æ³•é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå­ç±»ä¸­è¯¥æ–¹æ³•çš„è®¿é—®çº§åˆ«ä¸å…è®¸ä½äºçˆ¶ç±»çš„è®¿é—®çº§åˆ«ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿å¯ä»¥ä½¿ç”¨çˆ¶ç±»å®ä¾‹çš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å­ç±»å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯ç¡®ä¿æ»¡è¶³é‡Œæ°æ›¿æ¢åŸåˆ™ã€‚</p><p>å­—æ®µå†³ä¸èƒ½æ˜¯å…¬æœ‰çš„ï¼Œå› ä¸ºè¿™ä¹ˆåšçš„è¯å°±å¤±å»äº†å¯¹è¿™ä¸ªå­—æ®µä¿®æ”¹è¡Œä¸ºçš„æ§åˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥å¯¹å…¶éšæ„ä¿®æ”¹ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼ŒAccessExample æ‹¥æœ‰ id å…±æœ‰å­—æ®µï¼Œå¦‚æœåœ¨æŸä¸ªæ—¶åˆ»ï¼Œæˆ‘ä»¬æƒ³è¦ä½¿ç”¨ int å»å­˜å‚¨ id å­—æ®µï¼Œé‚£ä¹ˆå°±éœ€è¦å»ä¿®æ”¹æ‰€æœ‰çš„å®¢æˆ·ç«¯ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccessExample</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> String id;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨å…¬æœ‰çš„ getter å’Œ setter æ–¹æ³•æ¥æ›¿æ¢å…¬æœ‰å­—æ®µï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥æ§åˆ¶å¯¹å­—æ®µçš„ä¿®æ”¹è¡Œä¸ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccessExample</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getId</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> id + <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setId</span><span class="hljs-params">(String id)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.id = Integer.valueOf(id);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–ï¼Œå¦‚æœæ˜¯åŒ…çº§ç§æœ‰çš„ç±»æˆ–è€…ç§æœ‰çš„åµŒå¥—ç±»ï¼Œé‚£ä¹ˆç›´æ¥æš´éœ²æˆå‘˜ä¸ä¼šæœ‰ç‰¹åˆ«å¤§çš„å½±å“.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccessWithInnerClassExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InnerClass</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> x;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> InnerClass innerClass;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AccessWithInnerClassExample</span><span class="hljs-params">()</span> </span>&#123;<br>        innerClass = <span class="hljs-keyword">new</span> InnerClass();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> innerClass.x;  <span class="hljs-comment">// ç›´æ¥è®¿é—®</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æŠ½è±¡ç±»ä¸æ¥å£"><a href="#æŠ½è±¡ç±»ä¸æ¥å£" class="headerlink" title="æŠ½è±¡ç±»ä¸æ¥å£"></a>æŠ½è±¡ç±»ä¸æ¥å£</h3><p><strong>1. æŠ½è±¡ç±»</strong></p><p>æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•éƒ½ä½¿ç”¨ abstract å…³é”®å­—è¿›è¡Œå£°æ˜ã€‚æŠ½è±¡ç±»ä¸€èˆ¬ä¼šåŒ…å«æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡æ–¹æ³•ä¸€å®šä½äºæŠ½è±¡ç±»ä¸­ã€‚</p><p>æŠ½è±¡ç±»å’Œæ™®é€šç±»æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼ŒæŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œéœ€è¦ç»§æ‰¿æŠ½è±¡ç±»æ‰èƒ½å®ä¾‹åŒ–å…¶å­ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractClassExample</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> y;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func1</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func2</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;func2&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractExtendClassExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractClassExample</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func1</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;func1&quot;</span>);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">// AbstractClassExample ac1 = new AbstractClassExample(); // &#x27;AbstractClassExample&#x27; is abstract; cannot be instantiated</span><br>AbstractClassExample ac2 = <span class="hljs-keyword">new</span> AbstractExtendClassExample();<br>ac2.func1();<br><br></code></pre></td></tr></table></figure><p><strong>2. æ¥å£</strong></p><p>æ¥å£æ˜¯æŠ½è±¡ç±»çš„å»¶ä¼¸ï¼Œåœ¨ Java 8 ä¹‹å‰ï¼Œå®ƒå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªå®Œå…¨æŠ½è±¡çš„ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸èƒ½æœ‰ä»»ä½•çš„æ–¹æ³•å®ç°ã€‚</p><p>ä» Java 8 å¼€å§‹ï¼Œæ¥å£ä¹Ÿå¯ä»¥æ‹¥æœ‰é»˜è®¤çš„æ–¹æ³•å®ç°ï¼Œè¿™æ˜¯å› ä¸ºä¸æ”¯æŒé»˜è®¤æ–¹æ³•çš„æ¥å£çš„ç»´æŠ¤æˆæœ¬å¤ªé«˜äº†ã€‚åœ¨ Java 8 ä¹‹å‰ï¼Œå¦‚æœä¸€ä¸ªæ¥å£æƒ³è¦æ·»åŠ æ–°çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¦ä¿®æ”¹æ‰€æœ‰å®ç°äº†è¯¥æ¥å£çš„ç±»ã€‚</p><p>æ¥å£çš„æˆå‘˜(å­—æ®µ + æ–¹æ³•)é»˜è®¤éƒ½æ˜¯ public çš„ï¼Œå¹¶ä¸”ä¸å…è®¸å®šä¹‰ä¸º private æˆ–è€… protectedã€‚</p><p>æ¥å£çš„å­—æ®µé»˜è®¤éƒ½æ˜¯ static å’Œ final çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">InterfaceExample</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func1</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func2</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;func2&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">int</span> x = <span class="hljs-number">123</span>;<br>    <span class="hljs-comment">// int y;               // Variable &#x27;y&#x27; might not have been initialized</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> z = <span class="hljs-number">0</span>;       <span class="hljs-comment">// Modifier &#x27;public&#x27; is redundant for interface fields</span><br>    <span class="hljs-comment">// private int k = 0;   // Modifier &#x27;private&#x27; not allowed here</span><br>    <span class="hljs-comment">// protected int l = 0; // Modifier &#x27;protected&#x27; not allowed here</span><br>    <span class="hljs-comment">// private void fun3(); // Modifier &#x27;private&#x27; not allowed here</span><br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>3. æ¯”è¾ƒ</strong></p><ul><li>ä»è®¾è®¡å±‚é¢ä¸Šçœ‹ï¼ŒæŠ½è±¡ç±»æä¾›äº†ä¸€ç§ IS-A å…³ç³»ï¼Œé‚£ä¹ˆå°±å¿…é¡»æ»¡è¶³é‡Œå¼æ›¿æ¢åŸåˆ™ï¼Œå³å­ç±»å¯¹è±¡å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰æ‰€æœ‰çˆ¶ç±»å¯¹è±¡ã€‚è€Œæ¥å£æ›´åƒæ˜¯ä¸€ç§ LIKE-A å…³ç³»ï¼Œå®ƒåªæ˜¯æä¾›ä¸€ç§æ–¹æ³•å®ç°å¥‘çº¦ï¼Œå¹¶ä¸è¦æ±‚æ¥å£å’Œå®ç°æ¥å£çš„ç±»å…·æœ‰ IS-A å…³ç³»ã€‚</li><li>ä»ä½¿ç”¨ä¸Šæ¥çœ‹ï¼Œä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä½†æ˜¯ä¸èƒ½ç»§æ‰¿å¤šä¸ªæŠ½è±¡ç±»ã€‚</li><li>æ¥å£çš„å­—æ®µåªèƒ½æ˜¯ static å’Œ final ç±»å‹çš„ï¼Œè€ŒæŠ½è±¡ç±»çš„å­—æ®µæ²¡æœ‰è¿™ç§é™åˆ¶ã€‚</li><li>æ¥å£çš„æˆå‘˜åªèƒ½æ˜¯ public çš„ï¼Œè€ŒæŠ½è±¡ç±»çš„æˆå‘˜å¯ä»¥æœ‰å¤šç§è®¿é—®æƒé™ã€‚</li></ul><p><strong>4. ä½¿ç”¨é€‰æ‹©</strong></p><p>ä½¿ç”¨æ¥å£:</p><ul><li>éœ€è¦è®©ä¸ç›¸å…³çš„ç±»éƒ½å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ä¸ç›¸å…³çš„ç±»éƒ½å¯ä»¥å®ç° Compareable æ¥å£ä¸­çš„ compareTo() æ–¹æ³•ï¼›</li><li>éœ€è¦ä½¿ç”¨å¤šé‡ç»§æ‰¿ã€‚</li></ul><p> ä½¿ç”¨æŠ½è±¡ç±»:</p><ul><li>éœ€è¦åœ¨å‡ ä¸ªç›¸å…³çš„ç±»ä¸­å…±äº«ä»£ç ã€‚</li><li>éœ€è¦èƒ½æ§åˆ¶ç»§æ‰¿æ¥çš„æˆå‘˜çš„è®¿é—®æƒé™ï¼Œè€Œä¸æ˜¯éƒ½ä¸º publicã€‚</li><li>éœ€è¦ç»§æ‰¿éé™æ€å’Œéå¸¸é‡å­—æ®µã€‚</li></ul><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ¥å£ä¼˜å…ˆäºæŠ½è±¡ç±»ï¼Œå› ä¸ºæ¥å£æ²¡æœ‰æŠ½è±¡ç±»ä¸¥æ ¼çš„ç±»å±‚æ¬¡ç»“æ„è¦æ±‚ï¼Œå¯ä»¥çµæ´»åœ°ä¸ºä¸€ä¸ªç±»æ·»åŠ è¡Œä¸ºã€‚å¹¶ä¸”ä» Java 8 å¼€å§‹ï¼Œæ¥å£ä¹Ÿå¯ä»¥æœ‰é»˜è®¤çš„æ–¹æ³•å®ç°ï¼Œä½¿å¾—ä¿®æ”¹æ¥å£çš„æˆæœ¬ä¹Ÿå˜çš„å¾ˆä½ã€‚</p><h3 id="super"><a href="#super" class="headerlink" title="super"></a>super</h3><ul><li>è®¿é—®çˆ¶ç±»çš„æ„é€ å‡½æ•°: å¯ä»¥ä½¿ç”¨ super() å‡½æ•°è®¿é—®çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä»è€Œå§”æ‰˜çˆ¶ç±»å®Œæˆä¸€äº›åˆå§‹åŒ–çš„å·¥ä½œã€‚</li><li>è®¿é—®çˆ¶ç±»çš„æˆå‘˜: å¦‚æœå­ç±»é‡å†™äº†çˆ¶ç±»çš„ä¸­æŸä¸ªæ–¹æ³•çš„å®ç°ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ super å…³é”®å­—æ¥å¼•ç”¨çˆ¶ç±»çš„æ–¹æ³•å®ç°ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SuperExample</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> y;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SuperExample</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.x = x;<br>        <span class="hljs-keyword">this</span>.y = y;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;SuperExample.func()&quot;</span>);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SuperExtendExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SuperExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> z;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SuperExtendExample</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(x, y);<br>        <span class="hljs-keyword">this</span>.z = z;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.func();<br>        System.out.println(<span class="hljs-string">&quot;SuperExtendExample.func()&quot;</span>);<br>    &#125;<br>&#125;<br><br><br><br>SuperExample e = <span class="hljs-keyword">new</span> SuperExtendExample(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);<br>e.func();<br><br></code></pre></td></tr></table></figure><h3 id="é‡å†™ä¸é‡è½½"><a href="#é‡å†™ä¸é‡è½½" class="headerlink" title="é‡å†™ä¸é‡è½½"></a>é‡å†™ä¸é‡è½½</h3><p><strong>1. é‡å†™(Override)</strong></p><p>å­˜åœ¨äºç»§æ‰¿ä½“ç³»ä¸­ï¼ŒæŒ‡å­ç±»å®ç°äº†ä¸€ä¸ªä¸çˆ¶ç±»åœ¨æ–¹æ³•å£°æ˜ä¸Šå®Œå…¨ç›¸åŒçš„ä¸€ä¸ªæ–¹æ³•ã€‚</p><p>ä¸ºäº†æ»¡è¶³é‡Œå¼æ›¿æ¢åŸåˆ™ï¼Œé‡å†™æœ‰æœ‰ä»¥ä¸‹ä¸¤ä¸ªé™åˆ¶:</p><ul><li>å­ç±»æ–¹æ³•çš„è®¿é—®æƒé™å¿…é¡»å¤§äºç­‰äºçˆ¶ç±»æ–¹æ³•ï¼›</li><li>å­ç±»æ–¹æ³•çš„è¿”å›ç±»å‹å¿…é¡»æ˜¯çˆ¶ç±»æ–¹æ³•è¿”å›ç±»å‹æˆ–ä¸ºå…¶å­ç±»å‹ã€‚</li></ul><p>ä½¿ç”¨ @Override æ³¨è§£ï¼Œå¯ä»¥è®©ç¼–è¯‘å™¨å¸®å¿™æ£€æŸ¥æ˜¯å¦æ»¡è¶³ä¸Šé¢çš„ä¸¤ä¸ªé™åˆ¶æ¡ä»¶ã€‚</p><p><strong>2. é‡è½½(Overload)</strong></p><p>å­˜åœ¨äºåŒä¸€ä¸ªç±»ä¸­ï¼ŒæŒ‡ä¸€ä¸ªæ–¹æ³•ä¸å·²ç»å­˜åœ¨çš„æ–¹æ³•åç§°ä¸Šç›¸åŒï¼Œä½†æ˜¯å‚æ•°ç±»å‹ã€ä¸ªæ•°ã€é¡ºåºè‡³å°‘æœ‰ä¸€ä¸ªä¸åŒã€‚</p><p>åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œè¿”å›å€¼ä¸åŒï¼Œå…¶å®ƒéƒ½ç›¸åŒä¸ç®—æ˜¯é‡è½½ã€‚</p><h2 id="Object-é€šç”¨æ–¹æ³•"><a href="#Object-é€šç”¨æ–¹æ³•" class="headerlink" title="Object é€šç”¨æ–¹æ³•"></a>Object é€šç”¨æ–¹æ³•</h2><h3 id="æ¦‚è§ˆ-1"><a href="#æ¦‚è§ˆ-1" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> Class&lt;?&gt; getClass()<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(Object obj)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">native</span> Object <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title">notify</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title">notifyAll</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title">wait</span><span class="hljs-params">(<span class="hljs-keyword">long</span> timeout)</span> <span class="hljs-keyword">throws</span> InterruptedException</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">wait</span><span class="hljs-params">(<span class="hljs-keyword">long</span> timeout, <span class="hljs-keyword">int</span> nanos)</span> <span class="hljs-keyword">throws</span> InterruptedException</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">wait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">finalize</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;&#125;<br></code></pre></td></tr></table></figure><h3 id="equals"><a href="#equals" class="headerlink" title="equals()"></a>equals()</h3><p><strong>1. ç­‰ä»·å…³ç³»</strong></p><p>(ä¸€)è‡ªåæ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">x.equals(x); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>(äºŒ)å¯¹ç§°æ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">x.equals(y) == y.equals(x); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>(ä¸‰)ä¼ é€’æ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (x.equals(y) &amp;&amp; y.equals(z))<br>    x.equals(z); <span class="hljs-comment">// true;</span><br></code></pre></td></tr></table></figure><p>(å››)ä¸€è‡´æ€§</p><p>å¤šæ¬¡è°ƒç”¨ equals() æ–¹æ³•ç»“æœä¸å˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">x.equals(y) == x.equals(y); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>(äº”)ä¸ null çš„æ¯”è¾ƒ</p><p>å¯¹ä»»ä½•ä¸æ˜¯ null çš„å¯¹è±¡ x è°ƒç”¨ x.equals(null) ç»“æœéƒ½ä¸º false</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">x.equals(<span class="hljs-keyword">null</span>); <span class="hljs-comment">// false;</span><br></code></pre></td></tr></table></figure><p><strong>2. equals() ä¸ ==</strong></p><ul><li>å¯¹äºåŸºæœ¬ç±»å‹ï¼Œ== åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼ŒåŸºæœ¬ç±»å‹æ²¡æœ‰ equals() æ–¹æ³•ã€‚</li><li>å¯¹äºå¼•ç”¨ç±»å‹ï¼Œ== åˆ¤æ–­ä¸¤ä¸ªå˜é‡æ˜¯å¦å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ï¼Œè€Œ equals() åˆ¤æ–­å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦ç­‰ä»·ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Integer x = <span class="hljs-keyword">new</span> Integer(<span class="hljs-number">1</span>);<br>Integer y = <span class="hljs-keyword">new</span> Integer(<span class="hljs-number">1</span>);<br>System.out.println(x.equals(y)); <span class="hljs-comment">// true</span><br>System.out.println(x == y);      <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><p><strong>3. å®ç°</strong></p><ul><li>æ£€æŸ¥æ˜¯å¦ä¸ºåŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œå¦‚æœæ˜¯ç›´æ¥è¿”å› trueï¼›</li><li>æ£€æŸ¥æ˜¯å¦æ˜¯åŒä¸€ä¸ªç±»å‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œç›´æ¥è¿”å› falseï¼›</li><li>å°† Object å¯¹è±¡è¿›è¡Œè½¬å‹ï¼›</li><li>åˆ¤æ–­æ¯ä¸ªå…³é”®åŸŸæ˜¯å¦ç›¸ç­‰ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EqualExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> y;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> z;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EqualExample</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.x = x;<br>        <span class="hljs-keyword">this</span>.y = y;<br>        <span class="hljs-keyword">this</span>.z = z;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(Object o)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> == o) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">if</span> (o == <span class="hljs-keyword">null</span> || getClass() != o.getClass()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br><br>        EqualExample that = (EqualExample) o;<br><br>        <span class="hljs-keyword">if</span> (x != that.x) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">if</span> (y != that.y) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">return</span> z == that.z;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="hashCode"><a href="#hashCode" class="headerlink" title="hashCode()"></a>hashCode()</h3><p>hashCode() è¿”å›æ•£åˆ—å€¼ï¼Œè€Œ equals() æ˜¯ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç­‰ä»·ã€‚ç­‰ä»·çš„ä¸¤ä¸ªå¯¹è±¡æ•£åˆ—å€¼ä¸€å®šç›¸åŒï¼Œä½†æ˜¯æ•£åˆ—å€¼ç›¸åŒçš„ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç­‰ä»·ã€‚</p><p>åœ¨è¦†ç›– equals() æ–¹æ³•æ—¶åº”å½“æ€»æ˜¯è¦†ç›– hashCode() æ–¹æ³•ï¼Œä¿è¯ç­‰ä»·çš„ä¸¤ä¸ªå¯¹è±¡æ•£åˆ—å€¼ä¹Ÿç›¸ç­‰ã€‚</p><p>ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæ–°å»ºäº†ä¸¤ä¸ªç­‰ä»·çš„å¯¹è±¡ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ° HashSet ä¸­ã€‚æˆ‘ä»¬å¸Œæœ›å°†è¿™ä¸¤ä¸ªå¯¹è±¡å½“æˆä¸€æ ·çš„ï¼Œåªåœ¨é›†åˆä¸­æ·»åŠ ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å› ä¸º EqualExample æ²¡æœ‰å®ç° hasCode() æ–¹æ³•ï¼Œå› æ­¤è¿™ä¸¤ä¸ªå¯¹è±¡çš„æ•£åˆ—å€¼æ˜¯ä¸åŒçš„ï¼Œæœ€ç»ˆå¯¼è‡´é›†åˆæ·»åŠ äº†ä¸¤ä¸ªç­‰ä»·çš„å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">EqualExample e1 = <span class="hljs-keyword">new</span> EqualExample(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<br>EqualExample e2 = <span class="hljs-keyword">new</span> EqualExample(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<br>System.out.println(e1.equals(e2)); <span class="hljs-comment">// true</span><br>HashSet&lt;EqualExample&gt; set = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();<br>set.add(e1);<br>set.add(e2);<br>System.out.println(set.size());   <span class="hljs-comment">// 2</span><br></code></pre></td></tr></table></figure><p>ç†æƒ³çš„æ•£åˆ—å‡½æ•°åº”å½“å…·æœ‰å‡åŒ€æ€§ï¼Œå³ä¸ç›¸ç­‰çš„å¯¹è±¡åº”å½“å‡åŒ€åˆ†å¸ƒåˆ°æ‰€æœ‰å¯èƒ½çš„æ•£åˆ—å€¼ä¸Šã€‚è¿™å°±è¦æ±‚äº†æ•£åˆ—å‡½æ•°è¦æŠŠæ‰€æœ‰åŸŸçš„å€¼éƒ½è€ƒè™‘è¿›æ¥ï¼Œå¯ä»¥å°†æ¯ä¸ªåŸŸéƒ½å½“æˆ R è¿›åˆ¶çš„æŸä¸€ä½ï¼Œç„¶åç»„æˆä¸€ä¸ª R è¿›åˆ¶çš„æ•´æ•°ã€‚R ä¸€èˆ¬å– 31ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¥‡ç´ æ•°ï¼Œå¦‚æœæ˜¯å¶æ•°çš„è¯ï¼Œå½“å‡ºç°ä¹˜æ³•æº¢å‡ºï¼Œä¿¡æ¯å°±ä¼šä¸¢å¤±ï¼Œå› ä¸ºä¸ 2 ç›¸ä¹˜ç›¸å½“äºå‘å·¦ç§»ä¸€ä½ã€‚</p><p>ä¸€ä¸ªæ•°ä¸ 31 ç›¸ä¹˜å¯ä»¥è½¬æ¢æˆç§»ä½å’Œå‡æ³•: <code>31*x == (x&lt;&lt;5)-x</code>ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œè¿™ä¸ªä¼˜åŒ–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> result = <span class="hljs-number">17</span>;<br>    result = <span class="hljs-number">31</span> * result + x;<br>    result = <span class="hljs-number">31</span> * result + y;<br>    result = <span class="hljs-number">31</span> * result + z;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString()"></a>toString()</h3><p>é»˜è®¤è¿”å› ToStringExample@4554617c è¿™ç§å½¢å¼ï¼Œå…¶ä¸­ @ åé¢çš„æ•°å€¼ä¸ºæ•£åˆ—ç çš„æ— ç¬¦å·åå…­è¿›åˆ¶è¡¨ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ToStringExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> number;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ToStringExample</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.number = number;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">ToStringExample example = <span class="hljs-keyword">new</span> ToStringExample(<span class="hljs-number">123</span>);<br>System.out.println(example.toString());<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">ToStringExample@4554617c<br></code></pre></td></tr></table></figure><h3 id="clone"><a href="#clone" class="headerlink" title="clone()"></a>clone()</h3><p><strong>1. cloneable</strong></p><p>clone() æ˜¯ Object çš„ protected æ–¹æ³•ï¼Œå®ƒä¸æ˜¯ publicï¼Œä¸€ä¸ªç±»ä¸æ˜¾å¼å»é‡å†™ clone()ï¼Œå…¶å®ƒç±»å°±ä¸èƒ½ç›´æ¥å»è°ƒç”¨è¯¥ç±»å®ä¾‹çš„ clone() æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CloneExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> a;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> b;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">CloneExample e1 = <span class="hljs-keyword">new</span> CloneExample();<br><span class="hljs-comment">// CloneExample e2 = e1.clone(); // &#x27;clone()&#x27; has protected access in &#x27;java.lang.Object&#x27;</span><br></code></pre></td></tr></table></figure><p>é‡å†™ clone() å¾—åˆ°ä»¥ä¸‹å®ç°:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CloneExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> a;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> b;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> CloneExample <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException </span>&#123;<br>        <span class="hljs-keyword">return</span> (CloneExample)<span class="hljs-keyword">super</span>.clone();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">CloneExample e1 = <span class="hljs-keyword">new</span> CloneExample();<br><span class="hljs-keyword">try</span> &#123;<br>    CloneExample e2 = e1.clone();<br>&#125; <span class="hljs-keyword">catch</span> (CloneNotSupportedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java.lang.CloneNotSupportedException: CloneExample<br></code></pre></td></tr></table></figure><p>åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œclone() æ–¹æ³•å¹¶ä¸æ˜¯ Cloneable æ¥å£çš„æ–¹æ³•ï¼Œè€Œæ˜¯ Object çš„ä¸€ä¸ª protected æ–¹æ³•ã€‚Cloneable æ¥å£åªæ˜¯è§„å®šï¼Œå¦‚æœä¸€ä¸ªç±»æ²¡æœ‰å®ç° Cloneable æ¥å£åˆè°ƒç”¨äº† clone() æ–¹æ³•ï¼Œå°±ä¼šæŠ›å‡º CloneNotSupportedExceptionã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CloneExample</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Cloneable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> a;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> b;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> Object <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.clone();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>2. æµ…æ‹·è´</strong></p><p>æ‹·è´å¯¹è±¡å’ŒåŸå§‹å¯¹è±¡çš„å¼•ç”¨ç±»å‹å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShallowCloneExample</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Cloneable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] arr;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ShallowCloneExample</span><span class="hljs-params">()</span> </span>&#123;<br>        arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">10</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>            arr[i] = i;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">set</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, <span class="hljs-keyword">int</span> value)</span> </span>&#123;<br>        arr[index] = value;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> arr[index];<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> ShallowCloneExample <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException </span>&#123;<br>        <span class="hljs-keyword">return</span> (ShallowCloneExample) <span class="hljs-keyword">super</span>.clone();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">ShallowCloneExample e1 = <span class="hljs-keyword">new</span> ShallowCloneExample();<br>ShallowCloneExample e2 = <span class="hljs-keyword">null</span>;<br><span class="hljs-keyword">try</span> &#123;<br>    e2 = e1.clone();<br>&#125; <span class="hljs-keyword">catch</span> (CloneNotSupportedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br>e1.set(<span class="hljs-number">2</span>, <span class="hljs-number">222</span>);<br>System.out.println(e2.get(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 222</span><br><br></code></pre></td></tr></table></figure><p><strong>3. æ·±æ‹·è´</strong></p><p>æ‹·è´å¯¹è±¡å’ŒåŸå§‹å¯¹è±¡çš„å¼•ç”¨ç±»å‹å¼•ç”¨ä¸åŒå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeepCloneExample</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Cloneable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] arr;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DeepCloneExample</span><span class="hljs-params">()</span> </span>&#123;<br>        arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">10</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>            arr[i] = i;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">set</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, <span class="hljs-keyword">int</span> value)</span> </span>&#123;<br>        arr[index] = value;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> arr[index];<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> DeepCloneExample <span class="hljs-title">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException </span>&#123;<br>        DeepCloneExample result = (DeepCloneExample) <span class="hljs-keyword">super</span>.clone();<br>        result.arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[arr.length];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>            result.arr[i] = arr[i];<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">DeepCloneExample e1 = <span class="hljs-keyword">new</span> DeepCloneExample();<br>DeepCloneExample e2 = <span class="hljs-keyword">null</span>;<br><span class="hljs-keyword">try</span> &#123;<br>    e2 = e1.clone();<br>&#125; <span class="hljs-keyword">catch</span> (CloneNotSupportedException e) &#123;<br>    e.printStackTrace();<br>&#125;<br>e1.set(<span class="hljs-number">2</span>, <span class="hljs-number">222</span>);<br>System.out.println(e2.get(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 2</span><br><br></code></pre></td></tr></table></figure><p><strong>4. clone() çš„æ›¿ä»£æ–¹æ¡ˆ</strong></p><p>ä½¿ç”¨ clone() æ–¹æ³•æ¥æ‹·è´ä¸€ä¸ªå¯¹è±¡å³å¤æ‚åˆæœ‰é£é™©ï¼Œå®ƒä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¹¶ä¸”è¿˜éœ€è¦ç±»å‹è½¬æ¢ã€‚Effective Java ä¹¦ä¸Šè®²åˆ°ï¼Œæœ€å¥½ä¸è¦å»ä½¿ç”¨ clone()ï¼Œå¯ä»¥ä½¿ç”¨æ‹·è´æ„é€ å‡½æ•°æˆ–è€…æ‹·è´å·¥å‚æ¥æ‹·è´ä¸€ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CloneConstructorExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] arr;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CloneConstructorExample</span><span class="hljs-params">()</span> </span>&#123;<br>        arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">10</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>            arr[i] = i;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CloneConstructorExample</span><span class="hljs-params">(CloneConstructorExample original)</span> </span>&#123;<br>        arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[original.arr.length];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; original.arr.length; i++) &#123;<br>            arr[i] = original.arr[i];<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">set</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, <span class="hljs-keyword">int</span> value)</span> </span>&#123;<br>        arr[index] = value;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> arr[index];<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">CloneConstructorExample e1 = <span class="hljs-keyword">new</span> CloneConstructorExample();<br>CloneConstructorExample e2 = <span class="hljs-keyword">new</span> CloneConstructorExample(e1);<br>e1.set(<span class="hljs-number">2</span>, <span class="hljs-number">222</span>);<br>System.out.println(e2.get(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 2</span><br><br></code></pre></td></tr></table></figure><h2 id="å…³é”®å­—"><a href="#å…³é”®å­—" class="headerlink" title="å…³é”®å­—"></a>å…³é”®å­—</h2><h3 id="final"><a href="#final" class="headerlink" title="final"></a>final</h3><p><strong>1. æ•°æ®</strong></p><p>å£°æ˜æ•°æ®ä¸ºå¸¸é‡ï¼Œå¯ä»¥æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨è¿è¡Œæ—¶è¢«åˆå§‹åŒ–åä¸èƒ½è¢«æ”¹å˜çš„å¸¸é‡ã€‚</p><ul><li>å¯¹äºåŸºæœ¬ç±»å‹ï¼Œfinal ä½¿æ•°å€¼ä¸å˜ï¼›</li><li>å¯¹äºå¼•ç”¨ç±»å‹ï¼Œfinal ä½¿å¼•ç”¨ä¸å˜ï¼Œä¹Ÿå°±ä¸èƒ½å¼•ç”¨å…¶å®ƒå¯¹è±¡ï¼Œä½†æ˜¯è¢«å¼•ç”¨çš„å¯¹è±¡æœ¬èº«æ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> x = <span class="hljs-number">1</span>;<br><span class="hljs-comment">// x = 2;  // cannot assign value to final variable &#x27;x&#x27;</span><br><span class="hljs-keyword">final</span> A y = <span class="hljs-keyword">new</span> A();<br>y.a = <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><p><strong>2. æ–¹æ³•</strong></p><p>å£°æ˜æ–¹æ³•ä¸èƒ½è¢«å­ç±»é‡å†™ã€‚</p><p>private æ–¹æ³•éšå¼åœ°è¢«æŒ‡å®šä¸º finalï¼Œå¦‚æœåœ¨å­ç±»ä¸­å®šä¹‰çš„æ–¹æ³•å’ŒåŸºç±»ä¸­çš„ä¸€ä¸ª private æ–¹æ³•ç­¾åç›¸åŒï¼Œæ­¤æ—¶å­ç±»çš„æ–¹æ³•ä¸æ˜¯é‡å†™åŸºç±»æ–¹æ³•ï¼Œè€Œæ˜¯åœ¨å­ç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•ã€‚</p><p><strong>3. ç±»</strong></p><p>å£°æ˜ç±»ä¸å…è®¸è¢«ç»§æ‰¿ã€‚</p><h3 id="static"><a href="#static" class="headerlink" title="static"></a>static</h3><p><strong>1. é™æ€å˜é‡</strong></p><p>é™æ€å˜é‡: åˆç§°ä¸ºç±»å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå˜é‡å±äºç±»çš„ï¼Œç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å…±äº«é™æ€å˜é‡ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åæ¥è®¿é—®å®ƒï¼›é™æ€å˜é‡åœ¨å†…å­˜ä¸­åªå­˜åœ¨ä¸€ä»½ã€‚</p><p>å®ä¾‹å˜é‡: æ¯åˆ›å»ºä¸€ä¸ªå®ä¾‹å°±ä¼šäº§ç”Ÿä¸€ä¸ªå®ä¾‹å˜é‡ï¼Œå®ƒä¸è¯¥å®ä¾‹åŒç”Ÿå…±æ­»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> x;         <span class="hljs-comment">// å®ä¾‹å˜é‡</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> y;  <span class="hljs-comment">// é™æ€å˜é‡</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// int x = A.x;  // Non-static field &#x27;x&#x27; cannot be referenced from a static context</span><br>        A a = <span class="hljs-keyword">new</span> A();<br>        <span class="hljs-keyword">int</span> x = a.x;<br>        <span class="hljs-keyword">int</span> y = A.y;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>2. é™æ€æ–¹æ³•</strong></p><p>é™æ€æ–¹æ³•åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±å­˜åœ¨äº†ï¼Œå®ƒä¸ä¾èµ–äºä»»ä½•å®ä¾‹ã€‚æ‰€ä»¥é™æ€æ–¹æ³•å¿…é¡»æœ‰å®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸èƒ½æ˜¯æŠ½è±¡æ–¹æ³•(abstract)ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func1</span><span class="hljs-params">()</span></span>&#123;<br>    &#125;<br>    <span class="hljs-comment">// public abstract static void func2();  // Illegal combination of modifiers: &#x27;abstract&#x27; and &#x27;static&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åªèƒ½è®¿é—®æ‰€å±ç±»çš„é™æ€å­—æ®µå’Œé™æ€æ–¹æ³•ï¼Œæ–¹æ³•ä¸­ä¸èƒ½æœ‰ this å’Œ super å…³é”®å­—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> y;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func1</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">int</span> a = x;<br>        <span class="hljs-comment">// int b = y;  // Non-static field &#x27;y&#x27; cannot be referenced from a static context</span><br>        <span class="hljs-comment">// int b = this.y;     // &#x27;A.this&#x27; cannot be referenced from a static context</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>3. é™æ€è¯­å¥å—</strong></p><p>é™æ€è¯­å¥å—åœ¨ç±»åˆå§‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;123&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        A a1 = <span class="hljs-keyword">new</span> A();<br>        A a2 = <span class="hljs-keyword">new</span> A();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><p><strong>4. é™æ€å†…éƒ¨ç±»</strong></p><p>éé™æ€å†…éƒ¨ç±»ä¾èµ–äºå¤–éƒ¨ç±»çš„å®ä¾‹ï¼Œè€Œé™æ€å†…éƒ¨ç±»ä¸éœ€è¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OuterClass</span> </span>&#123;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InnerClass</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StaticInnerClass</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// InnerClass innerClass = new InnerClass(); // &#x27;OuterClass.this&#x27; cannot be referenced from a static context</span><br>        OuterClass outerClass = <span class="hljs-keyword">new</span> OuterClass();<br>        InnerClass innerClass = outerClass.<span class="hljs-function">new <span class="hljs-title">InnerClass</span><span class="hljs-params">()</span></span>;<br>        StaticInnerClass staticInnerClass = <span class="hljs-keyword">new</span> StaticInnerClass();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é™æ€å†…éƒ¨ç±»ä¸èƒ½è®¿é—®å¤–éƒ¨ç±»çš„éé™æ€çš„å˜é‡å’Œæ–¹æ³•ã€‚</p><p><strong>5. é™æ€å¯¼åŒ…</strong></p><p>åœ¨ä½¿ç”¨é™æ€å˜é‡å’Œæ–¹æ³•æ—¶ä¸ç”¨å†æŒ‡æ˜ ClassNameï¼Œä»è€Œç®€åŒ–ä»£ç ï¼Œä½†å¯è¯»æ€§å¤§å¤§é™ä½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> com.xxx.ClassName.*<br></code></pre></td></tr></table></figure><p><strong>6. åˆå§‹åŒ–é¡ºåº</strong></p><p>é™æ€å˜é‡å’Œé™æ€è¯­å¥å—ä¼˜å…ˆäºå®ä¾‹å˜é‡å’Œæ™®é€šè¯­å¥å—ï¼Œé™æ€å˜é‡å’Œé™æ€è¯­å¥å—çš„åˆå§‹åŒ–é¡ºåºå–å†³äºå®ƒä»¬åœ¨ä»£ç ä¸­çš„é¡ºåºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String staticField = <span class="hljs-string">&quot;é™æ€å˜é‡&quot;</span>;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;é™æ€è¯­å¥å—&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String field = <span class="hljs-string">&quot;å®ä¾‹å˜é‡&quot;</span>;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;<br>    System.out.println(<span class="hljs-string">&quot;æ™®é€šè¯­å¥å—&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€åæ‰æ˜¯æ„é€ å‡½æ•°çš„åˆå§‹åŒ–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">InitialOrderTest</span><span class="hljs-params">()</span> </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;æ„é€ å‡½æ•°&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å­˜åœ¨ç»§æ‰¿çš„æƒ…å†µä¸‹ï¼Œåˆå§‹åŒ–é¡ºåºä¸º:</p><ul><li>çˆ¶ç±»(é™æ€å˜é‡ã€é™æ€è¯­å¥å—)</li><li>å­ç±»(é™æ€å˜é‡ã€é™æ€è¯­å¥å—)</li><li>çˆ¶ç±»(å®ä¾‹å˜é‡ã€æ™®é€šè¯­å¥å—)</li><li>çˆ¶ç±»(æ„é€ å‡½æ•°)</li><li>å­ç±»(å®ä¾‹å˜é‡ã€æ™®é€šè¯­å¥å—)</li><li>å­ç±»(æ„é€ å‡½æ•°)</li></ul><p>å¼•ç”¨è‡ª:</p><hr><p><a href="https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/basis/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.md">https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/basis/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.md</a></p><p><a href="https://www.pdai.tech/md/java/basic/java-basic-lan-basic.html">https://www.pdai.tech/md/java/basic/java-basic-lan-basic.html</a></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaåŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaåŸºç¡€-é¢å‘å¯¹è±¡</title>
    <link href="/2021/10/12/Java%E5%9F%BA%E7%A1%80/"/>
    <url>/2021/10/12/Java%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸‰å¤§ç‰¹æ€§"><a href="#ä¸‰å¤§ç‰¹æ€§" class="headerlink" title="ä¸‰å¤§ç‰¹æ€§"></a>ä¸‰å¤§ç‰¹æ€§</h2><h3 id="ä¸€ã€å°è£…"><a href="#ä¸€ã€å°è£…" class="headerlink" title="ä¸€ã€å°è£…"></a>ä¸€ã€å°è£…</h3><h4 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h4><p>ç±»çš„å°è£…ï¼Œæ˜¯æŒ‡å°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯éšè—åœ¨å¯¹è±¡å†…éƒ¨ï¼Œä¸å…è®¸å¤–éƒ¨ç¨‹åºç›´æ¥è®¿é—®å¯¹è±¡çš„å†…éƒ¨ä¿¡æ¯ï¼Œè€Œæ˜¯é€šè¿‡è¯¥ç±»æ‰€æä¾›çš„æ–¹æ³•æ¥å®ç°å¯¹å†…éƒ¨ä¿¡æ¯çš„æ“ä½œã€‚å³<strong>å°è£…å°±æ˜¯æŠŠåŒä¸€ç±»äº‹ç‰©çš„å…±æ€§ï¼ˆåŒ…æ‹¬å±æ€§å’Œæ–¹æ³•ï¼‰å½’åˆ°åŒä¸€ç±»ä¸­ï¼Œæ–¹ä¾¿ä½¿ç”¨ã€‚</strong>    </p><p>å°è£…å’Œç»§æ‰¿å‡ ä¹éƒ½æ˜¯ä¸ºå¤šæ€è€Œå‡†å¤‡çš„ã€‚ </p><p>å°è£…ä¹Ÿç§°ä¿¡æ¯éšè—ï¼Œæ˜¯æŒ‡åˆ©ç”¨æŠ½è±¡æ•°æ®ç±»å‹æŠŠæ•°æ®å’ŒåŸºäºæ•°æ®çš„æ“ä½œå°è£…èµ·æ¥ï¼Œä½¿å…¶æˆä¸ºä¸€ä¸ªä¸å¯åˆ†å‰²çš„æ•´ä½“ï¼Œæ•°æ®éšè—åœ¨æŠ½è±¡æ•°æ®å†…éƒ¨ï¼Œå°½å¯èƒ½çš„éšè—æ•°æ®ç»†èŠ‚ï¼Œåªä¿ç•™ä¸€äº›æ¥å£ä½¿å…¶ä¸å¤–ç•Œå‘ç”Ÿè”ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·æ— éœ€çŸ¥é“å†…éƒ¨çš„æ•°æ®å’Œæ–¹æ³•çš„å…·ä½“å®ç°ç»†èŠ‚ï¼Œåªéœ€æ ¹æ®ç•™åœ¨å¤–éƒ¨çš„æ¥å£è¿›è¡Œæ“ä½œå°±è¡Œã€‚ </p><h4 id="2-å°è£…çš„å®ç°"><a href="#2-å°è£…çš„å®ç°" class="headerlink" title="2. å°è£…çš„å®ç°"></a>2. <strong>å°è£…çš„å®ç°</strong></h4><ul><li> éœ€è¦ä¿®æ”¹å±æ€§çš„è®¿é—®æ§åˆ¶ç¬¦ï¼ˆä¿®æ”¹ä¸ºprivateï¼‰ï¼› </li><li> åˆ›å»ºgetter/setteræ–¹æ³•ï¼ˆç”¨äºå±æ€§çš„è¯»å†™ï¼‰ï¼› </li><li> åœ¨getter/setteræ–¹æ³•ä¸­åŠ å…¥å±æ€§æ§åˆ¶è¯­å¥ï¼ˆç”¨äºåˆ¤æ–­å±æ€§å€¼çš„åˆæ³•æ€§ï¼‰; </li></ul><p><strong>å±æ€§ (æˆå‘˜å˜é‡ ) éšå¯¹è±¡å­˜æ”¾åœ¨å †ä¸­</strong></p><p>ç›´æ¥é€šè¿‡å¯¹è±¡è°ƒç”¨å±æ€§ï¼Œä¿®æ”¹å±æ€§å€¼æ˜¯ä¸å®‰å…¨çš„ï¼Œé‚£<strong>æ€ä¹ˆåŠ</strong>ï¼Ÿ</p><p>å…·ä½“å®ç°è¿‡ç¨‹ï¼šåœ¨å®šä¹‰ä¸€ä¸ªç±»æ—¶ï¼Œå°†ç±»ä¸­çš„å±æ€§ç§æœ‰åŒ–ï¼Œå³ä½¿ç”¨privateå…³é”®å­—æ¥ä¿®é¥°ï¼Œç§æœ‰å±æ€§åªèƒ½åœ¨å®ƒæ‰€åœ¨ç±»ä¸­è¢«è®¿é—®ï¼Œå¦‚æœå¤–ç•Œæƒ³è¦è®¿é—®ç§æœ‰å±æ€§ï¼Œéœ€è¦æä¾›ä¸€äº›ä½¿ç”¨publicä¿®é¥°çš„å…±æœ‰æ–¹æ³•ï¼Œå…¶ä¸­åŒ…æ‹¬ç”¨äºè·å–å±æ€§å€¼çš„getXxx()æ–¹æ³•å’Œè®¾ç½®å±æ€§å€¼çš„setXxx()æ–¹æ³•ã€‚</p><p>Booleançš„getæ–¹æ³•é»˜è®¤åä¸ºisXXXï¼ˆï¼‰</p><p>æŠŠæˆå‘˜å˜é‡è®¾ç½®ä¸ºç§æœ‰çš„ï¼Œåªèƒ½åœ¨æœ¬ç±»ä¸­ä½¿ç”¨ï¼Œæ‰€ä»¥å±æ€§ä¹Ÿå«<strong>å…¨å±€å˜é‡</strong>ã€‚</p><h4 id="3-å°è£…çš„ä¼˜ç¼ºç‚¹"><a href="#3-å°è£…çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="3.å°è£…çš„ä¼˜ç¼ºç‚¹"></a>3.å°è£…çš„ä¼˜ç¼ºç‚¹</h4><blockquote><p>ä¼˜ç‚¹</p></blockquote><ul><li> å°†å˜åŒ–éš”ç¦» </li><li> ä¾¿äºä½¿ç”¨ </li><li> æé«˜é‡ç”¨æ€§ </li><li> æé«˜å®‰å…¨æ€§ </li></ul><blockquote><p>ç¼ºç‚¹</p></blockquote><p> å°†å˜é‡ç­‰ä½¿ç”¨privateä¿®é¥°ï¼Œæˆ–è€…å°è£…è¿›æ–¹æ³•å†…ï¼Œä½¿å…¶ä¸èƒ½ç›´æ¥è¢«è®¿é—®ï¼Œå¢åŠ äº†è®¿é—®æ­¥éª¤ä¸éš¾åº¦ï¼ </p><p><strong>å®ä¾‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">People</span> </span>&#123;<br> <br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment"> </span><br><span class="hljs-comment">     * å¯¹å±æ€§çš„å°è£…ä¸€ä¸ªäººçš„å§“åã€å¹´é¾„</span><br><span class="hljs-comment"> </span><br><span class="hljs-comment">     */</span><br> <br>    <span class="hljs-keyword">private</span> String name;<br> <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment"> </span><br><span class="hljs-comment">     * setter()ã€getter()æ˜¯è¯¥å¯¹è±¡å¯¹å¤–å¼€å‘çš„æ¥å£</span><br><span class="hljs-comment"> </span><br><span class="hljs-comment">     */</span><br> <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br> <br>        <span class="hljs-keyword">return</span> name;<br> <br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br> <br>        <span class="hljs-keyword">this</span>.name = name;<br> <br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>&#123;<br> <br>        <span class="hljs-keyword">return</span> age;<br> <br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> age)</span> </span>&#123;<br> <br>        <span class="hljs-keyword">this</span>.age = age;<br> <br>    &#125;<br> <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="äºŒã€ç»§æ‰¿"><a href="#äºŒã€ç»§æ‰¿" class="headerlink" title="äºŒã€ç»§æ‰¿"></a>äºŒã€ç»§æ‰¿</h3><p> ç»§æ‰¿å…³é”®å­—ï¼š<code>extends</code> </p><h4 id="1-æ¦‚è¿°-1"><a href="#1-æ¦‚è¿°-1" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h4><p>åœ¨Javaä¸­ï¼Œç±»çš„ç»§æ‰¿æ˜¯æŒ‡åœ¨ä¸€ä¸ªç°æœ‰ç±»çš„åŸºç¡€ä¸Šå»æ„å»ºä¸€ä¸ªæ–°çš„ç±»ï¼Œæ„å»ºå‡ºæ¥çš„æ–°ç±»ç§°ä½œå­ç±»ï¼Œç°æœ‰ç±»è¢«ç§°ä½œçˆ¶ç±»æˆ–åŸºç±»ï¼Œå­ç±»ä¼šè‡ªåŠ¨æ‹¥æœ‰çˆ¶ç±»æ‰€æœ‰å¯ç»§æ‰¿çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><p><strong>ç®€å•çš„è¯´</strong>:  ç»§æ‰¿æ˜¯ç±»ä¸ç±»çš„ä¸€ç§å…³ç³»ï¼Œæ¯”è¾ƒåƒé›†åˆä¸­çš„ä»å±äºå…³ç³»ã€‚æ¯”å¦‚è¯´ï¼Œç‹—å±äºåŠ¨ç‰©ã€‚å°±å¯ä»¥çœ‹æˆç‹—ç±»ç»§æ‰¿äº†åŠ¨ç‰©ç±»ï¼Œé‚£ä¹ˆç‹—ç±»å°±æ˜¯åŠ¨ç‰©ç±»çš„å­ç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰ï¼ŒåŠ¨ç‰©ç±»å°±æ˜¯ç‹—ç±»çš„çˆ¶ç±»ï¼ˆåŸºç±»ï¼‰ã€‚åœ¨Javaä¸­æ˜¯å•ç»§æ‰¿çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªå­ç±»åªæœ‰ä¸€ä¸ªçˆ¶ç±»ã€‚ </p><h4 id="2-ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š"><a href="#2-ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š" class="headerlink" title="2. ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š"></a><strong>2. ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š</strong></h4><p>ï¼ˆ1ï¼‰ å­ç±»æ¯”çˆ¶ç±»å¼ºå¤§<br>ï¼ˆ2ï¼‰javaæ˜¯å•ç»§æ‰¿ï¼Œä¸èƒ½è¿›è¡Œå¤šç»§æ‰¿ã€‚ä½†æ˜¯å¯ä»¥ç»§æ‰¿å¤šå±‚å­ç±»ï¼ˆ<strong>ä¸å»ºè®®ç»§æ‰¿è¶…è¿‡3å±‚</strong>ï¼‰<br>ï¼ˆ3ï¼‰å­ç±»ç»§æ‰¿çˆ¶ç±»ï¼Œä½†æ˜¯å¯¹çˆ¶ç±»çš„æˆå‘˜å˜é‡æ˜¯æ— æ³•ç›´æ¥æ“ä½œï¼Œåªèƒ½é€šè¿‡çˆ¶ç±»ç»§æ‰¿è¿‡æ¥çš„setterå’Œgetteræ–¹æ³•. </p><h4 id="3-ç»§æ‰¿ä¼˜ç¼ºç‚¹"><a href="#3-ç»§æ‰¿ä¼˜ç¼ºç‚¹" class="headerlink" title="3.ç»§æ‰¿ä¼˜ç¼ºç‚¹"></a>3.ç»§æ‰¿ä¼˜ç¼ºç‚¹</h4><blockquote><p>ä¼˜ç‚¹</p></blockquote><p>  (1)  å‡å°‘ä»£ç é‡ï¼Œèƒ½å¾ˆå¥½çš„æé«˜å¤ç”¨ç‡ã€‚<br>  (2)  ä½¿ç±»ä¸ç±»ä¹‹é—´å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œæ˜¯å®ç°å¤šæ€æ“ä½œçš„å‰æã€‚ </p><blockquote><p>ç¼ºç‚¹</p></blockquote><p>ç»§æ‰¿ä½¿å¾—å¤šä¸ªç±»ä¹‹é—´å…·æœ‰äº†å­çˆ¶ç±»å…³ç³»ï¼Œå½“ä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªå­ç±»çš„æ—¶å€™ï¼Œå¦‚æœçˆ¶ç±»å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè¿™äº›å­ç±»ä¼šè·Ÿç€ä¸€åŒå˜åŒ–ï¼Œé€ æˆç±»ä¸ç±»ä¹‹é—´çš„â€œå¼ºè€¦åˆâ€å…³ç³»ï¼ </p><h4 id="4-ç»§æ‰¿æ³¨æ„ç‚¹"><a href="#4-ç»§æ‰¿æ³¨æ„ç‚¹" class="headerlink" title="4.ç»§æ‰¿æ³¨æ„ç‚¹"></a><strong>4.ç»§æ‰¿æ³¨æ„ç‚¹</strong></h4><p> (1) ä¸è¦ä»…ä»…ä¸ºäº†è·å–æŸä¸ªç±»çš„æŸä¸ªåŠŸèƒ½è€Œå»ç»§æ‰¿è¿™ä¸ªç±»<br> (2) ç±»ä¸ç±»ä¹‹é—´è¦å­˜åœ¨æ‰€å±å…³ç³»ï¼Œä¸èƒ½å¤Ÿéšæ„ç»§æ‰¿ </p><h4 id="5-ä½•æ—¶ä½¿ç”¨ç»§æ‰¿"><a href="#5-ä½•æ—¶ä½¿ç”¨ç»§æ‰¿" class="headerlink" title="5.ä½•æ—¶ä½¿ç”¨ç»§æ‰¿"></a><strong>5.ä½•æ—¶ä½¿ç”¨ç»§æ‰¿</strong></h4><p>ï¼ˆ1ï¼‰å…·æœ‰å…¬å…±çš„å±æ€§ä¸è¡Œä¸ºæ“ä½œçš„æ—¶å€™ï¼Œæé«˜å¤ç”¨æ€§<br>ï¼ˆ2ï¼‰å…·æœ‰isâ€“açš„æ‰€å±å…³ç³»çš„ç±»ä¸ç±»ä¹‹é—´ </p><h4 id="7-ç»“è®º"><a href="#7-ç»“è®º" class="headerlink" title="7. ç»“è®º"></a><strong>7. ç»“è®º</strong></h4><p>ï¼ˆ1ï¼‰æ‰§è¡Œæ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡å®Œæˆå¯¹è±¡çš„åˆå§‹åŒ–æ—¶ï¼Œå…ˆæ‰§è¡Œçˆ¶ç±»çš„æ„é€ ï¼Œå®Œæˆçˆ¶ç±»çš„åˆå§‹åŒ–ï¼Œå†æ‰§è¡Œæœ¬ç±»çš„åˆå§‹åŒ–å·¥ä½œã€‚</p><p>ï¼ˆ2ï¼‰ç¬¬ä¸€æ¬¡åˆ›å»ºPhoneï¼ˆçˆ¶ï¼‰ç±»ï¼Œæ˜¯ç›´æ¥ç»§æ‰¿Object,è€ŒObjectæ˜¯jdkæä¾›çš„å·¥å…·ç±»ï¼Œè‡ªç„¶ä¸ä¼šæœ‰å±æ€§ï¼Œæ‰€ä»¥Objectç±»åªæä¾›äº†æ— å‚çš„æ„é€ ï¼Œåœ¨æ‰§è¡ŒPhoneæ–¹æ³•æ—¶ï¼Œæ— è®ºæ˜¯æ— å‚è¿˜æ˜¯æœ‰å‚éƒ½ä¼šå…ˆæ‰§è¡Œçˆ¶ç±»Objectçš„æ— å‚æ„é€ ã€‚</p><p>ï¼ˆ3ï¼‰ä½†æ˜¯å¯¹äºPhoneçš„å­ç±»Mobileï¼Œå¿…é¡»ä¹Ÿè¦æœ‰è‡ªå·±çš„æ„é€ æ–¹æ³•ï¼Œç”±äºæ„é€ æ‰§è¡Œçš„ç‰¹æ€§ï¼Œå¯¹äºæ— å‚æ„é€ ï¼Œå…ˆæ‰§è¡Œäº†Phoneçš„æ— å‚æ„é€ ï¼Œå¯¹äºæœ‰å‚æ„é€ ï¼Œåˆ™å…ˆæ‰§è¡Œçˆ¶ç±»Phoneçš„æœ‰å‚ï¼Œç„¶åæ‰æ‰§è¡Œæœ¬ç±»å±æ€§sexçš„åˆå§‹åŒ–ã€‚</p><p>ï¼ˆ4ï¼‰æ„é€ æ–¹æ³•constructorä¸­,æ— è®ºæ˜¯å¦æ˜¾å¼è¿˜æ˜¯éšå¼è°ƒç”¨super(),å­ç±»åœ¨åˆ›å»ºå¯¹è±¡è°ƒç”¨æ—¶éƒ½ä¼šæ‰§è¡Œsuper();</p><p>ï¼ˆ5ï¼‰æ˜¾å¼è°ƒç”¨æ„é€ æ˜¯åœ¨éœ€è¦é€šè¿‡çˆ¶ç±»çš„å¸¦å‚æ„é€ æ¥å®Œæˆå­ç±»çš„å¸¦å‚æ„é€ ã€‚ä¾‹å¦‚Mobileç±»å¸¦å‚æ„é€ ä¸­æ˜¾ç¤ºè°ƒç”¨çš„Super(brand,price,service)</p><p>ï¼ˆ6ï¼‰å¯¹äºçˆ¶ç±»ç§æœ‰çš„å±æ€§ï¼Œå³ä½¿å­ç±»ç»§æ‰¿ï¼Œä½†æ˜¯åœ¨test.javaä¸­ï¼Œå­ç±»æ˜¯æ— æ³•ç›´æ¥è®¿é—®çš„ï¼Œåœ¨åˆ¶å®šå­ç±»çš„å¸¦å‚æ„é€ æ–¹æ³•æ—¶ï¼Œåªèƒ½é€šè¿‡è°ƒç”¨çˆ¶ç±»çš„å¸¦å‚æ„é€ æ¥å®Œæˆã€‚å¯¹äºçˆ¶ç±»éç§æœ‰çš„å±æ€§ï¼Œå­ç±»å¯¹è±¡å¯ä»¥ç›´æ¥è°ƒç”¨ã€‚</p><h3 id="ä¸‰ã€å¤šæ€"><a href="#ä¸‰ã€å¤šæ€" class="headerlink" title="ä¸‰ã€å¤šæ€"></a>ä¸‰ã€å¤šæ€</h3><h4 id="1-æ¦‚è¿°-2"><a href="#1-æ¦‚è¿°-2" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h4><p>å¤šæ€æŒ‡çš„æ˜¯å¯¹è±¡çš„å¤šç§å½¢æ€ã€‚ å¤šæ€æœ‰ä¸¤ç§ï¼šå¼•ç”¨å¤šæ€å’Œæ–¹æ³•å¤šæ€ã€‚<strong>ç»§æ‰¿æ˜¯å¤šæ€çš„å®ç°åŸºç¡€ã€‚</strong>Javaçš„å¤šæ€æ˜¯ç”±ç±»çš„ç»§æ‰¿ã€æ–¹æ³•é‡å†™ä»¥åŠçˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ä½“ç°çš„ã€‚ç”±äºä¸€ä¸ªçˆ¶ç±»å¯ä»¥æœ‰å¤šä¸ªå­ç±»ï¼Œå¤šä¸ªå­ç±»éƒ½å¯ä»¥é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œå¹¶ä¸”å¤šä¸ªä¸åŒçš„å­ç±»å¯¹è±¡ä¹Ÿå¯ä»¥æŒ‡å‘åŒä¸€ä¸ªçˆ¶ç±»ï¼›è¿™æ ·ï¼Œç¨‹åºåªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“å…·ä½“ä»£è¡¨çš„æ˜¯å“ªä¸ªå­ç±»å¯¹è±¡ï¼Œè¿™å°±ä½“ç°äº†å¤šæ€ã€‚</p><p><strong>å®ä¾‹</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰æŠ½è±¡ç±»Animal</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shout</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br><br><span class="hljs-comment">//å®šä¹‰ Catç±»ç»§æ‰¿AnimalæŠ½è±¡ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>&#123;<br>    <span class="hljs-comment">//å®ç°shout()æ–¹æ³•</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shout</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.print(<span class="hljs-string">&quot;å–µå–µã€‚ã€‚ã€‚&quot;</span>);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">//å®šä¹‰Dogç±»ç»§æ‰¿AnimalæŠ½è±¡ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>&#123;<br>    <span class="hljs-comment">//å®ç°shout()æ–¹æ³•</span><br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shout</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.print(<span class="hljs-string">&quot;æ±ªæ±ªã€‚ã€‚ã€‚&quot;</span>)<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">//å®šä¹‰æµ‹è¯•ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Animal an1 = <span class="hljs-keyword">new</span> Cat();<br>        Animal an2 = <span class="hljs-keyword">new</span> Dog();<br>        <br>        an1.shout();<br>        an2.shout();<br>    &#125;<br>&#125;<br><br><br><br><br></code></pre></td></tr></table></figure><h4 id="2-å¤šæ€å­˜åœ¨çš„å‰æï¼ˆå¤šæ€çš„ä¸‰è¦ç´ ï¼‰"><a href="#2-å¤šæ€å­˜åœ¨çš„å‰æï¼ˆå¤šæ€çš„ä¸‰è¦ç´ ï¼‰" class="headerlink" title="2. å¤šæ€å­˜åœ¨çš„å‰æï¼ˆå¤šæ€çš„ä¸‰è¦ç´ ï¼‰"></a>2. <strong>å¤šæ€å­˜åœ¨çš„å‰æï¼ˆå¤šæ€çš„ä¸‰è¦ç´ ï¼‰</strong></h4><p>(1)  å¿…é¡»æœ‰å­ç±»å’Œçˆ¶ç±»ï¼Œå…·æœ‰ç»§æ‰¿æˆ–å®ç°ï¼ˆç»§æ‰¿ï¼‰ </p><p>(2) å­ç±»å¿…é¡»é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼ˆé‡å†™ï¼‰</p><p>(3) çˆ¶ç±»çš„å¼•ç”¨å˜é‡æŒ‡å‘å­ç±»çš„å¯¹è±¡ï¼ˆå‘ä¸Šè½¬å‹ï¼‰  </p><h4 id="3-å¤šæ€ä¼˜ç¼ºç‚¹"><a href="#3-å¤šæ€ä¼˜ç¼ºç‚¹" class="headerlink" title="3.å¤šæ€ä¼˜ç¼ºç‚¹"></a>3.å¤šæ€ä¼˜ç¼ºç‚¹</h4><blockquote><p>ä¼˜ç‚¹</p></blockquote><p>  A. å¯æ›¿æ¢æ€§ï¼Œå¤šæ€å¯¹ä¸€å­˜åœ¨çš„ä»£ç å…·æœ‰å¯æ›¿ä»£æ€§</p><p>  B. å¯æ‰©å……æ€§ï¼šå¢åŠ çš„å­ç±»ä¸å½±å“å·²å­˜åœ¨çš„ç±»çš„ç‰¹æ€§çš„è¿è¡Œå’Œæ“ä½œ</p><p>  C. æ¥å£æ€§ï¼šå¤šæ€æ—¶è¶…ç±»é€šè¿‡æ–¹æ³•ç­¾åæƒ³å­ç±»æä¾›äº†ä¸€ä¸ªå…¬å…±çš„æ¥å£ï¼Œç”±å­ç±»æ¥å®Œå–„æˆ–è€…è¦†ç›–å®ƒè€Œå®ç°çš„</p><p>  D. çµæ´»æ€§ï¼šåœ¨åº”ç”¨ä¸­ä½“ç°äº†çµæ´»å¤šæ ·çš„æ“ä½œï¼Œæé«˜äº†ä½¿ç”¨çš„æ•ˆç‡</p><p>  E. ç®€åŒ–æ€§ï¼š å¤šæ€ç®€åŒ–å¯¹åº”ç”¨è½¯ä»¶çš„ä»£ç çš„ç¼–å†™å’Œä¿®æ”¹è¿‡ç¨‹ï¼Œå°¤å…¶åœ¨å¤„ç†å¤§é‡çš„å¯¹è±¡çš„è¿ç®—å’Œæ“ä½œæ—¶ï¼Œè¿™ä¸ªç‰¹ç‚¹å°¤ä¸ºçªå‡ºå’Œé‡è¦</p><blockquote><p>ç¼ºç‚¹</p></blockquote><p>åªèƒ½ä½¿ç”¨çˆ¶ç±»çš„å¼•ç”¨è®¿é—®çˆ¶ç±»çš„æˆå‘˜ </p><h4 id="4-å¤šæ€ä¸­çš„æˆå‘˜ç‰¹ç‚¹"><a href="#4-å¤šæ€ä¸­çš„æˆå‘˜ç‰¹ç‚¹" class="headerlink" title="4. å¤šæ€ä¸­çš„æˆå‘˜ç‰¹ç‚¹"></a>4. <strong>å¤šæ€ä¸­çš„æˆå‘˜ç‰¹ç‚¹</strong></h4><p>  æˆå‘˜å˜é‡ï¼šç¼–è¯‘ä¸è¿è¡Œæ—¶æœŸéƒ½çœ‹çˆ¶ç±»ï¼ æˆå‘˜æ–¹æ³•ï¼šç¼–è¯‘æ—¶æœŸçœ‹çˆ¶ç±»ï¼Œè¿è¡Œæ—¶æœŸçœ‹å­ç±» </p><p>å‚è€ƒï¼š</p><hr><p><a href="https://blog.csdn.net/hellosweet1/article/details/81320384">https://blog.csdn.net/hellosweet1/article/details/81320384</a></p><p>JavaåŸºç¡€å…¥é—¨ç¬¬äºŒç‰ˆ</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaåŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisç¼“å­˜ç©¿é€å’Œé›ªå´©</title>
    <link href="/2021/10/11/Redis%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E5%92%8C%E9%9B%AA%E5%B4%A9/"/>
    <url>/2021/10/11/Redis%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E5%92%8C%E9%9B%AA%E5%B4%A9/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="æœåŠ¡çš„é«˜å¯ç”¨é—®é¢˜"><a href="#æœåŠ¡çš„é«˜å¯ç”¨é—®é¢˜" class="headerlink" title="æœåŠ¡çš„é«˜å¯ç”¨é—®é¢˜"></a>æœåŠ¡çš„é«˜å¯ç”¨é—®é¢˜</h3><p>â€‹       Redisç¼“å­˜çš„ä½¿ç”¨ï¼Œæå¤§çš„æå‡äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œæ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯æ•°æ®æŸ¥è¯¢æ–¹é¢ã€‚ä½†åŒæ—¶ï¼Œå®ƒä¹Ÿå¸¦æ¥äº†ä¸€ äº›é—®é¢˜ã€‚å…¶ä¸­ï¼Œæœ€è¦å®³çš„é—®é¢˜ï¼Œå°±æ˜¯æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œä»ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œè¿™ä¸ªé—®é¢˜æ— è§£ã€‚å¦‚æœå¯¹æ•°æ®çš„ä¸€è‡´æ€§è¦æ±‚å¾ˆé«˜ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨ç¼“å­˜ã€‚ å¦å¤–çš„ä¸€äº›å…¸å‹é—®é¢˜å°±æ˜¯ï¼Œç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©å’Œç¼“å­˜å‡»ç©¿ã€‚ç›®å‰ï¼Œä¸šç•Œä¹Ÿéƒ½æœ‰æ¯”è¾ƒæµè¡Œçš„è§£å†³æ–¹æ¡ˆã€‚  </p><h3 id="ç¼“å­˜ç©¿é€"><a href="#ç¼“å­˜ç©¿é€" class="headerlink" title="ç¼“å­˜ç©¿é€"></a>ç¼“å­˜ç©¿é€</h3><blockquote><p>æ¦‚å¿µ  </p></blockquote><p>â€‹    ç¼“å­˜ç©¿é€çš„æ¦‚å¿µå¾ˆç®€å•ï¼Œç”¨æˆ·æƒ³è¦æŸ¥è¯¢ä¸€ä¸ªæ•°æ®ï¼Œå‘ç°rediså†…å­˜æ•°æ®åº“æ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯ç¼“å­˜æ²¡æœ‰å‘½ä¸­,äºæ˜¯å‘æŒä¹…å±‚æ•°æ®åº“æŸ¥è¯¢ã€‚å‘ç°ä¹Ÿæ²¡æœ‰ï¼Œäºæ˜¯æœ¬æ¬¡æŸ¥è¯¢å¤±è´¥ã€‚å½“ç”¨æˆ·å¾ˆå¤šçš„æ—¶å€™ï¼Œç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­(ç§’æ€!)ï¼Œäºæ˜¯éƒ½å»è¯·æ±‚äº†æŒä¹…å±‚æ•°æ®åº“ã€‚è¿™ä¼šç»™æŒä¹…å±‚æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œè¿™æ—¶å€™å°±ç›¸å½“äºå‡ºç°äº† ç¼“å­˜ç©¿é€ã€‚ </p><p><img src="/img/work/1633962251731.png"></p><blockquote><p>è§£å†³æ–¹æ¡ˆ  </p></blockquote><p><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>  </p><p>â€‹     å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ ¡éªŒï¼Œä¸ç¬¦åˆåˆ™ ä¸¢å¼ƒï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢å‹åŠ›ï¼› </p><p><img src="/img/work/1633962830773.png"></p><p><strong>ç¼“å­˜ç©ºå¯¹è±¡</strong> </p><p>â€‹    å½“å­˜å‚¨å±‚ä¸å‘½ä¸­åï¼Œå³ä½¿è¿”å›çš„ç©ºå¯¹è±¡ä¹Ÿå°†å…¶ç¼“å­˜èµ·æ¥ï¼ŒåŒæ—¶ä¼šè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹‹åå†è®¿é—®è¿™ä¸ªæ•° æ®å°†ä¼šä»ç¼“å­˜ä¸­è·å–ï¼Œä¿æŠ¤äº†åç«¯æ•°æ®æºï¼›  </p><p>ä½†æ˜¯è¿™ç§æ–¹æ³•ä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š </p><p>1ã€å¦‚æœç©ºå€¼èƒ½å¤Ÿè¢«ç¼“å­˜èµ·æ¥ï¼Œè¿™å°±æ„å‘³ç€ç¼“å­˜éœ€è¦æ›´å¤šçš„ç©ºé—´å­˜å‚¨æ›´å¤šçš„é”®ï¼Œå› ä¸ºè¿™å½“ä¸­å¯èƒ½ä¼šæœ‰å¾ˆå¤š çš„ç©ºå€¼çš„é”®ï¼› </p><p>2ã€å³ä½¿å¯¹ç©ºå€¼è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œè¿™å¯¹äº éœ€è¦ä¿æŒä¸€è‡´æ€§çš„ä¸šåŠ¡ä¼šæœ‰å½±å“ã€‚ </p><h3 id="ç¼“å­˜å‡»ç©¿"><a href="#ç¼“å­˜å‡»ç©¿" class="headerlink" title="ç¼“å­˜å‡»ç©¿"></a>ç¼“å­˜å‡»ç©¿</h3><blockquote><p>æ¦‚è¿° </p></blockquote><p>â€‹      è¿™é‡Œéœ€è¦æ³¨æ„å’Œç¼“å­˜å‡»ç©¿çš„åŒºåˆ«ï¼Œç¼“å­˜å‡»ç©¿ï¼Œæ˜¯æŒ‡ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­ å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚ </p><p>â€‹     å½“æŸä¸ªkeyåœ¨è¿‡æœŸçš„ç¬é—´ï¼Œæœ‰å¤§é‡çš„è¯·æ±‚å¹¶å‘è®¿é—®ï¼Œè¿™ç±»æ•°æ®ä¸€èˆ¬æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œç”±äºç¼“å­˜è¿‡æœŸï¼Œä¼šåŒæ—¶è®¿ é—®æ•°æ®åº“æ¥æŸ¥è¯¢æœ€æ–°æ•°æ®ï¼Œå¹¶ä¸”å›å†™ç¼“å­˜ï¼Œä¼šå¯¼ä½¿æ•°æ®åº“ç¬é—´å‹åŠ›è¿‡å¤§ã€‚ </p><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><blockquote><p>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ   </p></blockquote><p>â€‹     ä»ç¼“å­˜å±‚é¢æ¥çœ‹ï¼Œæ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°çƒ­ç‚¹ key è¿‡æœŸåäº§ç”Ÿçš„é—®é¢˜ã€‚  </p><p> <strong>åŠ äº’æ–¥é”</strong></p><p>â€‹     åˆ†å¸ƒå¼é”ï¼šä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œä¿è¯å¯¹äºæ¯ä¸ªkeyåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å»æŸ¥è¯¢åç«¯æœåŠ¡ï¼Œå…¶ä»–çº¿ç¨‹æ²¡æœ‰è·å¾—åˆ†å¸ƒ å¼é”çš„æƒé™ï¼Œå› æ­¤åªéœ€è¦ç­‰å¾…å³å¯ã€‚è¿™ç§æ–¹å¼å°†é«˜å¹¶å‘çš„å‹åŠ›è½¬ç§»åˆ°äº†åˆ†å¸ƒå¼é”ï¼Œå› æ­¤å¯¹åˆ†å¸ƒå¼é”çš„è€ƒ éªŒå¾ˆå¤§ã€‚  </p><p><img src="/img/work/1633963512731.png"></p><h3 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h3><p> <strong>æ¦‚å¿µ</strong>  </p><p>â€‹      ç¼“å­˜é›ªå´©ï¼Œæ˜¯æŒ‡åœ¨æŸä¸€ä¸ªæ—¶é—´æ®µï¼Œç¼“å­˜é›†ä¸­è¿‡æœŸå¤±æ•ˆã€‚Redis å®•æœºï¼ </p><p>â€‹      äº§ç”Ÿé›ªå´©çš„åŸå› ä¹‹ä¸€ï¼Œæ¯”å¦‚åŒåäºŒé›¶ç‚¹ï¼Œå¾ˆå¿«å°±ä¼šè¿æ¥ä¸€æ³¢æŠ¢è´­ï¼Œè¿™æ³¢å•†å“æ—¶é—´æ¯”è¾ƒé›†ä¸­çš„æ”¾å…¥äº†ç¼“å­˜ï¼Œå‡è®¾ç¼“å­˜ä¸€ä¸ªå°æ—¶ã€‚é‚£ä¹ˆåˆ°äº†å‡Œæ™¨ä¸€ç‚¹é’Ÿçš„æ—¶å€™ï¼Œè¿™æ‰¹å•†å“çš„ç¼“å­˜å°±éƒ½è¿‡æœŸäº†ã€‚è€Œå¯¹è¿™æ‰¹å•†å“çš„è®¿é—®æŸ¥è¯¢ï¼Œéƒ½è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå¯¹äºæ•°æ®åº“è€Œè¨€ï¼Œå°±ä¼šäº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›æ³¢å³°ã€‚äºæ˜¯æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¾¾åˆ°å­˜å‚¨å±‚ï¼Œå­˜å‚¨å±‚çš„è°ƒç”¨é‡ä¼šæš´å¢ï¼Œé€ æˆå­˜å‚¨å±‚ä¹Ÿä¼šæŒ‚æ‰çš„æƒ…å†µã€‚ </p><p><img src="/img/work/1633963929642.png"></p><p>â€‹      å…¶å®é›†ä¸­è¿‡æœŸï¼Œå€’ä¸æ˜¯éå¸¸è‡´å‘½ï¼Œæ¯”è¾ƒè‡´å‘½çš„ç¼“å­˜é›ªå´©ï¼Œæ˜¯ç¼“å­˜æœåŠ¡å™¨æŸä¸ªèŠ‚ç‚¹å®•æœºæˆ–æ–­ç½‘ã€‚å› ä¸ºè‡ªç„¶å½¢æˆçš„ç¼“å­˜é›ªå´©ï¼Œä¸€å®šæ˜¯åœ¨æŸä¸ªæ—¶é—´æ®µé›†ä¸­åˆ›å»ºç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ•°æ®åº“ä¹Ÿæ˜¯å¯ä»¥é¡¶ä½å‹åŠ›çš„ã€‚æ— éå°±æ˜¯å¯¹æ•°æ®åº“äº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›è€Œå·²ã€‚è€Œç¼“å­˜æœåŠ¡èŠ‚ç‚¹çš„å®•æœºï¼Œå¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆçš„å‹åŠ›æ˜¯ä¸å¯é¢„çŸ¥ çš„ï¼Œå¾ˆæœ‰å¯èƒ½ç¬é—´å°±æŠŠæ•°æ®åº“å‹å®ã€‚ </p><blockquote><p>è§£å†³æ–¹æ¡ˆ  </p></blockquote><p><strong>redisé«˜å¯ç”¨</strong> </p><p>â€‹      è¿™ä¸ªæ€æƒ³çš„å«ä¹‰æ˜¯ï¼Œæ—¢ç„¶redisæœ‰å¯èƒ½æŒ‚æ‰ï¼Œé‚£æˆ‘å¤šå¢è®¾å‡ å°redisï¼Œè¿™æ ·ä¸€å°æŒ‚æ‰ä¹‹åå…¶ä»–çš„è¿˜å¯ä»¥ç»§ç»­å·¥ä½œï¼Œå…¶å®å°±æ˜¯æ­å»ºçš„é›†ç¾¤ã€‚</p><p><strong>é™æµé™çº§</strong></p><p>â€‹      è¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„æ€æƒ³æ˜¯ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æ•°æ®åº“å†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ã€‚æ¯”å¦‚å¯¹æŸä¸ªkeyåªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚ </p><p><strong>æ•°æ®é¢„çƒ­</strong> </p><p>â€‹     æ•°æ®åŠ çƒ­çš„å«ä¹‰å°±æ˜¯åœ¨æ­£å¼éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠå¯èƒ½çš„æ•°æ®å…ˆé¢„å…ˆè®¿é—®ä¸€éï¼Œè¿™æ ·éƒ¨åˆ†å¯èƒ½å¤§é‡è®¿é—®çš„æ•° æ®å°±ä¼šåŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ä¸åŒçš„keyï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®©ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ã€‚ </p><p>å¼•ç”¨:</p><hr><p>ç‹‚ç¥è¯´Java:<a href="https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisä¸‰ç§é›†ç¾¤æ¨¡å¼ä¹‹Clusteræ¨¡å¼</title>
    <link href="/2021/10/07/redis-cluster%E9%9B%86%E7%BE%A4/"/>
    <url>/2021/10/07/redis-cluster%E9%9B%86%E7%BE%A4/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1ã€redis-cluterè®¾è®¡"><a href="#1ã€redis-cluterè®¾è®¡" class="headerlink" title="1ã€redis-cluterè®¾è®¡"></a>1ã€redis-cluterè®¾è®¡</h2><p> Redisé›†ç¾¤æ­å»ºçš„æ–¹å¼æœ‰å¤šç§ï¼Œå¼€å§‹ä½¿ç”¨ä¸»ä»æ¨¡å¼åšé›†ç¾¤ï¼Œè‹¥masterå®•æœºéœ€è¦æ‰‹åŠ¨é…ç½®slaveè½¬ä¸ºmasterï¼›åæ¥ä¸ºäº†é«˜å¯ç”¨æå‡ºæ¥(redis-sentinel)<strong>å“¨å…µ</strong>æ¨¡å¼ï¼Œè¯¥æ¨¡å¼ä¸‹æœ‰ä¸€ä¸ªå“¨å…µç›‘è§†masterå’Œslaveï¼Œè‹¥masterå®•æœºå¯è‡ªåŠ¨å°†slaveè½¬ä¸ºmasterï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸èƒ½åŠ¨æ€æ‰©å……ï¼›ä»redis 3.0ä¹‹åç‰ˆæœ¬æ”¯æŒredis-clusteré›†ç¾¤. </p><p> Redis-Clusteré‡‡ç”¨æ— ä¸­å¿ƒç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çŠ¶æ€,æ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è¿æ¥ã€‚å…¶redis-clusteræ¶æ„å›¾å¦‚ä¸‹ï¼š </p><p><img src="/img/work/1633829297415.png"></p><p> å…¶ç»“æ„ç‰¹ç‚¹ï¼š </p><ol><li> æ‰€æœ‰çš„redisèŠ‚ç‚¹å½¼æ­¤äº’è”(PING-PONGæœºåˆ¶),å†…éƒ¨ä½¿ç”¨äºŒè¿›åˆ¶åè®®ä¼˜åŒ–ä¼ è¾“é€Ÿåº¦å’Œå¸¦å®½ã€‚ </li><li> èŠ‚ç‚¹çš„failæ˜¯é€šè¿‡é›†ç¾¤ä¸­è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹æ£€æµ‹å¤±æ•ˆæ—¶æ‰ç”Ÿæ•ˆã€‚ </li><li> å®¢æˆ·ç«¯ä¸redisèŠ‚ç‚¹ç›´è¿,ä¸éœ€è¦ä¸­é—´proxyå±‚.å®¢æˆ·ç«¯ä¸éœ€è¦è¿æ¥é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹,è¿æ¥é›†ç¾¤ä¸­ä»»ä½•ä¸€ä¸ªå¯ç”¨èŠ‚ç‚¹å³å¯ã€‚ </li><li> redis-clusteræŠŠæ‰€æœ‰çš„ç‰©ç†èŠ‚ç‚¹æ˜ å°„åˆ°[0-16383]slotä¸Šï¼ˆä¸ä¸€å®šæ˜¯å¹³å‡åˆ†é…ï¼‰,cluster è´Ÿè´£ç»´æŠ¤node&lt;-&gt;slot&lt;-&gt;valueã€‚ </li><li> Redisé›†ç¾¤é¢„åˆ†å¥½16384ä¸ªæ¡¶ï¼Œå½“éœ€è¦åœ¨ Redis é›†ç¾¤ä¸­æ”¾ç½®ä¸€ä¸ª key-value æ—¶ï¼Œæ ¹æ® CRC16(key) mod 16384çš„å€¼ï¼Œå†³å®šå°†ä¸€ä¸ªkeyæ”¾åˆ°å“ªä¸ªæ¡¶ä¸­ã€‚ </li></ol><h2 id="2ã€redis-clusterèŠ‚ç‚¹åˆ†é…"><a href="#2ã€redis-clusterèŠ‚ç‚¹åˆ†é…" class="headerlink" title="2ã€redis clusterèŠ‚ç‚¹åˆ†é…"></a>2ã€redis clusterèŠ‚ç‚¹åˆ†é…</h2><p>ç°åœ¨æˆ‘ä»¬æ˜¯ä¸‰ä¸ªèŠ‚ç‚¹åˆ†åˆ«æ˜¯ï¼šA,B,C ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä¸€å°æœºå™¨ä¸Šçš„ä¸‰ä¸ªç«¯å£ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸‰å°ä¸åŒæœåŠ¡å™¨ã€‚é‚£ä¹ˆï¼Œé‡‡ç”¨å“ˆå¸Œæ§½ï¼ˆhash soltï¼‰çš„æ–¹å¼æ¥åˆ†é…16384ä¸ªsoltçš„è¯ï¼Œä»–ä»¬ä¸‰ä¸ªèŠ‚ç‚¹åˆ†åˆ«æ‰¿æ‹…çš„soltåŒºé—´æ˜¯ï¼š</p><ul><li><p>èŠ‚ç‚¹Aè¦†ç›–0ï¼5460; </p></li><li><p>èŠ‚ç‚¹Bè¦†ç›–5461ï¼10922; </p></li><li><p>èŠ‚ç‚¹Cè¦†ç›–10923ï¼16383ï¼›</p></li></ul><p> è·å–æ•°æ®ï¼š </p><p>â€‹     å¦‚æœå­˜å…¥ä¸€ä¸ªå€¼ï¼ŒæŒ‰ç…§redis-clusterå“ˆå¸Œæ§½çš„ç®—æ³•ï¼šCRC16(â€˜keyâ€™)%16384 = 6782ã€‚é‚£ä¹ˆå°±ä¼šæŠŠè¿™ä¸ªkeyçš„å­˜å‚¨åˆ†é…åˆ° B ä¸Šã€‚åŒæ ·ï¼Œå½“æˆ‘è¿æ¥ï¼ˆAï¼ŒBï¼ŒCï¼‰ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæƒ³è·å–â€™keyâ€™è¿™ä¸ªkeyæ—¶ï¼Œä¹Ÿä¼šè¿™æ ·çš„ç®—æ³•ï¼Œç„¶åå†…éƒ¨è·³è½¬åˆ°BèŠ‚ç‚¹ä¸Šè·å–æ•°æ®æ–°å¢ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼š</p><p> æ–°å¢ä¸€ä¸ªèŠ‚ç‚¹Dï¼Œredis clusterçš„è¿™ç§åšæ³•æ˜¯ä»å„ä¸ªèŠ‚ç‚¹çš„å‰é¢å„æ‹¿å–ä¸€éƒ¨åˆ†slotåˆ°Dä¸Šï¼Œæˆ‘ä¼šåœ¨æ¥ä¸‹æ¥çš„å®è·µä¸­å®éªŒã€‚å¤§è‡´å°±ä¼šå˜æˆè¿™æ ·ï¼š </p><ul><li>èŠ‚ç‚¹Aè¦†ç›–1365-5460</li><li> èŠ‚ç‚¹Bè¦†ç›–6827-10922</li><li> èŠ‚ç‚¹Cè¦†ç›–12288-16383</li><li> èŠ‚ç‚¹Dè¦†ç›–0-1364,5461-6826,10923-12287 </li></ul><h2 id="3ã€-Redis-Clusterä¸»ä»æ¨¡å¼"><a href="#3ã€-Redis-Clusterä¸»ä»æ¨¡å¼" class="headerlink" title="3ã€ Redis Clusterä¸»ä»æ¨¡å¼"></a>3ã€ <strong>Redis Clusterä¸»ä»æ¨¡å¼</strong></h2><p>â€‹        redis cluster ä¸ºäº†ä¿è¯æ•°æ®çš„é«˜å¯ç”¨æ€§ï¼ŒåŠ å…¥äº†ä¸»ä»æ¨¡å¼ï¼Œä¸€ä¸ªä¸»èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹æä¾›æ•°æ®å­˜å–ï¼Œä»èŠ‚ç‚¹åˆ™æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–æ•°æ®å¤‡ä»½ï¼Œå½“è¿™ä¸ªä¸»èŠ‚ç‚¹æŒ‚æ‰åï¼Œå°±ä¼šæœ‰è¿™ä¸ªä»èŠ‚ç‚¹é€‰å–ä¸€ä¸ªæ¥å……å½“ä¸»èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯é›†ç¾¤ä¸ä¼šæŒ‚æ‰ã€‚</p><p>â€‹       ä¸Šé¢é‚£ä¸ªä¾‹å­é‡Œ, é›†ç¾¤æœ‰ABCä¸‰ä¸ªä¸»èŠ‚ç‚¹, å¦‚æœè¿™3ä¸ªèŠ‚ç‚¹éƒ½æ²¡æœ‰åŠ å…¥ä»èŠ‚ç‚¹ï¼Œå¦‚æœBæŒ‚æ‰äº†ï¼Œæˆ‘ä»¬å°±æ— æ³•è®¿é—®æ•´ä¸ªé›†ç¾¤äº†ã€‚Aå’ŒCçš„slotä¹Ÿæ— æ³•è®¿é—®ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨é›†ç¾¤å»ºç«‹çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¸ºæ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æ·»åŠ äº†ä»èŠ‚ç‚¹, æ¯”å¦‚åƒè¿™æ ·, é›†ç¾¤åŒ…å«ä¸»èŠ‚ç‚¹Aã€Bã€C, ä»¥åŠä»èŠ‚ç‚¹A1ã€B1ã€C1, é‚£ä¹ˆå³ä½¿BæŒ‚æ‰ç³»ç»Ÿä¹Ÿå¯ä»¥ç»§ç»­æ­£ç¡®å·¥ä½œã€‚B1èŠ‚ç‚¹æ›¿ä»£äº†BèŠ‚ç‚¹ï¼Œæ‰€ä»¥Redisé›†ç¾¤å°†ä¼šé€‰æ‹©B1èŠ‚ç‚¹ä½œä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œé›†ç¾¤å°†ä¼šç»§ç»­æ­£ç¡®åœ°æä¾›æœåŠ¡ã€‚ å½“Bé‡æ–°å¼€å¯åï¼Œå®ƒå°±ä¼šå˜æˆB1çš„ä»èŠ‚ç‚¹ã€‚ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œå¦‚æœèŠ‚ç‚¹Bå’ŒB1åŒæ—¶æŒ‚äº†ï¼ŒRedisé›†ç¾¤å°±æ— æ³•ç»§ç»­æ­£ç¡®åœ°æä¾›æœåŠ¡äº†ã€‚</p><h2 id="4ã€redis6-2-5-é›†ç¾¤éƒ¨ç½²"><a href="#4ã€redis6-2-5-é›†ç¾¤éƒ¨ç½²" class="headerlink" title="4ã€redis6.2.5 é›†ç¾¤éƒ¨ç½²"></a><strong>4ã€redis6.2.5 é›†ç¾¤éƒ¨ç½²</strong></h2><p><strong>é›†ç¾¤ä¸­è‡³å°‘åº”è¯¥æœ‰å¥‡æ•°ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥è‡³å°‘æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹è‡³å°‘æœ‰ä¸€ä¸ªå¤‡ä»½èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¸‹é¢ä½¿ç”¨6èŠ‚ç‚¹ï¼ˆä¸»èŠ‚ç‚¹ã€å¤‡ä»½èŠ‚ç‚¹ç”±redis-clusteré›†ç¾¤ç¡®å®šï¼‰ã€‚</strong></p><h3 id="4-1-å‡†å¤‡å·¥ä½œ"><a href="#4-1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="4.1 å‡†å¤‡å·¥ä½œ"></a><strong>4.1 å‡†å¤‡å·¥ä½œ</strong></h3><p>   æœ¬æ–‡ä½¿ç”¨ä¸¤å°centOS7ä¸»æœºï¼Œä¸€å°æœºå™¨3ä¸ªèŠ‚ç‚¹ï¼Œåˆ›å»ºå‡º3 masterã€3 salve ç¯å¢ƒï¼Œmasterï¼ˆ192.168.1.8ï¼‰ salve(192.168.1.10) </p><h3 id="4-2-åˆ›å»ºRedisèŠ‚ç‚¹"><a href="#4-2-åˆ›å»ºRedisèŠ‚ç‚¹" class="headerlink" title="4.2 åˆ›å»ºRedisèŠ‚ç‚¹"></a>4.2 åˆ›å»ºRedisèŠ‚ç‚¹</h3><p>é¦–å…ˆåœ¨æŒ‡å®šç›®å½•ä¸‹åˆ›å»º  redis_cluster </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir /software01/redis_cluster<br></code></pre></td></tr></table></figure><p> åœ¨ redis_cluster ç›®å½•ä¸‹ï¼Œåˆ›å»ºåä¸º 6379ã€6380ã€6381çš„ç›®å½•ï¼Œå¹¶å°† redis.conf æ‹·è´åˆ°è¿™å…­ä¸ªç›®å½•ä¸­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> mkdir 6379 6380 6381ã€6382ã€6383ã€6384</span><br><span class="hljs-meta">#</span><span class="bash"> cp redis.conf redis_cluster/6379</span><br><span class="hljs-meta">#</span><span class="bash"> cp redis.conf redis_cluster/6380</span> <br><span class="hljs-meta">#</span><span class="bash"> cp redis.conf redis_cluster/6381</span><br></code></pre></td></tr></table></figure><p> åˆ†åˆ«ä¿®æ”¹è¿™ä¸‰ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹å¦‚ä¸‹å†…å®¹ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">port 6379ã€€ã€€ã€€ã€€ã€€ã€€#ç«¯å£6379 6380 6381ã€6382ã€6383ã€6384 <br>bind æœ¬æœºip ã€€ã€€ã€€ã€€ #é»˜è®¤ipä¸º127.0.0.1 éœ€è¦æ”¹ä¸ºå…¶ä»–èŠ‚ç‚¹æœºå™¨å¯è®¿é—®çš„ip å¦åˆ™åˆ›å»ºé›†ç¾¤æ—¶æ— æ³•è®¿é—®å¯¹åº”çš„ç«¯å£ï¼Œæ— æ³•åˆ›å»ºé›†ç¾¤ <br>daemonize yes ã€€ã€€  #redisåå°è¿è¡Œ <br>pidfile /var/run/redis_6379.pid ã€€ã€€#pidfileæ–‡ä»¶å¯¹åº”6379,6380,6381 <br>cluster-enabled yes ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#å¼€å¯é›†ç¾¤ <br>cluster-config-file nodes_6379.conf #é›†ç¾¤çš„é…ç½® é…ç½®æ–‡ä»¶é¦–æ¬¡å¯åŠ¨è‡ªåŠ¨ç”Ÿæˆ 6379,6380,6381 <br>cluster-node-timeout 15000 ã€€ã€€ã€€ã€€ã€€ã€€#è¯·æ±‚è¶…æ—¶ é»˜è®¤15ç§’ï¼Œå¯è‡ªè¡Œè®¾ç½®  <br>appendonly yes ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#aofæ—¥å¿—å¼€å¯ æœ‰éœ€è¦å°±å¼€å¯ï¼Œå®ƒä¼šæ¯æ¬¡å†™æ“ä½œéƒ½è®°å½•ä¸€æ¡æ—¥å¿—<br></code></pre></td></tr></table></figure><p>æ¥ç€åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šï¼ˆ192.168.1.10ï¼‰ï¼Œçš„æ“ä½œé‡å¤ä»¥ä¸Šä¸‰æ­¥ï¼Œåªæ˜¯æŠŠç›®å½•æ”¹ä¸º6382ã€6383ã€6384ï¼Œå¯¹åº”çš„é…ç½®æ–‡ä»¶ä¹ŸæŒ‰ç…§è¿™ä¸ªè§„åˆ™ä¿®æ”¹å³å¯. </p><h3 id="4-3-å¯åŠ¨å„èŠ‚ç‚¹"><a href="#4-3-å¯åŠ¨å„èŠ‚ç‚¹" class="headerlink" title="4.3 å¯åŠ¨å„èŠ‚ç‚¹"></a>4.3 å¯åŠ¨å„èŠ‚ç‚¹</h3><p> ç¬¬ä¸€å°æœºå™¨ä¸Šæ‰§è¡Œ: </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@centos7 bin]# redis-server /root/software01/redis_cluster/6379/redis.conf <br>[root@centos7 bin]# redis-server /root/software01/redis_cluster/6380/redis.conf <br>[root@centos7 bin]# redis-server /root/software01/redis_cluster/6381/redis.conf <br></code></pre></td></tr></table></figure><p> å¦å¤–ä¸€å°æœºå™¨ä¸Šæ‰§è¡Œ: </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@centos7 bin]# redis-server /root/software01/redis_cluster/6382/redis.conf <br>[root@centos7 bin]# redis-server /root/software01/redis_cluster/6383/redis.conf <br>[root@centos7 bin]# redis-server /root/software01/redis_cluster/6384/redis.conf <br></code></pre></td></tr></table></figure><h3 id="4-4-æ£€æŸ¥-redis-å¯åŠ¨æƒ…å†µ"><a href="#4-4-æ£€æŸ¥-redis-å¯åŠ¨æƒ…å†µ" class="headerlink" title="4.4 æ£€æŸ¥ redis å¯åŠ¨æƒ…å†µ"></a>4.4 æ£€æŸ¥ redis å¯åŠ¨æƒ…å†µ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ps -ef | grep redis //æŸ¥çœ‹rediså¯åŠ¨æƒ…å†µ</span><br></code></pre></td></tr></table></figure><p><img src="/img/work/1633850372740.png"></p><p><img src="/img/work/1633850438157.png"></p><h3 id="4-5-åˆ›å»ºé›†ç¾¤"><a href="#4-5-åˆ›å»ºé›†ç¾¤" class="headerlink" title="4.5 åˆ›å»ºé›†ç¾¤"></a>4.5 åˆ›å»ºé›†ç¾¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@centos7 bin]# ./redis-cli --cluster create 192.168.1.10:6379 192.168.1.10:6380 192.168.1.10:6381 192.168.1.8:6382 192.168.1.8:6383 192.168.1.8:6384 --cluster-replicas 1<br></code></pre></td></tr></table></figure><p> <strong>æ³¨æ„ï¼šRedis Clusteræœ€ä½è¦æ±‚æ˜¯3ä¸ªä¸»èŠ‚ç‚¹ï¼Œå¦‚æœéœ€è¦é›†ç¾¤éœ€è¦è®¤è¯ï¼Œåˆ™åœ¨æœ€ååŠ å…¥ -a xx å³å¯ã€‚</strong> </p><p>ä»¥ä¸Šå‘½ä»¤æ‰§è¡Œå®Œæˆå</p><p><img src="/img/work/1633868265946.png"></p><p>è¾“å…¥yesä¹‹åå°†ä¼šå‡ºç°ä»¥ä¸‹ä¿¡æ¯</p><p><img src="/img/work/1633868317543.png"></p><h3 id="4-6-æµ‹è¯•"><a href="#4-6-æµ‹è¯•" class="headerlink" title="4.6 æµ‹è¯•"></a>4.6 æµ‹è¯•</h3><p> åœ¨ç¬¬ä¸€å°æœºå™¨ä¸Šè¿æ¥é›†ç¾¤çš„6379ç«¯å£çš„èŠ‚ç‚¹ï¼Œåœ¨å¦å¤–ä¸€å°è¿æ¥6382èŠ‚ç‚¹ï¼Œè¿æ¥æ–¹å¼ä¸º  </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli -h 192.168.1.10 -c -p 6379  #-h è¿æ¥ä¸»æœºçš„ip <br>                                      #-cè¿æ¥é›†ç¾¤ç»“ç‚¹æ—¶ä½¿ç”¨ï¼Œæ­¤é€‰é¡¹å¯é˜²æ­¢movedå’Œaskå¼‚å¸¸ <br>                                      #-p ç«¯å£   <br>                                      #-a å¦‚æœè®¾ç½®å¯†ç  å¯åŠ ä¸Š-aè¿›è¡Œå¯†ç éªŒè¯ç™»å½• <br></code></pre></td></tr></table></figure><p>åœ¨6379èŠ‚ç‚¹è®¾ç½®keyå€¼ï¼Œç„¶ååœ¨6382è·å–keyçš„å€¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">åœ¨èŠ‚ç‚¹6379ä¸Šè®¾ç½®å€¼</span><br>192.168.1.10:6379&gt; set k1 v1<br><span class="hljs-meta">-&gt;</span><span class="bash"> Redirected to slot [12706] located at 192.168.1.10:6380</span><br>OK<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">åœ¨6382ä¹Ÿå¯ä»¥è·å–å€¼</span><br>192.168.1.8:6382&gt; get k1<br><span class="hljs-meta">-&gt;</span><span class="bash"> Redirected to slot [12706] located at 192.168.1.10:6380</span><br>&quot;v1&quot;<br></code></pre></td></tr></table></figure><p>ç»“æœåˆ†åˆ«å¦‚ä¸‹ï¼š</p><p><img src="/img/work/1633869331466.png"></p><p><img src="/img/work/1633869348246.png"></p><h2 id="5-Clusteræ¨¡å¼çš„ä¼˜ç¼ºç‚¹"><a href="#5-Clusteræ¨¡å¼çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="5. Clusteræ¨¡å¼çš„ä¼˜ç¼ºç‚¹"></a>5. Clusteræ¨¡å¼çš„ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h3><ol><li>æ— ä¸­å¿ƒæ¶æ„ï¼Œæ•°æ®æŒ‰ç…§slotåˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹ã€‚</li><li>é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„å…³ç³»ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¿å­˜å„è‡ªçš„æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è¿æ¥ï¼Œè€Œä¸”è¿™äº›è¿æ¥ä¿æŒæ´»è·ƒï¼Œè¿™æ ·å°±ä¿è¯äº†æˆ‘ä»¬åªéœ€è¦è¿æ¥é›†ç¾¤ä¸­çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å¯ä»¥è·å–åˆ°å…¶ä»–èŠ‚ç‚¹çš„æ•°æ®ã€‚</li><li>å¯çº¿æ€§æ‰©å±•åˆ°1000å¤šä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹å¯åŠ¨æ€æ·»åŠ æˆ–åˆ é™¤</li><li>èƒ½å¤Ÿå®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ŒèŠ‚ç‚¹ä¹‹é—´é€šè¿‡gossipåè®®äº¤æ¢çŠ¶æ€ä¿¡æ¯ï¼Œç”¨æŠ•ç¥¨æœºåˆ¶å®Œæˆslaveåˆ°masterçš„è§’è‰²è½¬æ¢</li></ol><h3 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h3><ol><li>å®¢æˆ·ç«¯å®ç°å¤æ‚ï¼Œé©±åŠ¨è¦æ±‚å®ç°Smart Clientï¼Œç¼“å­˜slots mappingä¿¡æ¯å¹¶åŠæ—¶æ›´æ–°ï¼Œæé«˜äº†å¼€å‘éš¾åº¦ã€‚ç›®å‰ä»…JedisClusterç›¸å¯¹æˆç†Ÿï¼Œå¼‚å¸¸å¤„ç†è¿˜ä¸å®Œå–„ï¼Œæ¯”å¦‚å¸¸è§çš„â€œmax redirect exceptionâ€</li><li>èŠ‚ç‚¹ä¼šå› ä¸ºæŸäº›åŸå› å‘ç”Ÿé˜»å¡ï¼ˆé˜»å¡æ—¶é—´å¤§äº cluster-node-timeoutï¼‰è¢«åˆ¤æ–­ä¸‹çº¿ï¼Œè¿™ç§failoveræ˜¯æ²¡æœ‰å¿…è¦çš„</li><li>æ•°æ®é€šè¿‡å¼‚æ­¥å¤åˆ¶ï¼Œä¸ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§</li><li>slaveå……å½“â€œå†·å¤‡â€ï¼Œä¸èƒ½ç¼“è§£è¯»å‹åŠ›</li><li>æ‰¹é‡æ“ä½œé™åˆ¶ï¼Œç›®å‰åªæ”¯æŒå…·æœ‰ç›¸åŒslotå€¼çš„keyæ‰§è¡Œæ‰¹é‡æ“ä½œï¼Œå¯¹msetã€mgetã€sunionç­‰æ“ä½œæ”¯æŒä¸å‹å¥½</li><li>keyäº‹åŠ¡æ“ä½œæ”¯æŒæœ‰çº¿ï¼Œåªæ”¯æŒå¤škeyåœ¨åŒä¸€èŠ‚ç‚¹çš„äº‹åŠ¡æ“ä½œï¼Œå¤škeyåˆ†å¸ƒä¸åŒèŠ‚ç‚¹æ—¶æ— æ³•ä½¿ç”¨äº‹åŠ¡åŠŸèƒ½</li><li>ä¸æ”¯æŒå¤šæ•°æ®åº“ç©ºé—´ï¼Œå•æœºrediså¯ä»¥æ”¯æŒ16ä¸ªdbï¼Œé›†ç¾¤æ¨¡å¼ä¸‹åªèƒ½ä½¿ç”¨ä¸€ä¸ªï¼Œå³db 0</li></ol><p> <strong>Redis Clusteræ¨¡å¼ä¸å»ºè®®ä½¿ç”¨pipelineå’Œmulti-keysæ“ä½œï¼Œå‡å°‘max redirectäº§ç”Ÿçš„åœºæ™¯ã€‚</strong> </p><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6. æ€»ç»“"></a>6. æ€»ç»“</h2><p>Redisé›†ç¾¤æ–¹æ¡ˆçš„ä¸‰ç§æ¨¡å¼ï¼Œå…¶ä¸­ä¸»ä»å¤åˆ¶æ¨¡å¼èƒ½å®ç°è¯»å†™åˆ†ç¦»ï¼Œä½†æ˜¯ä¸èƒ½è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼›å“¨å…µæ¨¡å¼åŸºäºä¸»ä»å¤åˆ¶æ¨¡å¼ï¼Œèƒ½å®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Œè¾¾åˆ°é«˜å¯ç”¨ï¼Œä½†ä¸ä¸»ä»å¤åˆ¶æ¨¡å¼ä¸€æ ·ï¼Œä¸èƒ½åœ¨çº¿æ‰©å®¹ï¼Œå®¹é‡å—é™äºå•æœºçš„é…ç½®ï¼›Clusteræ¨¡å¼é€šè¿‡æ— ä¸­å¿ƒåŒ–æ¶æ„ï¼Œå®ç°åˆ†å¸ƒå¼å­˜å‚¨ï¼Œå¯è¿›è¡Œçº¿æ€§æ‰©å±•ï¼Œä¹Ÿèƒ½é«˜å¯ç”¨ï¼Œä½†å¯¹äºåƒæ‰¹é‡æ“ä½œã€äº‹åŠ¡æ“ä½œç­‰çš„æ”¯æŒæ€§ä¸å¤Ÿå¥½ã€‚ä¸‰ç§æ¨¡å¼å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œå¯æ ¹æ®å®é™…åœºæ™¯è¿›è¡Œé€‰æ‹©ã€‚</p><h2 id="é™„ï¼šRedisé›†ç¾¤å„ç§å‚æ•°è®¾ç½®"><a href="#é™„ï¼šRedisé›†ç¾¤å„ç§å‚æ•°è®¾ç½®" class="headerlink" title="é™„ï¼šRedisé›†ç¾¤å„ç§å‚æ•°è®¾ç½®"></a>é™„ï¼šRedisé›†ç¾¤å„ç§å‚æ•°è®¾ç½®</h2><h3 id="1-åˆ›å»ºé›†ç¾¤ä¸»èŠ‚ç‚¹"><a href="#1-åˆ›å»ºé›†ç¾¤ä¸»èŠ‚ç‚¹" class="headerlink" title="1. åˆ›å»ºé›†ç¾¤ä¸»èŠ‚ç‚¹"></a>1. åˆ›å»ºé›†ç¾¤ä¸»èŠ‚ç‚¹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster create 192.168.1.10:6379 192.168.1.10:6380 192.168.1.10:6381<br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºé›†ç¾¤ä¸»ä»èŠ‚ç‚¹"><a href="#2-åˆ›å»ºé›†ç¾¤ä¸»ä»èŠ‚ç‚¹" class="headerlink" title="2. åˆ›å»ºé›†ç¾¤ä¸»ä»èŠ‚ç‚¹"></a>2. åˆ›å»ºé›†ç¾¤ä¸»ä»èŠ‚ç‚¹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">/redis-cli --cluster create 192.168.1.10:6379 192.168.1.10:6380 192.168.1.10:6381 192.168.1.8:6382 192.168.1.8:6383 192.168.1.8:6384 --cluster-replicas 1<br></code></pre></td></tr></table></figure><p> <strong>è¯´æ˜ï¼šâ€“cluster-replicas å‚æ•°ä¸ºæ•°å­—ï¼Œ1è¡¨ç¤ºæ¯ä¸ªä¸»èŠ‚ç‚¹éœ€è¦1ä¸ªä»èŠ‚ç‚¹ã€‚</strong> </p><p>é€šè¿‡è¯¥æ–¹å¼åˆ›å»ºçš„å¸¦æœ‰ä»èŠ‚ç‚¹çš„æœºå™¨ä¸èƒ½å¤Ÿè‡ªå·±æ‰‹åŠ¨æŒ‡å®šä¸»èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦æŒ‡å®šçš„è¯ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨æŒ‡å®šï¼Œå…ˆä½¿ç”¨1æˆ–3åˆ›å»ºå¥½ä¸»èŠ‚ç‚¹åï¼Œå†é€šè¿‡4æ¥å¤„ç†ã€‚ </p><h3 id="3-æ·»åŠ é›†ç¾¤ä¸»èŠ‚ç‚¹"><a href="#3-æ·»åŠ é›†ç¾¤ä¸»èŠ‚ç‚¹" class="headerlink" title="3. æ·»åŠ é›†ç¾¤ä¸»èŠ‚ç‚¹"></a>3. æ·»åŠ é›†ç¾¤ä¸»èŠ‚ç‚¹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster add-node 192.168.1.8:6382 192.168.1.10:6379 <br></code></pre></td></tr></table></figure><p>è¯´æ˜ï¼šä¸ºä¸€ä¸ªæŒ‡å®šé›†ç¾¤æ·»åŠ èŠ‚ç‚¹ï¼Œéœ€è¦å…ˆè¿åˆ°è¯¥é›†ç¾¤çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹IPï¼ˆ192.168.1.10:6379ï¼‰ï¼Œå†æŠŠæ–°èŠ‚ç‚¹åŠ å…¥ã€‚è¯¥2ä¸ªå‚æ•°çš„é¡ºåºæœ‰è¦æ±‚ï¼šæ–°åŠ å…¥çš„èŠ‚ç‚¹æ”¾å‰ </p><h3 id="4-æ·»åŠ é›†ç¾¤ä»èŠ‚ç‚¹"><a href="#4-æ·»åŠ é›†ç¾¤ä»èŠ‚ç‚¹" class="headerlink" title="4. æ·»åŠ é›†ç¾¤ä»èŠ‚ç‚¹"></a>4. æ·»åŠ é›†ç¾¤ä»èŠ‚ç‚¹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster add-node 192.168.1.8:6382 192.168.1.10:6379 --cluster-slave --cluster-master-id 117457eab5071954faab5e81c3170600d5192270<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è¯´æ˜ï¼šæŠŠ6382èŠ‚ç‚¹åŠ å…¥åˆ°6379èŠ‚ç‚¹çš„é›†ç¾¤ä¸­ï¼Œå¹¶ä¸”å½“åšnode_id:17ea90fd81280b5ee7999cbf0313f89206688242çš„ä»èŠ‚ç‚¹ã€‚å¦‚æœä¸æŒ‡å®š --cluster-master-id ä¼šéšæœºåˆ†é…åˆ°ä»»æ„ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚</span><br></code></pre></td></tr></table></figure><h3 id="5-åˆ é™¤èŠ‚ç‚¹"><a href="#5-åˆ é™¤èŠ‚ç‚¹" class="headerlink" title="5. åˆ é™¤èŠ‚ç‚¹"></a>5. åˆ é™¤èŠ‚ç‚¹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster del-node 192.168.1.8:6384 f6a6957421b80409106cb36be3c7ba41f3b603ff<br></code></pre></td></tr></table></figure><p>è¯´æ˜ï¼šæŒ‡å®šIPã€ç«¯å£å’Œnode_id æ¥åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹å¯ä»¥ç›´æ¥åˆ é™¤ï¼Œæœ‰slotåˆ†é…çš„ä¸»èŠ‚ç‚¹ä¸èƒ½ç›´æ¥åˆ é™¤ã€‚</p><p>æ³¨æ„ï¼šå½“è¢«åˆ é™¤æ‰çš„èŠ‚ç‚¹é‡æ–°èµ·æ¥ä¹‹åä¸èƒ½è‡ªåŠ¨åŠ å…¥é›†ç¾¤ï¼Œä½†å…¶å’Œä¸»çš„å¤åˆ¶è¿˜æ˜¯æ­£å¸¸çš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¯¥èŠ‚ç‚¹çœ‹åˆ°é›†ç¾¤ä¿¡æ¯ï¼ˆé€šè¿‡å…¶ä»–æ­£å¸¸èŠ‚ç‚¹å·²ç»çœ‹ä¸åˆ°è¯¥è¢«del-nodeèŠ‚ç‚¹çš„ä¿¡æ¯ï¼‰ã€‚</p><p>å¦‚æœæƒ³è¦å†æ¬¡åŠ å…¥é›†ç¾¤ï¼Œåˆ™éœ€è¦å…ˆåœ¨è¯¥èŠ‚ç‚¹æ‰§è¡Œcluster resetï¼Œå†ç”¨add-nodeè¿›è¡Œæ·»åŠ ï¼Œè¿›è¡Œå¢é‡åŒæ­¥å¤åˆ¶ã€‚</p><h3 id="6-æ£€æŸ¥é›†ç¾¤"><a href="#6-æ£€æŸ¥é›†ç¾¤" class="headerlink" title="6. æ£€æŸ¥é›†ç¾¤"></a>6. æ£€æŸ¥é›†ç¾¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster check 192.168.1.8:6384 --cluster-search-multiple-owners<br></code></pre></td></tr></table></figure><p> è¯´æ˜ï¼šä»»æ„è¿æ¥ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹ï¼Œè¿›è¡Œé›†ç¾¤çŠ¶æ€æ£€æŸ¥ </p><h3 id="7-é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹"><a href="#7-é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹" class="headerlink" title="7. é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹"></a>7. é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster info 192.168.1.8:6384<br></code></pre></td></tr></table></figure><p> è¯´æ˜ï¼šæ£€æŸ¥keyã€slotsã€ä»èŠ‚ç‚¹ä¸ªæ•°çš„åˆ†é…æƒ…å†µ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@centos7 bin]# redis-cli --cluster info 192.168.1.8:6384<br>192.168.1.10:6379 (17ea90fd...) -&gt; 1 keys | 5461 slots | 1 slaves.<br>192.168.1.8:6382 (4a8b3637...) -&gt; 0 keys | 5462 slots | 1 slaves.<br>192.168.1.10:6380 (4c4710e3...) -&gt; 1 keys | 5461 slots | 1 slaves.<br>[OK] 2 keys in 3 masters.<br>0.00 keys per slot on average.<br></code></pre></td></tr></table></figure><h3 id="8-ä¿®å¤é›†ç¾¤"><a href="#8-ä¿®å¤é›†ç¾¤" class="headerlink" title="8. ä¿®å¤é›†ç¾¤"></a>8. ä¿®å¤é›†ç¾¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster fix 192.168.1.8:6384 --cluster-search-multiple-owners<br></code></pre></td></tr></table></figure><p> è¯´æ˜ï¼šä¿®å¤é›†ç¾¤å’Œæ§½çš„é‡å¤åˆ†é…é—®é¢˜ </p><h3 id="9-è®¾ç½®é›†ç¾¤çš„è¶…æ—¶æ—¶é—´"><a href="#9-è®¾ç½®é›†ç¾¤çš„è¶…æ—¶æ—¶é—´" class="headerlink" title="9. è®¾ç½®é›†ç¾¤çš„è¶…æ—¶æ—¶é—´"></a>9. è®¾ç½®é›†ç¾¤çš„è¶…æ—¶æ—¶é—´</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster set-timeout 192.168.1.8:6382 10000<br></code></pre></td></tr></table></figure><p> è¯´æ˜ï¼šè¿æ¥åˆ°é›†ç¾¤çš„ä»»æ„ä¸€èŠ‚ç‚¹æ¥è®¾ç½®é›†ç¾¤çš„è¶…æ—¶æ—¶é—´å‚æ•°cluster-node-timeout </p><h3 id="10-é›†ç¾¤ä¸­æ‰§è¡Œç›¸å…³å‘½ä»¤"><a href="#10-é›†ç¾¤ä¸­æ‰§è¡Œç›¸å…³å‘½ä»¤" class="headerlink" title="10. é›†ç¾¤ä¸­æ‰§è¡Œç›¸å…³å‘½ä»¤"></a>10. é›†ç¾¤ä¸­æ‰§è¡Œç›¸å…³å‘½ä»¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster call 192.168.1.10:6381 config set requirepass cc<br>redis-cli -a cc --cluster call 192.168.1.10:6381 config set masterauth cc<br>redis-cli -a cc --cluster call 192.168.1.10 config rewrite<br></code></pre></td></tr></table></figure><p> è¯´æ˜ï¼šè¿æ¥åˆ°é›†ç¾¤çš„ä»»æ„ä¸€èŠ‚ç‚¹æ¥å¯¹æ•´ä¸ªé›†ç¾¤çš„æ‰€æœ‰èŠ‚ç‚¹è¿›è¡Œè®¾ç½®ã€‚ </p><p>åˆ°æ­¤ï¼Œç›¸å…³é›†ç¾¤çš„åŸºæœ¬æ“ä½œå·²ç»ä»‹ç»å®Œï¼Œç°åœ¨è¯´æ˜é›†ç¾¤è¿ç§»çš„ç›¸å…³æ“ä½œã€‚</p><p>Redis 6.0 æ–°å¢äº†å‡ ä¸ªå‘½ä»¤ï¼š</p><p>1ï¼Œfix çš„å­å‘½ä»¤ï¼šâ€“cluster-fix-with-unreachable-masters</p><p>2ï¼Œcallçš„å­å‘½ä»¤ï¼šâ€“cluster-only-mastersã€â€“cluster-only-replicas</p><p>3ï¼Œé›†ç¾¤èŠ‚ç‚¹å¤‡ä»½ï¼šbackup</p><h2 id="è¿ç§»ç›¸å…³"><a href="#è¿ç§»ç›¸å…³" class="headerlink" title="è¿ç§»ç›¸å…³"></a>è¿ç§»ç›¸å…³</h2><h3 id="åœ¨çº¿è¿ç§»slot-ï¼š"><a href="#åœ¨çº¿è¿ç§»slot-ï¼š" class="headerlink" title="åœ¨çº¿è¿ç§»slot ï¼š"></a><strong>åœ¨çº¿è¿ç§»slot</strong> ï¼š</h3><p>â€‹       åœ¨çº¿æŠŠé›†ç¾¤çš„ä¸€äº›slotä»é›†ç¾¤åŸæ¥slotèŠ‚ç‚¹è¿ç§»åˆ°æ–°çš„èŠ‚ç‚¹ï¼Œå³å¯ä»¥å®Œæˆé›†ç¾¤çš„åœ¨çº¿æ¨ªå‘æ‰©å®¹å’Œç¼©å®¹ã€‚æœ‰2ç§æ–¹å¼è¿›è¡Œè¿ç§»</p><p>ä¸€ã€æ˜¯æ ¹æ®æç¤ºæ¥è¿›è¡Œæ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">ç›´æ¥è¿æ¥åˆ°é›†ç¾¤çš„ä»»æ„ä¸€èŠ‚ç‚¹</span><br>redis-cli -a cc --cluster reshard 192.168.1.10:6379<br></code></pre></td></tr></table></figure><p>â€‹       äºŒã€æ˜¯æ ¹æ®å‚æ•°è¿›è¡Œæ“ä½œï¼š </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli -a cc --cluster reshard 192.168.1.10:6379 --cluster-from 117457eab5071954faab5e81c3170600d5192270 --cluster-to 815da8448f5d5a304df0353ca10d8f9b77016b28 --cluster-slots 10 --cluster-yes --cluster-timeout 5000 --cluster-pipeline 10 --cluster-replace<br></code></pre></td></tr></table></figure><p>â€‹       è¯´æ˜ï¼šè¿æ¥åˆ°é›†ç¾¤çš„ä»»æ„ä¸€èŠ‚ç‚¹æ¥å¯¹æŒ‡å®šèŠ‚ç‚¹æŒ‡å®šæ•°é‡çš„slotè¿›è¡Œè¿ç§»åˆ°æŒ‡å®šçš„èŠ‚ç‚¹ã€‚  </p><h3 id="å¹³è¡¡ï¼ˆrebalanceï¼‰slot-ï¼š"><a href="#å¹³è¡¡ï¼ˆrebalanceï¼‰slot-ï¼š" class="headerlink" title="å¹³è¡¡ï¼ˆrebalanceï¼‰slot ï¼š"></a>å¹³è¡¡ï¼ˆrebalanceï¼‰<strong>slot</strong> ï¼š</h3><p>1ï¼‰  å¹³è¡¡é›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹çš„slotæ•°é‡ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli -a cc --cluster rebalance 192.168.163.132:6379<br></code></pre></td></tr></table></figure><p>2ï¼‰æ ¹æ®é›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹è®¾ç½®çš„æƒé‡ç­‰å¹³è¡¡slotæ•°é‡ï¼ˆä¸æ‰§è¡Œï¼Œåªæ¨¡æ‹Ÿï¼‰ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli -a cc --cluster rebalance --cluster-weight 117457eab5071954faab5e81c3170600d5192270=5 815da8448f5d5a304df0353ca10d8f9b77016b28=4 56005b9413cbf225783906307a2631109e753f8f=3 --cluster-simulate 192.168.1.10:6379<br></code></pre></td></tr></table></figure><ol start="3"><li> å¯¼å…¥é›†ç¾¤ </li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli --cluster import 192.168.1.10:6379 --cluster-from 192.168.1.10:9021 --cluster-replace<br></code></pre></td></tr></table></figure><p> è¯´æ˜ï¼šå¤–éƒ¨Rediså®ä¾‹ï¼ˆ9021ï¼‰å¯¼å…¥åˆ°é›†ç¾¤ä¸­çš„ä»»æ„ä¸€èŠ‚ç‚¹ã€‚ </p><p> æ³¨æ„ï¼šæµ‹è¯•ä¸‹æ¥å‘ç°å‚æ•°â€“cluster-replaceæ²¡æœ‰ç”¨ï¼Œå¦‚æœé›†ç¾¤ä¸­å·²ç»åŒ…å«äº†æŸä¸ªkeyï¼Œåœ¨å¯¼å…¥çš„æ—¶å€™ä¼šå¤±è´¥ï¼Œä¸ä¼šè¦†ç›–ï¼Œåªæœ‰æ¸…ç©ºé›†ç¾¤keyæ‰èƒ½å¯¼å…¥ã€‚ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">*** Importing 97847 keys from DB 0<br>Migrating 9223372011174675807 to 192.168.1.10:6381: Source 192.168.1.10:9021 replied with error:<br>ERR Target instance replied with error: BUSYKEY Target key name already exists<br></code></pre></td></tr></table></figure><p> å¹¶ä¸”å‘ç°å¦‚æœé›†ç¾¤è®¾ç½®äº†å¯†ç ï¼Œä¹Ÿä¼šå¯¼å…¥å¤±è´¥ï¼Œéœ€è¦è®¾ç½®é›†ç¾¤å¯†ç ä¸ºç©ºæ‰èƒ½è¿›è¡Œå¯¼å…¥ï¼ˆcallï¼‰ã€‚é€šè¿‡monitorï¼ˆ9021ï¼‰çš„æ—¶å€™å‘ç°ï¼Œåœ¨migrateçš„æ—¶å€™éœ€è¦å¯†ç è¿›è¡Œauthè®¤è¯ </p><p><strong>Redis Cluster é€šè¿‡redis-cli â€“clusteræ¥åˆ›å»ºå’Œç®¡ç†é›†ç¾¤çš„æ–¹å¼å’Œ redis-trib.rbè„šæœ¬ç»å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯¹äºæ¯”è¾ƒç†Ÿæ‚‰ redis-trib.rb è„šæœ¬çš„ï¼Œä½¿ç”¨â€“clusterä¹Ÿéå¸¸é¡ºæ‰‹ã€‚</strong> </p><p>å‚è€ƒï¼š</p><hr><p><a href="https://www.cnblogs.com/zhoujinyi/p/11606935.html">https://www.cnblogs.com/zhoujinyi/p/11606935.html</a></p><p><a href="https://www.cnblogs.com/saneri/p/12409173.html">https://www.cnblogs.com/saneri/p/12409173.html</a></p><p>åŠè·¯é›¨æ­Œé“¾æ¥ï¼š<a href="https://juejin.cn/post/6844904097116585991">https://juejin.cn/post/6844904097116585991</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisä¸‰ç§é›†ç¾¤æ¨¡å¼ä¹‹å“¨å…µæ¨¡å¼</title>
    <link href="/2021/10/06/redis%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F/"/>
    <url>/2021/10/06/redis%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h3><p> ä¸»ä»åˆ‡æ¢æŠ€æœ¯çš„æ–¹æ³•æ˜¯ï¼šå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°ä»æœåŠ¡å™¨åˆ‡æ¢ä¸ºä¸»æœåŠ¡å™¨ï¼Œè¿™å°±éœ€è¦äººå·¥ å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘ å“¨å…µæ¨¡å¼ã€‚Redisä»2.8å¼€å§‹æ­£å¼æä¾›äº†Sentinelï¼ˆå“¨å…µï¼‰ æ¶æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ ã€‚</p><p>å“¨å…µæ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼ï¼Œé¦–å…ˆRedisæä¾›äº†å“¨å…µçš„å‘½ä»¤ï¼Œå“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½œä¸ºè¿›ç¨‹ï¼Œå®ƒä¼šç‹¬ ç«‹è¿è¡Œã€‚å…¶åŸç†æ˜¯<strong>å“¨å…µé€šè¿‡å‘é€å‘½ä»¤ï¼Œç­‰å¾…RedisæœåŠ¡å™¨å“åº”ï¼Œä»è€Œç›‘æ§è¿è¡Œçš„å¤šä¸ªRediså®ä¾‹</strong> </p><p><img src="/img/work/1633534256141.png"></p><p> è¿™é‡Œçš„å“¨å…µæœ‰ä¸¤ä¸ªä½œç”¨:</p><ul><li> é€šè¿‡å‘é€å‘½ä»¤ï¼Œè®©RedisæœåŠ¡å™¨è¿”å›ç›‘æ§å…¶è¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨ </li><li> å½“å“¨å…µç›‘æµ‹åˆ°masterå®•æœºï¼Œä¼šè‡ªåŠ¨å°†slaveåˆ‡æ¢æˆmasterï¼Œç„¶åé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼é€šçŸ¥å…¶ä»–çš„ä»æœ åŠ¡å™¨ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®©å®ƒä»¬åˆ‡æ¢ä¸»æœº </li></ul><p> ç„¶è€Œä¸€ä¸ªå“¨å…µè¿›ç¨‹å¯¹RedisæœåŠ¡å™¨è¿›è¡Œç›‘æ§ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªå“¨å…µè¿›è¡Œç›‘æ§ã€‚ å„ä¸ªå“¨å…µä¹‹é—´è¿˜ä¼šè¿›è¡Œç›‘æ§ï¼Œè¿™æ ·å°±å½¢æˆäº†å¤šå“¨å…µæ¨¡å¼ã€‚ </p><p><img src="/img/work/1633534636100.png"> </p><h3 id="2-å·¥ä½œåŸç†"><a href="#2-å·¥ä½œåŸç†" class="headerlink" title="2.å·¥ä½œåŸç†"></a>2.å·¥ä½œåŸç†</h3><ol><li>é¦–å…ˆä¸»èŠ‚ç‚¹çš„ä¿¡æ¯æ˜¯é…ç½®åœ¨å“¨å…µ(Sentinel)çš„é…ç½®æ–‡ä»¶ä¸­</li><li>å“¨å…µèŠ‚ç‚¹ä¼šå’Œé…ç½®çš„ä¸»èŠ‚ç‚¹å»ºç«‹èµ·ä¸¤æ¡è¿æ¥<code>å‘½ä»¤è¿æ¥</code>å’Œ<code>è®¢é˜…è¿æ¥</code></li><li>å“¨å…µä¼šé€šè¿‡<code>å‘½ä»¤è¿æ¥</code>æ¯10så‘é€ä¸€æ¬¡<code>INFO</code>å‘½ä»¤ï¼Œé€šè¿‡<code>INFOå‘½ä»¤</code>ï¼Œä¸»èŠ‚ç‚¹ä¼šè¿”å›è‡ªå·±çš„run_idå’Œè‡ªå·±çš„<code>ä»èŠ‚ç‚¹ä¿¡æ¯</code></li><li>å“¨å…µä¼šå¯¹è¿™äº›ä»èŠ‚ç‚¹ä¹Ÿå»ºç«‹ä¸¤æ¡è¿æ¥<code>å‘½ä»¤è¿æ¥</code>å’Œ<code>è®¢é˜…è¿æ¥</code></li><li>å“¨å…µé€šè¿‡<code>å‘½ä»¤è¿æ¥</code>å‘ä»èŠ‚ç‚¹å‘é€<code>INFO</code>å‘½ä»¤ï¼Œè·å–åˆ°ä»–çš„ä¸€äº›ä¿¡æ¯<br>a. run_id<br>b. role<br>c. ä»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡ offsetç­‰</li><li>å› ä¸ºå“¨å…µå¯¹ä¸é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹(ä¸»ä»èŠ‚ç‚¹)å½“å‰éƒ½æœ‰ä¸¤æ¡è¿æ¥ï¼Œ<code>å‘½ä»¤è¿æ¥</code>å’Œ<code>è®¢é˜…è¿æ¥</code><br> a. é€šè¿‡<code>å‘½ä»¤è¿æ¥</code>å‘æœåŠ¡å™¨çš„<code>_sentinel:hello</code>é¢‘é“å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œå†…å®¹åŒ…æ‹¬è‡ªå·±çš„ipç«¯å£ã€run_idã€é…ç½®çºªå…ƒ(åç»­æŠ•ç¥¨çš„æ—¶å€™ä¼šç”¨åˆ°)ç­‰<br> b. é€šè¿‡<code>è®¢é˜…è¿æ¥</code>å¯¹æœåŠ¡å™¨çš„<code>_sentinel:hello</code>é¢‘é“åšäº†ç›‘å¬ï¼Œæ‰€ä»¥æ‰€æœ‰çš„å‘è¯¥é¢‘é“å‘é€çš„å“¨å…µçš„æ¶ˆæ¯éƒ½èƒ½è¢«æ¥å—åˆ°<br> c. è§£æç›‘å¬åˆ°çš„æ¶ˆæ¯ï¼Œè¿›è¡Œåˆ†ææå–ï¼Œå°±å¯ä»¥çŸ¥é“è¿˜æœ‰é‚£äº›åˆ«çš„å“¨å…µæœåŠ¡èŠ‚ç‚¹ä¹Ÿåœ¨ç›‘å¬è¿™äº›ä¸»ä»èŠ‚ç‚¹äº†ï¼Œæ›´æ–°ç»“æ„ä½“å°†è¿™äº›å“¨å…µèŠ‚ç‚¹è®°å½•ä¸‹æ¥<br> d. å‘è§‚å¯Ÿåˆ°çš„å…¶ä»–çš„å“¨å…µèŠ‚ç‚¹å»ºç«‹<code>å‘½ä»¤è¿æ¥</code>â€”-æ²¡æœ‰<code>è®¢é˜…è¿æ¥</code></li></ol><h3 id="3-å“¨å…µæ¨¡å¼ä¸‹çš„æ•…éšœè¿ç§»"><a href="#3-å“¨å…µæ¨¡å¼ä¸‹çš„æ•…éšœè¿ç§»" class="headerlink" title="3.å“¨å…µæ¨¡å¼ä¸‹çš„æ•…éšœè¿ç§»"></a>3.å“¨å…µæ¨¡å¼ä¸‹çš„æ•…éšœè¿ç§»</h3><h4 id="3-2ä¸»è§‚ä¸‹çº¿"><a href="#3-2ä¸»è§‚ä¸‹çº¿" class="headerlink" title="3.2ä¸»è§‚ä¸‹çº¿"></a><strong>3.2ä¸»è§‚ä¸‹çº¿</strong></h4><p>å“¨å…µ(Sentinel)èŠ‚ç‚¹ä¼šæ¯ç§’ä¸€æ¬¡çš„é¢‘ç‡å‘å»ºç«‹äº†å‘½ä»¤è¿æ¥çš„å®ä¾‹å‘é€PINGå‘½ä»¤ï¼Œå¦‚æœåœ¨<code>down-after-milliseconds</code>æ¯«ç§’å†…æ²¡æœ‰åšå‡ºæœ‰æ•ˆå“åº”åŒ…æ‹¬(PONG/LOADING/MASTERDOWN)ä»¥å¤–çš„å“åº”ï¼Œå“¨å…µå°±ä¼šå°†è¯¥å®ä¾‹åœ¨æœ¬ç»“æ„ä½“ä¸­çš„çŠ¶æ€æ ‡è®°ä¸º<code>SRI_S_DOWN</code>ä¸»è§‚ä¸‹çº¿</p><h4 id="3-3å®¢è§‚ä¸‹çº¿"><a href="#3-3å®¢è§‚ä¸‹çº¿" class="headerlink" title="3.3å®¢è§‚ä¸‹çº¿"></a><strong>3.3å®¢è§‚ä¸‹çº¿</strong></h4><p>å½“ä¸€ä¸ªå“¨å…µèŠ‚ç‚¹å‘ç°ä¸»èŠ‚ç‚¹å¤„äºä¸»è§‚ä¸‹çº¿çŠ¶æ€æ˜¯ï¼Œä¼šå‘å…¶ä»–çš„å“¨å…µèŠ‚ç‚¹å‘å‡ºè¯¢é—®ï¼Œè¯¥èŠ‚ç‚¹æ˜¯ä¸æ˜¯å·²ç»ä¸»è§‚ä¸‹çº¿äº†ã€‚å¦‚æœè¶…è¿‡é…ç½®å‚æ•°<code>quorum</code>ä¸ªèŠ‚ç‚¹è®¤ä¸ºæ˜¯ä¸»è§‚ä¸‹çº¿æ—¶ï¼Œè¯¥å“¨å…µèŠ‚ç‚¹å°±ä¼šå°†è‡ªå·±ç»´æŠ¤çš„ç»“æ„ä½“ä¸­è¯¥ä¸»èŠ‚ç‚¹æ ‡è®°ä¸º<code>SRI_O_DOWN</code>å®¢è§‚ä¸‹çº¿<br> è¯¢é—®å‘½ä»¤<code>SENTINEL is-master-down-by-addr    </code></p><p><img src="/img/work/1633535070130.png"></p><h4 id="3-4-leaderé€‰ä¸¾"><a href="#3-4-leaderé€‰ä¸¾" class="headerlink" title="3.4 leaderé€‰ä¸¾"></a>3.4 <strong>leaderé€‰ä¸¾</strong></h4><p>åœ¨è®¤ä¸ºä¸»èŠ‚ç‚¹<code>å®¢è§‚ä¸‹çº¿</code>çš„æƒ…å†µä¸‹,å“¨å…µèŠ‚ç‚¹é—´ä¼šå‘èµ·ä¸€æ¬¡é€‰ä¸¾ï¼Œå‘½ä»¤è¿˜æ˜¯ä¸Šé¢çš„å‘½ä»¤<code>SENTINEL is-master-down-by-addr    </code>,åªæ˜¯<code>run_id</code>è¿™æ¬¡ä¼šå°†<code>è‡ªå·±çš„run_id</code>å¸¦è¿›å»ï¼Œå¸Œæœ›æ¥å—è€…å°†è‡ªå·±è®¾ç½®ä¸ºä¸»èŠ‚ç‚¹ã€‚å¦‚æœè¶…è¿‡åŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹è¿”å›å°†è¯¥èŠ‚ç‚¹æ ‡è®°ä¸ºleaderçš„æƒ…å†µä¸‹ï¼Œä¼šæœ‰è¯¥leaderå¯¹æ•…éšœè¿›è¡Œè¿ç§»</p><h4 id="3-5æ•…éšœè¿ç§»"><a href="#3-5æ•…éšœè¿ç§»" class="headerlink" title="3.5æ•…éšœè¿ç§»"></a><strong>3.5æ•…éšœè¿ç§»</strong></h4><ol><li>åœ¨ä»èŠ‚ç‚¹ä¸­æŒ‘é€‰å‡ºæ–°çš„ä¸»èŠ‚ç‚¹<br> a. é€šè®¯æ­£å¸¸<br> b. ä¼˜å…ˆçº§æ’åº<br> c. ä¼˜å…ˆçº§ç›¸åŒæ˜¯é€‰æ‹©offsetæœ€å¤§çš„</li><li>å°†è¯¥èŠ‚ç‚¹è®¾ç½®æˆæ–°çš„ä¸»èŠ‚ç‚¹ <code>SLAVEOF no one</code>,å¹¶ç¡®ä¿åœ¨åç»­çš„INGOå‘½ä»¤æ—¶ï¼Œè¯¥èŠ‚ç‚¹è¿”å›çŠ¶æ€ä¸ºmaster</li><li>å°†å…¶ä»–çš„ä»èŠ‚ç‚¹è®¾ç½®æˆä»æ–°çš„ä¸»èŠ‚ç‚¹å¤åˆ¶, <code>SLAVEOFå‘½ä»¤</code> </li><li>å°†æ—§çš„ä¸»èŠ‚ç‚¹å˜æˆæ–°çš„ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹</li></ol><h3 id="4-éƒ¨ç½²ç¤ºä¾‹"><a href="#4-éƒ¨ç½²ç¤ºä¾‹" class="headerlink" title="4.éƒ¨ç½²ç¤ºä¾‹"></a>4.éƒ¨ç½²ç¤ºä¾‹</h3><p> å“¨å…µæ¨¡å¼åŸºäºå‰æ–‡çš„ä¸»ä»å¤åˆ¶æ¨¡å¼ã€‚å½“å‰ç¤ºä¾‹ä¸ºä¸€ä¸»äºŒä»æ¨¡å¼</p><p>4.1é¦–å…ˆåœ¨reidsè§£å‹åçš„æ–‡ä»¶ä¸­å°†sentinel.confæ–‡ä»¶å¤åˆ¶åˆ°redis.confæ–‡ä»¶çš„ç›®å½•ä¸‹</p><p><img src="/img/work/1633536145531.png"></p><p>4.2åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> mymasterå®šä¹‰ä¸€ä¸ªmasteræ•°æ®åº“çš„åç§°ï¼Œåé¢æ˜¯masterçš„ipï¼Œ portï¼Œ1è¡¨ç¤ºè‡³å°‘éœ€è¦ä¸€ä¸ªSentinelè¿›ç¨‹åŒæ„æ‰èƒ½å°†masteråˆ¤æ–­ä¸ºå¤±æ•ˆï¼Œå¦‚æœä¸æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œåˆ™è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆfailoverï¼‰ä¸ä¼šæ‰§è¡Œ</span><br>sentinel monitor mymaster 127.0.0.1 6379 1 <br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> masterçš„å¯†ç </span><br>sentinel auth-pass mymaster 123456 <br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> 5sæœªå›å¤PINGï¼Œåˆ™è®¤ä¸ºmasterä¸»è§‚ä¸‹çº¿ï¼Œé»˜è®¤ä¸º30s</span><br>sentinel down-after-milliseconds mymaster 5000 <br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æŒ‡å®šåœ¨æ‰§è¡Œæ•…éšœè½¬ç§»æ—¶ï¼Œæœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveå®ä¾‹åœ¨åŒæ­¥æ–°çš„masterå®ä¾‹ï¼Œåœ¨slaveå®ä¾‹è¾ƒå¤šçš„æƒ…å†µä¸‹è¿™ä¸ªæ•°å­—è¶Šå°ï¼ŒåŒæ­¥çš„æ—¶é—´è¶Šé•¿ï¼Œå®Œæˆæ•…éšœè½¬ç§»æ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿</span><br>sentinel parallel-syncs mymaster 2  <br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> å¦‚æœåœ¨è¯¥æ—¶é—´ï¼ˆmsï¼‰å†…æœªèƒ½å®Œæˆæ•…éšœè½¬ç§»æ“ä½œï¼Œåˆ™è®¤ä¸ºæ•…éšœè½¬ç§»å¤±è´¥ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦æ ¹æ®æ•°æ®é‡è®¾ç½®è¯¥å€¼</span><br>sentinel failover-timeout mymaster 300000 <br></code></pre></td></tr></table></figure><p> <strong>ä¸€ä¸ªå“¨å…µå¯ä»¥ç›‘æ§å¤šä¸ªmasteræ•°æ®åº“ï¼Œåªéœ€æŒ‰ä¸Šè¿°é…ç½®æ·»åŠ å¤šå¥—</strong> </p><p>4.3 åˆ†åˆ«ä»¥26379,36379,46379ç«¯å£å¯åŠ¨ä¸‰ä¸ªsentinel </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@centos7 bin]# redis-sentinel etc/sentinel1.conf <br>[root@centos7 bin]# redis-sentinel etc/sentinel2.conf <br>[root@centos7 bin]# redis-sentinel etc/sentinel3.conf <br></code></pre></td></tr></table></figure><p>4.4æµ‹è¯•MasteræŒ‚æ‰åœºæ™¯</p><p><img src="/img/work/1633537126366.png"></p><p> æ‰§è¡Œ <code>kill -9 4965</code> å°†masterè¿›ç¨‹å¹²æ‰ï¼Œè¿›å…¥slaveä¸­æ‰§è¡Œ <code>info replication</code>æŸ¥çœ‹ </p><p><strong>å“¨å…µæœåŠ¡è¾“å‡ºä¿¡æ¯</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">12292:X 07 Oct 2021 18:56:28.858 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.<br>12292:X 07 Oct 2021 18:56:28.858 # Sentinel ID is 0d12a3731fac0690b3cf55d7a424b8a5c0bb2889<br>12292:X 07 Oct 2021 18:56:28.858 # +monitor master mymaster 127.0.0.1 6380 quorum 1<br>12292:X 07 Oct 2021 18:56:38.924 * +convert-to-slave slave 127.0.0.1:6379 127.0.0.1 6379 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 18:59:29.468 * +fix-slave-config slave 127.0.0.1:6381 127.0.0.1 6381 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:01:59.021 # +sdown master mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:01:59.021 # +odown master mymaster 127.0.0.1 6380 #quorum 1/1<br>12292:X 07 Oct 2021 19:01:59.021 # +new-epoch 2<br>12292:X 07 Oct 2021 19:01:59.021 # +try-failover master mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:01:59.023 # +vote-for-leader 0d12a3731fac0690b3cf55d7a424b8a5c0bb2889 2<br>12292:X 07 Oct 2021 19:01:59.023 # +elected-leader master mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:01:59.023 # +failover-state-select-slave master mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:01:59.078 # +selected-slave slave 127.0.0.1:6379 127.0.0.1 6379 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:01:59.078 * +failover-state-send-slaveof-noone slave 127.0.0.1:6379 127.0.0.1 6379 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:01:59.140 * +failover-state-wait-promotion slave 127.0.0.1:6379 127.0.0.1 6379 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:02:00.090 # +promoted-slave slave 127.0.0.1:6379 127.0.0.1 6379 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:02:00.090 # +failover-state-reconf-slaves master mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:02:00.157 * +slave-reconf-sent slave 127.0.0.1:6381 127.0.0.1 6381 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:02:01.134 * +slave-reconf-inprog slave 127.0.0.1:6381 127.0.0.1 6381 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:02:01.134 * +slave-reconf-done slave 127.0.0.1:6381 127.0.0.1 6381 @ mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:02:01.220 # +failover-end master mymaster 127.0.0.1 6380<br>12292:X 07 Oct 2021 19:02:01.220 # +switch-master mymaster 127.0.0.1 6380 127.0.0.1 6379<br>12292:X 07 Oct 2021 19:02:01.221 * +slave slave 127.0.0.1:6381 127.0.0.1 6381 @ mymaster 127.0.0.1 6379<br>12292:X 07 Oct 2021 19:02:01.221 * +slave slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 127.0.0.1 6379<br>12292:X 07 Oct 2021 19:02:06.230 # +sdown slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 127.0.0.1 6379<br></code></pre></td></tr></table></figure><p>ä»ä»¥ä¸Šä¿¡æ¯ï¼Œå¯ä»¥çœ‹å‡º6380çš„masterå·²ç»è¢«ç§»é™¤ï¼Œé€‰ä¸¾å‡ºäº†6379ä¸ºmasterã€‚</p><p><strong>å¦‚æœå½“æˆ‘ä»¬å†æ¬¡å¯åŠ¨6380æœåŠ¡ï¼Œå·²ç»å˜ä¸ºä»èŠ‚ç‚¹</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6380&gt; info replication<br><span class="hljs-meta">#</span><span class="bash"> Replication</span><br>role:slave #ä»èŠ‚ç‚¹è§’è‰²<br>master_host:127.0.0.1<br>master_port:6379<br></code></pre></td></tr></table></figure><h3 id="5-ä¼˜ç¼ºç‚¹"><a href="#5-ä¼˜ç¼ºç‚¹" class="headerlink" title="5.ä¼˜ç¼ºç‚¹"></a>5.ä¼˜ç¼ºç‚¹</h3><h4 id="5-1ä¼˜ç‚¹"><a href="#5-1ä¼˜ç‚¹" class="headerlink" title="5.1ä¼˜ç‚¹"></a>5.1ä¼˜ç‚¹</h4><ol><li> å“¨å…µé›†ç¾¤ï¼ŒåŸºäºä¸»ä»å¤åˆ¶æ¨¡å¼ï¼Œæ‰€æœ‰çš„ä¸»ä»é…ç½®ä¼˜ç‚¹ï¼Œå®ƒå…¨æœ‰ </li><li> ä¸»ä»å¯ä»¥åˆ‡æ¢ï¼Œæ•…éšœå¯ä»¥è½¬ç§»ï¼Œç³»ç»Ÿçš„å¯ç”¨æ€§å°±ä¼šæ›´å¥½ </li><li> å“¨å…µæ¨¡å¼å°±æ˜¯ä¸»ä»æ¨¡å¼çš„å‡çº§ï¼Œæ‰‹åŠ¨åˆ°è‡ªåŠ¨ï¼Œæ›´åŠ å¥å£®ï¼ </li></ol><h4 id="5-2ç¼ºç‚¹"><a href="#5-2ç¼ºç‚¹" class="headerlink" title="5.2ç¼ºç‚¹"></a>5.2ç¼ºç‚¹</h4><ol><li>åŒæ ·ä¹Ÿç»§æ‰¿äº†ä¸»ä»æ¨¡å¼éš¾ä»¥åœ¨çº¿æ‰©å®¹çš„ç¼ºç‚¹ï¼ŒRedisçš„å®¹é‡å—é™äºå•æœºé…ç½®</li><li>éœ€è¦é¢å¤–çš„èµ„æºæ¥å¯åŠ¨sentinelè¿›ç¨‹ï¼Œå®ç°ç›¸å¯¹å¤æ‚ä¸€ç‚¹ï¼ŒåŒæ—¶slaveèŠ‚ç‚¹ä½œä¸ºå¤‡ä»½èŠ‚ç‚¹ä¸æä¾›æœåŠ¡</li></ol><h3 id="6-å“¨å…µæ¨¡å¼å…¨éƒ¨é…ç½®"><a href="#6-å“¨å…µæ¨¡å¼å…¨éƒ¨é…ç½®" class="headerlink" title="6.å“¨å…µæ¨¡å¼å…¨éƒ¨é…ç½®"></a>6.å“¨å…µæ¨¡å¼å…¨éƒ¨é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Example sentinel.conf</span><br><span class="hljs-meta">#</span><span class="bash"> å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£ é»˜è®¤26379</span><br>port 26379<br><span class="hljs-meta">#</span><span class="bash"> å“¨å…µsentinelçš„å·¥ä½œç›®å½•</span><br>dir /tmp<br><span class="hljs-meta">#</span><span class="bash"> å“¨å…µsentinelç›‘æ§çš„redisä¸»èŠ‚ç‚¹çš„ ip port</span><br><span class="hljs-meta">#</span><span class="bash"> master-name å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­— åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9 ã€è¿™ä¸‰ä¸ªå­—ç¬¦<span class="hljs-string">&quot;.-_&quot;</span>ç»„æˆã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> quorum é…ç½®å¤šå°‘ä¸ªsentinelå“¨å…µç»Ÿä¸€è®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è” é‚£ä¹ˆè¿™æ—¶å®¢è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹å¤±è”äº†</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;</span><br>sentinel monitor mymaster 127.0.0.1 6379 1<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass foobared æˆæƒå¯†ç  è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„å®¢æˆ·ç«¯éƒ½è¦æä¾›å¯†ç </span><br><span class="hljs-meta">#</span><span class="bash"> è®¾ç½®å“¨å…µsentinel è¿æ¥ä¸»ä»çš„å¯†ç  æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç </span><br><span class="hljs-meta">#</span><span class="bash"> sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</span><br>sentinel auth-pass mymaster MySUPER--secret-0123passw0rd<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel æ­¤æ—¶ å“¨å…µä¸»è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹ä¸‹çº¿ é»˜è®¤30ç§’</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</span><br>sentinel down-after-milliseconds mymaster 30000<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„masterè¿›è¡Œ åŒæ­¥ï¼Œè¿™ä¸ªæ•°å­—è¶Šå°ï¼Œå®Œæˆfailoveræ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªæ•°å­—è¶Šå¤§ï¼Œå°±æ„å‘³ç€è¶Š å¤šçš„slaveå› ä¸ºreplicationè€Œä¸å¯ç”¨ã€‚å¯ä»¥é€šè¿‡å°†è¿™ä¸ªå€¼è®¾ä¸º 1 æ¥ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªslave å¤„äºä¸èƒ½å¤„ç†å‘½ä»¤è¯·æ±‚çš„çŠ¶æ€ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel parallel-syncs &lt;master-name&gt; &lt;numslaves&gt;</span><br>sentinel parallel-syncs mymaster 1<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ failover-timeout å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š</span><br><span class="hljs-meta">#</span><span class="bash">1. åŒä¸€ä¸ªsentinelå¯¹åŒä¸€ä¸ªmasterä¸¤æ¬¡failoverä¹‹é—´çš„é—´éš”æ—¶é—´ã€‚</span><br><span class="hljs-meta">#</span><span class="bash">2. å½“ä¸€ä¸ªslaveä»ä¸€ä¸ªé”™è¯¯çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®å¼€å§‹è®¡ç®—æ—¶é—´ã€‚ç›´åˆ°slaveè¢«çº æ­£ä¸ºå‘æ­£ç¡®çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®æ—¶ã€‚</span><br><span class="hljs-meta">#</span><span class="bash">3.å½“æƒ³è¦å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„failoveræ‰€éœ€è¦çš„æ—¶é—´ã€‚</span><br><span class="hljs-meta">#</span><span class="bash">4.å½“è¿›è¡Œfailoveræ—¶ï¼Œé…ç½®æ‰€æœ‰slavesæŒ‡å‘æ–°çš„masteræ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚ä¸è¿‡ï¼Œå³ä½¿è¿‡äº†è¿™ä¸ªè¶…æ—¶ï¼Œslavesä¾ç„¶ä¼šè¢«æ­£ç¡®é…ç½®ä¸ºæŒ‡å‘masterï¼Œä½†æ˜¯å°±ä¸æŒ‰parallel-syncsæ‰€é…ç½®çš„è§„åˆ™æ¥äº†</span><br><span class="hljs-meta">#</span><span class="bash"> é»˜è®¤ä¸‰åˆ†é’Ÿ</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds&gt;</span><br>sentinel failover-timeout mymaster 180000<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> SCRIPTS EXECUTION</span><br><span class="hljs-meta">#</span><span class="bash">é…ç½®å½“æŸä¸€äº‹ä»¶å‘ç”Ÿæ—¶æ‰€éœ€è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡è„šæœ¬æ¥é€šçŸ¥ç®¡ç†å‘˜ï¼Œä¾‹å¦‚å½“ç³»ç»Ÿè¿è¡Œä¸æ­£å¸¸æ—¶å‘é‚®ä»¶é€šçŸ¥ç›¸å…³äººå‘˜ã€‚</span><br><span class="hljs-meta">#</span><span class="bash">å¯¹äºè„šæœ¬çš„è¿è¡Œç»“æœæœ‰ä»¥ä¸‹è§„åˆ™ï¼š</span><br><span class="hljs-meta">#</span><span class="bash">è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›1ï¼Œé‚£ä¹ˆè¯¥è„šæœ¬ç¨åå°†ä¼šè¢«å†æ¬¡æ‰§è¡Œï¼Œé‡å¤æ¬¡æ•°ç›®å‰é»˜è®¤ä¸º10</span><br><span class="hljs-meta">#</span><span class="bash">è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›2ï¼Œæˆ–è€…æ¯”2æ›´é«˜çš„ä¸€ä¸ªè¿”å›å€¼ï¼Œè„šæœ¬å°†ä¸ä¼šé‡å¤æ‰§è¡Œã€‚</span><br><span class="hljs-meta">#</span><span class="bash">å¦‚æœè„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç”±äºæ”¶åˆ°ç³»ç»Ÿä¸­æ–­ä¿¡å·è¢«ç»ˆæ­¢äº†ï¼Œåˆ™åŒè¿”å›å€¼ä¸º1æ—¶çš„è¡Œä¸ºç›¸åŒã€‚</span><br><span class="hljs-meta">#</span><span class="bash">ä¸€ä¸ªè„šæœ¬çš„æœ€å¤§æ‰§è¡Œæ—¶é—´ä¸º60sï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œè„šæœ¬å°†ä¼šè¢«ä¸€ä¸ªSIGKILLä¿¡å·ç»ˆæ­¢ï¼Œä¹‹åé‡æ–°æ‰§è¡Œã€‚</span><br><span class="hljs-meta">#</span><span class="bash">é€šçŸ¥å‹è„šæœ¬:å½“sentinelæœ‰ä»»ä½•è­¦å‘Šçº§åˆ«çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚è¯´rediså®ä¾‹çš„ä¸»è§‚å¤±æ•ˆå’Œå®¢è§‚å¤±æ•ˆç­‰ç­‰ï¼‰ï¼Œå°†ä¼šå»è°ƒç”¨è¿™ä¸ªè„šæœ¬ï¼Œè¿™æ—¶è¿™ä¸ªè„šæœ¬åº”è¯¥é€šè¿‡é‚®ä»¶ï¼ŒSMSç­‰æ–¹å¼å»é€šçŸ¥ç³»ç»Ÿç®¡ç†å‘˜å…³äºç³»ç»Ÿä¸æ­£å¸¸è¿è¡Œçš„ä¿¡æ¯ã€‚è°ƒç”¨è¯¥è„šæœ¬æ—¶ï¼Œå°†ä¼ ç»™è„šæœ¬ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„ç±»å‹ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„æè¿°ã€‚å¦‚æœsentinel.confé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¿™ä¸ªè„šæœ¬è·¯å¾„ï¼Œé‚£ä¹ˆå¿…é¡»ä¿è¯è¿™ä¸ªè„šæœ¬å­˜åœ¨äºè¿™ä¸ªè·¯å¾„ï¼Œå¹¶ä¸”æ˜¯å¯æ‰§è¡Œçš„ï¼Œå¦åˆ™sentinelæ— æ³•æ­£å¸¸å¯åŠ¨æˆåŠŸã€‚</span><br><span class="hljs-meta">#</span><span class="bash">é€šçŸ¥è„šæœ¬</span><br><span class="hljs-meta">#</span><span class="bash"> shellç¼–ç¨‹</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel notification-script &lt;master-name&gt; &lt;script-path&gt;</span><br>sentinel notification-script mymaster /var/redis/notify.sh<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬</span><br><span class="hljs-meta">#</span><span class="bash"> å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯å…³äºmasteråœ°å€å·²ç»å‘ç”Ÿæ”¹å˜çš„ä¿¡æ¯ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬:</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;master-name&gt; &lt;role&gt; &lt;state&gt; &lt;from-ip&gt; &lt;from-port&gt; &lt;to-ip&gt; &lt;to-port&gt;</span><br><span class="hljs-meta">#</span><span class="bash"> ç›®å‰&lt;state&gt;æ€»æ˜¯â€œfailoverâ€,</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;role&gt;æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> å‚æ•° from-ip, from-port, to-ip, to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master(å³æ—§çš„slave)é€šä¿¡çš„</span><br><span class="hljs-meta">#</span><span class="bash"> è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel client-reconfig-script &lt;master-name&gt; &lt;script-path&gt;</span><br>sentinel client-reconfig-script mymaster /var/redis/reconfig.sh # ä¸€èˆ¬éƒ½æ˜¯ç”±è¿ç»´æ¥é…ç½®ï¼<br></code></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><hr><p>ç‹‚ç¥è¯´Javaï¼š<a href="https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0</a></p><p>åŠè·¯é›¨æ­Œï¼š<a href="https://juejin.cn/post/6844904097116585991#heading-1">https://juejin.cn/post/6844904097116585991#heading-1</a></p><p><a href="https://www.jianshu.com/p/d6d2325a5ec7">https://www.jianshu.com/p/d6d2325a5ec7</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisä¸‰ç§é›†ç¾¤æ¨¡å¼ä¹‹ä¸»ä»å¤åˆ¶</title>
    <link href="/2021/10/06/redis%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/"/>
    <url>/2021/10/06/redis%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1.æ¦‚å¿µ"></a>1.æ¦‚å¿µ</h2><p>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master/leader),åè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave/flollower);<strong>æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ï¼ŒMasterä»¥å†™ä¸ºä¸»ï¼ŒSlaveä»¥è¯»ä¸ºä¸»</strong>ã€‚</p><h3 id="1-1ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š"><a href="#1-1ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š" class="headerlink" title="1.1ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š"></a>1.1ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š</h3><ol><li>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</li><li>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚</li><li>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ ï¼ˆå³å†™Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯»Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™ å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</li><li>é«˜å¯ç”¨(é›†ç¾¤)åŸºçŸ³ï¼š é™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤ åˆ¶æ˜¯Redisé«˜å¯ç”¨çš„åŸºç¡€ </li></ol><p><strong>æ³¨æ„ï¼šå¦‚redisè¿ç”¨äºå·¥ç¨‹é¡¹ç›®ä¸­ï¼Œä¸èƒ½ä½¿ç”¨å•æœºredisï¼ŒåŸå› å¦‚ä¸‹ï¼š</strong></p><ol><li> ä»ç»“æ„ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨ä¼šå‘ç”Ÿå•ç‚¹æ•…éšœï¼Œå¹¶ä¸”ä¸€å°æœåŠ¡å™¨éœ€è¦å¤„ç†æ‰€æœ‰çš„è¯·æ±‚è´Ÿè½½ï¼Œå‹åŠ›è¾ƒå¤§ã€‚</li><li>ä»å®¹é‡ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨å†…å­˜å®¹é‡æœ‰é™ï¼Œå°±ç®—ä¸€å°RedisæœåŠ¡å™¨å†…å­˜ä¸º256Gï¼Œä¹Ÿä¸èƒ½å°†æ‰€æœ‰å†…å­˜ä½œç”¨äºRediså­˜å‚¨å†…å­˜ï¼Œä¸€èˆ¬å•å°Redisæœ€å¤§ä½¿ç”¨å†…å­˜ä¸åº”è¯¥è¶…è¿‡20Gã€‚</li></ol><p>ä¸€èˆ¬ç»“æ„æ¶æ„å¦‚ä¸‹ï¼š</p><p><img src="/img/work/1633523383473.png"></p><h2 id="2-åŸºæœ¬åŸç†"><a href="#2-åŸºæœ¬åŸç†" class="headerlink" title="2.åŸºæœ¬åŸç†"></a>2.åŸºæœ¬åŸç†</h2><p> ä¸»ä»å¤åˆ¶æ¨¡å¼ä¸­åŒ…å«ä¸€ä¸ªä¸»æ•°æ®åº“å®ä¾‹(master)ä¸ä¸€ä¸ªæˆ–å¤šä¸ªä»æ•°æ®åº“å®ä¾‹(slave)ï¼Œå®¢æˆ·ç«¯å¯å¯¹ä¸»æ•°æ®åº“è¿›è¡Œè¯»å†™æ“ä½œï¼Œå¯¹ä»æ•°æ®åº“è¿›è¡Œè¯»æ“ä½œï¼Œä¸»æ•°æ®åº“å†™å…¥çš„æ•°æ®ä¼šå®æ—¶è‡ªåŠ¨åŒæ­¥ç»™ä»æ•°æ®åº“ </p><h3 id="2-1å¤åˆ¶åŸç†å›¾"><a href="#2-1å¤åˆ¶åŸç†å›¾" class="headerlink" title="2.1å¤åˆ¶åŸç†å›¾"></a>2.1å¤åˆ¶åŸç†å›¾</h3><p><img src="/img/work/1633524169754.png"></p><h3 id="2-3å…·ä½“æ­¥éª¤"><a href="#2-3å…·ä½“æ­¥éª¤" class="headerlink" title="2.3å…·ä½“æ­¥éª¤"></a>2.3å…·ä½“æ­¥éª¤</h3><ol><li> ä»æœåŠ¡å™¨è¿æ¥ä¸»æœåŠ¡å™¨ï¼Œå‘é€SYNCå‘½ä»¤ ï¼›</li><li> ä¸»æœåŠ¡å™¨æ¥æ”¶åˆ°SYNCå‘½ååï¼Œå¼€å§‹æ‰§è¡ŒBGSAVEå‘½ä»¤ç”ŸæˆRDBæ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ï¼›</li><li> ä¸»æœåŠ¡å™¨BGSAVEæ‰§è¡Œå®Œåï¼Œå‘æ‰€æœ‰ä»æœåŠ¡å™¨å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ï¼›  </li><li>  ä»æœåŠ¡å™¨æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§ï¼› </li><li> ä¸»æœåŠ¡å™¨å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»æœåŠ¡å™¨å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ï¼› </li><li>  ä»æœåŠ¡å™¨å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»æœåŠ¡å™¨ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼› </li></ol><h2 id="3-éƒ¨ç½²ç¤ºä¾‹"><a href="#3-éƒ¨ç½²ç¤ºä¾‹" class="headerlink" title="3.éƒ¨ç½²ç¤ºä¾‹"></a>3.éƒ¨ç½²ç¤ºä¾‹</h2><p>åªé…ç½®ä»åº“ï¼Œä¸ç”¨é…ç½®ä¸»åº“ï¼Œä¸»åº“å…·ä½“é…ç½®ï¼Œå¯ä»¥å‚è€ƒå‰é¢æ–‡ç« ã€ŠRedis.Confè¯¦è§£ã€‹åŠã€ŠRedisæŒä¹…åŒ–ã€‹,æˆ‘è¿™é‡Œé…ç½®çš„æ˜¯<strong>ä¸€ä¸»ä¸¤ä»</strong></p><h3 id="3-1-æŸ¥çœ‹ä¸»åº“ä¿¡æ¯"><a href="#3-1-æŸ¥çœ‹ä¸»åº“ä¿¡æ¯" class="headerlink" title="3.1 æŸ¥çœ‹ä¸»åº“ä¿¡æ¯"></a>3.1 æŸ¥çœ‹ä¸»åº“ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹å½“å‰åº“çš„ä¿¡æ¯</span><br>127.0.0.1:6379&gt;info replication<br><span class="hljs-meta">#</span><span class="bash"> Replication</span><br>role:master  #è§’è‰²<br>connected_slaves:0  #ä»æœºä¿¡æ¯<br>master_failover_state:no-failover<br>master_replid:e3d0ce67427f5c928650af42bc66dd0c294f5dbe<br>master_replid2:0000000000000000000000000000000000000000<br>master_repl_offset:0<br>second_repl_offset:-1<br>repl_backlog_active:0<br>repl_backlog_size:1048576<br>repl_backlog_first_byte_offset:0<br>repl_backlog_histlen:0<br><br></code></pre></td></tr></table></figure><h3 id="2-2-é…ç½®æ–‡ä»¶"><a href="#2-2-é…ç½®æ–‡ä»¶" class="headerlink" title="2.2 é…ç½®æ–‡ä»¶"></a>2.2 é…ç½®æ–‡ä»¶</h3><ol><li><p>å¤åˆ¶ä¸‰ä¸ªredis.confæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹å¯¹åº”ä¿¡æ¯ï¼Œä¾‹å¦‚slave1.conf,slave2.conf</p></li><li><p>åˆ†åˆ«ä¿®æ”¹ç«¯å£ä¿¡æ¯</p></li><li><p>åˆ†åˆ«ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­pidåç§°</p></li><li><p>åˆ†åˆ«ä¿®æ”¹logæ–‡ä»¶åç§°</p></li><li><p>åˆ†åˆ«ä¿®æ”¹dump.rdbåç§°</p></li></ol><h3 id="3-3-å¯åŠ¨æœåŠ¡"><a href="#3-3-å¯åŠ¨æœåŠ¡" class="headerlink" title="3.3 å¯åŠ¨æœåŠ¡"></a>3.3 å¯åŠ¨æœåŠ¡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@centos7 bin]# redis-server etc/slave1.conf #å¯åŠ¨ä»åº“1<br>[root@centos7 bin]# redis-server etc/slave2.conf #å¯åŠ¨ä»åº“2<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹redisæœåŠ¡ä¿¡æ¯</span><br>[root@centos7 bin]# ps -ef | grep redis<br>root       2766      1  0 05:33 ?        00:00:02 redis-server 127.0.0.1:6379 <br>root       3250      1  0 06:05 ?        00:00:00 redis-server 127.0.0.1:6380<br>root       3263      1  0 06:05 ?        00:00:00 redis-server 127.0.0.1:6381<br>root       3293   2715  0 06:09 pts/1    00:00:00 grep --color=auto redis<br><br></code></pre></td></tr></table></figure><h3 id="3-4-ä¸€ä¸»ä¸¤ä»å‘½ä»¤æ–¹å¼è®¾ç½®"><a href="#3-4-ä¸€ä¸»ä¸¤ä»å‘½ä»¤æ–¹å¼è®¾ç½®" class="headerlink" title="3.4 ä¸€ä¸»ä¸¤ä»å‘½ä»¤æ–¹å¼è®¾ç½®"></a>3.4 ä¸€ä¸»ä¸¤ä»å‘½ä»¤æ–¹å¼è®¾ç½®</h3><p> é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ ï¼Œä¸€èˆ¬æˆ‘ä»¬é…ç½®ä»æœºå³å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">åˆ†åˆ«ç™»å½•ä»æœåŠ¡å™¨</span><br>[root@centos7 bin]# redis-cli -p 6380<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è®¾ç½®ä¸»master,ä¹Ÿå°±æ‰¾é‚£ä¸€å°å½“ä¸»èŠ‚ç‚¹</span><br>127.0.0.1:6380&gt; SLAVEOF 127.0.0.1 6379  #å¯»æ‰¾ä¸»èŠ‚ç‚¹ï¼Œæ‰¾è°å½“è€å¤§<br>OK<br><br>127.0.0.1:6380&gt; INFO replication<br><span class="hljs-meta">#</span><span class="bash"> Replication</span><br>role:slave  # å½“å‰è§’è‰²æ˜¯ä»æœº<br>master_host:127.0.0.1 # å¯ä»¥çš„çœ‹åˆ°ä¸»æœºçš„ä¿¡æ¯<br>master_port:6379  #ä¸»æœºç«¯å£<br>master_link_status:down<br>master_last_io_seconds_ago:-1<br>master_sync_in_progress:0<br>slave_repl_offset:1<br>master_link_down_since_seconds:-1<br>slave_priority:100<br>slave_read_only:1<br>replica_announced:1<br>connected_slaves:0<br>master_failover_state:no-failover<br>master_replid:449ba98d5fcd3c32154dfd049716ce5ca3ee4d4b<br>master_replid2:0000000000000000000000000000000000000000<br>master_repl_offset:0<br>second_repl_offset:-1<br>repl_backlog_active:0<br>repl_backlog_size:1048576<br>repl_backlog_first_byte_offset:0<br>repl_backlog_histlen:0<br></code></pre></td></tr></table></figure><p>å›åˆ°6379ä¸­æŸ¥çœ‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Replication</span><br>role:master<br>connected_slaves:1 #ä¸€ä¸ªä»èŠ‚ç‚¹<br>slave0:ip=127.0.0.1,port=6380,state=online,offset=28,lag=0  #ä»èŠ‚ç‚¹ä¿¡æ¯<br>master_failover_state:no-failover<br>master_replid:b717806873adac0ac99646e873b92a744d2406df<br>master_replid2:0000000000000000000000000000000000000000<br>master_repl_offset:28<br>second_repl_offset:-1<br>repl_backlog_active:1<br>repl_backlog_size:1048576<br>repl_backlog_first_byte_offset:1<br>repl_backlog_histlen:28<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªä»èŠ‚ç‚¹æ ¹æ®ä¸Šé¢é…ç½®å³å¯</p><p><strong>æ³¨æ„ï¼šä½¿ç”¨å‘½ä»¤æ–¹å¼é…ç½®åªæ˜¯æš‚æ—¶çš„ï¼Œé‡å¯æœåŠ¡å³å¤±æ•ˆï¼Œæ¨èåœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®</strong></p><h3 id="3-5-ä¸€ä¸»ä¸¤ä»é…ç½®æ–‡ä»¶æ–¹å¼è®¾ç½®ï¼ˆæ¨èï¼‰"><a href="#3-5-ä¸€ä¸»ä¸¤ä»é…ç½®æ–‡ä»¶æ–¹å¼è®¾ç½®ï¼ˆæ¨èï¼‰" class="headerlink" title="3.5 ä¸€ä¸»ä¸¤ä»é…ç½®æ–‡ä»¶æ–¹å¼è®¾ç½®ï¼ˆæ¨èï¼‰"></a>3.5 ä¸€ä¸»ä¸¤ä»é…ç½®æ–‡ä»¶æ–¹å¼è®¾ç½®ï¼ˆæ¨èï¼‰</h3><p>åœ¨ä»æ•°æ®é…ç½®æ–‡ä»¶ä¸­æ·»åŠ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">replicaof 127.0.0.1 6379 # masterçš„ipï¼Œport<br>masterauth 123456 # masterçš„å¯†ç <br>replica-serve-stale-data no # å¦‚æœslaveæ— æ³•ä¸masteråŒæ­¥ï¼Œè®¾ç½®æˆslaveä¸å¯è¯»ï¼Œæ–¹ä¾¿ç›‘æ§è„šæœ¬å‘ç°é—®é¢˜<br></code></pre></td></tr></table></figure><p>åˆ†åˆ«å¯åŠ¨ä¸¤ä¸ªä»æœåŠ¡å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@centos7 bin]# redis-server etc/slave1.conf <br>[root@centos7 bin]# redis-server etc/slave2.conf <br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">ç„¶åå†åœ¨ä¸»æœåŠ¡å™¨è¾“å…¥ä»¥ä¸‹ä¿¡æ¯å³å¯æŸ¥çœ‹åˆ°ä¸¤ä¸ªä»æœåŠ¡å™¨ä¿¡æ¯</span><br>127.0.0.1:6379&gt; INFO replication<br><span class="hljs-meta">#</span><span class="bash"> Replication</span><br>role:master<br>connected_slaves:2  #ä¸¤ä¸ªä»æ•°æ®åº“<br>slave0:ip=127.0.0.1,port=6380,state=online,offset=1008,lag=1<br>slave1:ip=127.0.0.1,port=6381,state=online,offset=1008,lag=1<br>master_failover_state:no-failover<br>master_replid:b717806873adac0ac99646e873b92a744d2406df<br>master_replid2:0000000000000000000000000000000000000000<br>master_repl_offset:1008<br>second_repl_offset:-1<br>repl_backlog_active:1<br>repl_backlog_size:1048576<br>repl_backlog_first_byte_offset:1<br>repl_backlog_histlen:1008<br></code></pre></td></tr></table></figure><blockquote><p>æ•°æ®æµ‹è¯•</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">ä¸»æ•°æ®åº“å†™</span><br>127.0.0.1:6379&gt; set k1 v1<br>OK<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">ä»æ•°æ®è¯»</span><br>127.0.0.1:6380&gt; get k1<br>&quot;v1&quot;<br></code></pre></td></tr></table></figure><blockquote><p>ç»†èŠ‚</p></blockquote><p> ä¸»æœºå¯ä»¥å†™ï¼Œä»æœºä¸èƒ½å†™åªèƒ½è¯»ï¼ä¸»æœºä¸­çš„æ‰€æœ‰ä¿¡æ¯å’Œæ•°æ®ï¼Œéƒ½ä¼šè‡ªåŠ¨è¢«ä»æœºä¿å­˜ï¼ </p><p>ä¸»æœºå†™ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; set k1 v1<br>OK<br></code></pre></td></tr></table></figure><p>ä»æœºå†™ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6380&gt; set k1 v1<br>(error) READONLY You can&#x27;t write against a read only replica. #ä¸èƒ½å†™å…¥<br><br></code></pre></td></tr></table></figure><h2 id="4-ä¼˜ç¼ºç‚¹"><a href="#4-ä¼˜ç¼ºç‚¹" class="headerlink" title="4.ä¼˜ç¼ºç‚¹"></a>4.ä¼˜ç¼ºç‚¹</h2><h3 id="4-1ä¼˜ç‚¹"><a href="#4-1ä¼˜ç‚¹" class="headerlink" title="4.1ä¼˜ç‚¹"></a>4.1ä¼˜ç‚¹</h3><ul><li>masterèƒ½è‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°slaveï¼Œå¯ä»¥è¿›è¡Œè¯»å†™åˆ†ç¦»ï¼Œåˆ†æ‹…masterçš„è¯»å‹åŠ›</li><li>masterã€slaveä¹‹é—´çš„åŒæ­¥æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼è¿›è¡Œçš„ï¼ŒåŒæ­¥æœŸé—´ï¼Œå®¢æˆ·ç«¯ä»ç„¶å¯ä»¥æäº¤æŸ¥è¯¢æˆ–æ›´æ–°è¯·æ±‚</li></ul><h3 id="4-2ç¼ºç‚¹"><a href="#4-2ç¼ºç‚¹" class="headerlink" title="4.2ç¼ºç‚¹"></a>4.2ç¼ºç‚¹</h3><ul><li>ä¸å…·å¤‡è‡ªåŠ¨å®¹é”™ä¸æ¢å¤åŠŸèƒ½ï¼Œmasteræˆ–slaveçš„å®•æœºéƒ½å¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯è¯·æ±‚å¤±è´¥ï¼Œéœ€è¦ç­‰å¾…æœºå™¨é‡å¯æˆ–æ‰‹åŠ¨åˆ‡æ¢å®¢æˆ·ç«¯IPæ‰èƒ½æ¢å¤</li><li>masterå®•æœºï¼Œå¦‚æœå®•æœºå‰æ•°æ®æ²¡æœ‰åŒæ­¥å®Œï¼Œåˆ™åˆ‡æ¢IPåä¼šå­˜åœ¨æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜</li><li>éš¾ä»¥æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼ŒRedisçš„å®¹é‡å—é™äºå•æœºé…ç½®</li></ul><p>å‚è€ƒï¼š</p><hr><p>ç‹‚ç¥è¯´Javaï¼š<a href="https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0</a></p><p>åŠè·¯é›¨æ­Œï¼š<a href="https://juejin.cn/post/6844904097116585991#heading-1">https://juejin.cn/post/6844904097116585991#heading-1</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RedisæŒä¹…åŒ–</title>
    <link href="/2021/09/30/Redis%E6%8C%81%E4%B9%85%E5%8C%96/"/>
    <url>/2021/09/30/Redis%E6%8C%81%E4%B9%85%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="http://redis.io/">Redis</a>æœ‰ä¸¤ç§æŒä¹…åŒ–çš„æ–¹å¼ï¼šå¿«ç…§ï¼ˆ<code>RDB</code>æ–‡ä»¶ï¼‰å’Œè¿½åŠ å¼æ–‡ä»¶ï¼ˆ<code>AOF</code>æ–‡ä»¶ï¼‰ï¼š</p><ul><li>RDBæŒä¹…åŒ–æ–¹å¼ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„é—´éš”ä¿å­˜é‚£ä¸ªæ—¶é—´ç‚¹çš„ä¸€ä¸ªæ•°æ®å¿«ç…§ã€‚</li><li>AOFæŒä¹…åŒ–æ–¹å¼åˆ™ä¼šè®°å½•æ¯ä¸€ä¸ªæœåŠ¡å™¨æ”¶åˆ°çš„å†™æ“ä½œã€‚åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œè¿™äº›è®°å½•çš„æ“ä½œä¼šé€æ¡æ‰§è¡Œä»è€Œé‡å»ºå‡ºåŸæ¥çš„æ•°æ®ã€‚å†™æ“ä½œå‘½ä»¤è®°å½•çš„æ ¼å¼è·ŸRedisåè®®ä¸€è‡´ï¼Œä»¥è¿½åŠ çš„æ–¹å¼è¿›è¡Œä¿å­˜ã€‚</li><li>Redisçš„æŒä¹…åŒ–æ˜¯å¯ä»¥ç¦ç”¨çš„ï¼Œå°±æ˜¯è¯´ä½ å¯ä»¥è®©æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸåªå­˜åœ¨äºæœåŠ¡å™¨çš„è¿è¡Œæ—¶é—´é‡Œã€‚</li><li>ä¸¤ç§æ–¹å¼çš„æŒä¹…åŒ–æ˜¯å¯ä»¥åŒæ—¶å­˜åœ¨çš„ï¼Œä½†æ˜¯å½“Redisé‡å¯æ—¶ï¼ŒAOFæ–‡ä»¶ä¼šè¢«ä¼˜å…ˆç”¨äºé‡å»ºæ•°æ®ã€‚</li></ul><h2 id="RDBï¼ˆRedis-DataBaseï¼‰"><a href="#RDBï¼ˆRedis-DataBaseï¼‰" class="headerlink" title="RDBï¼ˆRedis DataBaseï¼‰"></a>RDBï¼ˆRedis DataBaseï¼‰</h2><blockquote><p>å·¥ä½œåŸç†</p></blockquote><ul><li>Redisè°ƒç”¨fork()ï¼Œäº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹</li><li>å­è¿›ç¨‹æŠŠæ•°æ®å†™åˆ°ä¸€ä¸ªä¸´æ—¶çš„RDBæ–‡ä»¶</li><li>å½“å­è¿›ç¨‹å†™å®Œæ–°çš„RDBæ–‡ä»¶åï¼ŒæŠŠæ—§çš„RDBæ–‡ä»¶æ›¿æ¢æ‰</li></ul><p><img src="/img/work/image-20210930171854270.png"></p><p>ä¸€èˆ¬åœ¨ä¸»ä»å¤åˆ¶ä¸­,rdbåšå¤‡ç”¨åœ¨ä»æœºä¸Š</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ol><li>RDBæ–‡ä»¶æ˜¯ä¸€ä¸ªå¾ˆç®€æ´çš„å•æ–‡ä»¶ï¼Œå®ƒä¿å­˜äº†æŸä¸ªæ—¶é—´ç‚¹çš„Redisæ•°æ®ï¼Œå¾ˆé€‚åˆç”¨äºåšå¤‡ä»½ã€‚ä½ å¯ä»¥è®¾å®šä¸€ä¸ªæ—¶é—´ç‚¹å¯¹RDBæ–‡ä»¶è¿›è¡Œå½’æ¡£ï¼Œè¿™æ ·å°±èƒ½åœ¨éœ€è¦çš„æ—¶å€™å¾ˆè½»æ˜“çš„æŠŠæ•°æ®æ¢å¤åˆ°ä¸åŒçš„ç‰ˆæœ¬</li><li>åŸºäºä¸Šé¢æ‰€æè¿°çš„ç‰¹æ€§ï¼ŒRDBå¾ˆé€‚åˆç”¨äºç¾å¤‡ã€‚å•æ–‡ä»¶å¾ˆæ–¹ä¾¿å°±èƒ½ä¼ è¾“åˆ°è¿œç¨‹çš„æœåŠ¡å™¨ä¸Š</li><li>RDBçš„æ€§èƒ½å¾ˆå¥½ï¼Œéœ€è¦è¿›è¡ŒæŒä¹…åŒ–æ—¶ï¼Œä¸»è¿›ç¨‹ä¼šforkä¸€ä¸ªå­è¿›ç¨‹å‡ºæ¥ï¼Œç„¶åæŠŠæŒä¹…åŒ–çš„å·¥ä½œäº¤ç»™å­è¿›ç¨‹ï¼Œè‡ªå·±ä¸ä¼šæœ‰ç›¸å…³çš„I/Oæ“ä½œ</li><li>æ¯”èµ·AOFï¼Œåœ¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼ŒRDBçš„å¯åŠ¨é€Ÿåº¦æ›´å¿«</li></ol><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ol><li>RDBå®¹æ˜“é€ æˆæ•°æ®çš„ä¸¢å¤±ã€‚å‡è®¾æ¯5åˆ†é’Ÿä¿å­˜ä¸€æ¬¡å¿«ç…§ï¼Œå¦‚æœRediså› ä¸ºæŸäº›åŸå› ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œé‚£ä¹ˆä»ä¸Šæ¬¡äº§ç”Ÿå¿«ç…§åˆ°Rediså‡ºç°é—®é¢˜è¿™æ®µæ—¶é—´çš„æ•°æ®å°±ä¼šä¸¢å¤±äº†</li><li>RDBä½¿ç”¨<code>fork()</code>äº§ç”Ÿå­è¿›ç¨‹è¿›è¡Œæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¦‚æœæ•°æ®æ¯”è¾ƒå¤§çš„è¯å¯èƒ½å°±ä¼šèŠ±è´¹ç‚¹æ—¶é—´ï¼Œé€ æˆRedisåœæ­¢æœåŠ¡å‡ æ¯«ç§’ã€‚å¦‚æœæ•°æ®é‡å¾ˆå¤§ä¸”CPUæ€§èƒ½ä¸æ˜¯å¾ˆå¥½çš„æ—¶å€™ï¼Œåœæ­¢æœåŠ¡çš„æ—¶é—´ç”šè‡³ä¼šåˆ°1ç§’</li></ol><h3 id="æ–‡ä»¶è·¯å¾„å’Œåç§°"><a href="#æ–‡ä»¶è·¯å¾„å’Œåç§°" class="headerlink" title="æ–‡ä»¶è·¯å¾„å’Œåç§°"></a>æ–‡ä»¶è·¯å¾„å’Œåç§°</h3><p>é»˜è®¤Redisä¼šæŠŠå¿«ç…§æ–‡ä»¶å­˜å‚¨ä¸ºå½“å‰ç›®å½•ä¸‹ä¸€ä¸ªåä¸º<code>dump.rdb</code>çš„æ–‡ä»¶ã€‚è¦ä¿®æ”¹æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„å’Œåç§°ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶<code>redis.conf</code>å®ç°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> RDBæ–‡ä»¶åï¼Œé»˜è®¤ä¸ºdump.rdbã€‚</span><br>dbfilename dump.rdb<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æ–‡ä»¶å­˜æ”¾çš„ç›®å½•ï¼ŒAOFæ–‡ä»¶åŒæ ·å­˜æ”¾åœ¨æ­¤ç›®å½•ä¸‹ã€‚é»˜è®¤ä¸ºå½“å‰å·¥ä½œç›®å½•ã€‚</span><br>dir ./<br></code></pre></td></tr></table></figure><h3 id="ä¿å­˜ç‚¹ï¼ˆRDBçš„å¯ç”¨å’Œç¦ç”¨ï¼‰"><a href="#ä¿å­˜ç‚¹ï¼ˆRDBçš„å¯ç”¨å’Œç¦ç”¨ï¼‰" class="headerlink" title="ä¿å­˜ç‚¹ï¼ˆRDBçš„å¯ç”¨å’Œç¦ç”¨ï¼‰"></a>ä¿å­˜ç‚¹ï¼ˆRDBçš„å¯ç”¨å’Œç¦ç”¨ï¼‰</h3><p>å¯ä»¥é…ç½®ä¿å­˜ç‚¹ï¼Œä½¿Rediså¦‚æœåœ¨æ¯Nç§’åæ•°æ®å‘ç”Ÿäº†Mæ¬¡æ”¹å˜å°±ä¿å­˜å¿«ç…§æ–‡ä»¶ã€‚ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªä¿å­˜ç‚¹é…ç½®è¡¨ç¤ºæ¯60ç§’ï¼Œå¦‚æœæ•°æ®å‘ç”Ÿäº†1000æ¬¡ä»¥ä¸Šçš„å˜åŠ¨ï¼ŒRediså°±ä¼šè‡ªåŠ¨ä¿å­˜å¿«ç…§æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">save &lt;seconds&gt; &lt;changes&gt; æ ¼å¼</span><br>save 60 1000   #60Så†…å¦‚æœ1000ä¸ªkeyå‘ç”Ÿäº†ä¿®æ”¹ï¼ŒRediså°±ä¼šè‡ªåŠ¨ä¿å­˜å¿«ç…§æ–‡ä»¶<br></code></pre></td></tr></table></figure><p>ä¿å­˜ç‚¹å¯ä»¥è®¾ç½®å¤šä¸ªï¼ŒRedisçš„é…ç½®æ–‡ä»¶å°±é»˜è®¤è®¾ç½®äº†3ä¸ªä¿å­˜ç‚¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å¯ä»¥è®¾ç½®å¤šä¸ª</span><br>save 900 1 #900ç§’åè‡³å°‘1ä¸ªkeyæœ‰å˜åŠ¨<br>save 300 10 #300ç§’åè‡³å°‘10ä¸ªkeyæœ‰å˜åŠ¨<br>save 60 10000 #60ç§’åè‡³å°‘10000ä¸ªkeyæœ‰å˜åŠ¨<br></code></pre></td></tr></table></figure><p>å¦‚æœæƒ³ç¦ç”¨å¿«ç…§ä¿å­˜çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡æ³¨é‡Šæ‰æ‰€æœ‰â€saveâ€é…ç½®è¾¾åˆ°ï¼Œæˆ–è€…åœ¨æœ€åä¸€æ¡â€saveâ€é…ç½®åæ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">save &quot;&quot;<br></code></pre></td></tr></table></figure><blockquote><p>è§¦å‘æœºåˆ¶è¯´æ˜</p></blockquote><ol><li>saveçš„è§„åˆ™æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘rdbè§„åˆ™</li><li>æ‰§è¡Œ flushall å‘½ä»¤ï¼Œä¹Ÿä¼šè§¦å‘rdbè§„åˆ™ï¼</li><li>é€€å‡ºredisï¼Œä¹Ÿä¼šäº§ç”Ÿ rdb æ–‡ä»¶</li></ol><blockquote><p>å¦‚ä½•æ¢å¤rdbæ–‡ä»¶</p></blockquote><ol><li>åªéœ€è¦å°†rdbæ–‡ä»¶æ”¾åœ¨rediså¯åŠ¨ç›®å½•å³å¯ï¼Œrediså¯åŠ¨çš„æ—¶å€™ä¼šè‡ªåŠ¨æ£€æŸ¥dump.rdb æ¢å¤å…¶ä¸­ çš„æ•°æ®</li><li>æŸ¥çœ‹å­˜æ”¾ç›®å½•</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; config get dir<br>1) &quot;dir&quot;<br>2) &quot;/usr/local/bin&quot; # å¦‚æœåœ¨è¿™ä¸ªç›®å½•ä¸‹å­˜åœ¨ dump.rdb æ–‡ä»¶ï¼Œå¯åŠ¨å°±ä¼šè‡ªåŠ¨æ¢å¤å…¶ä¸­çš„æ•°æ®<br></code></pre></td></tr></table></figure><h2 id="AOFï¼ˆAppend-Only-Fileï¼‰"><a href="#AOFï¼ˆAppend-Only-Fileï¼‰" class="headerlink" title="AOFï¼ˆAppend Only Fileï¼‰"></a>AOFï¼ˆAppend Only Fileï¼‰</h2><p>å¿«ç…§å¹¶ä¸æ˜¯å¾ˆå¯é ã€‚å¦‚æœä½ çš„ç”µè„‘çªç„¶å®•æœºäº†ï¼Œæˆ–è€…ç”µæºæ–­äº†ï¼Œåˆæˆ–è€…ä¸å°å¿ƒæ€æ‰äº†è¿›ç¨‹ï¼Œé‚£ä¹ˆæœ€æ–°çš„æ•°æ®å°±ä¼šä¸¢å¤±ã€‚è€ŒAOFæ–‡ä»¶åˆ™æä¾›äº†ä¸€ç§æ›´ä¸ºå¯é çš„æŒä¹…åŒ–æ–¹å¼ã€‚æ¯å½“Redisæ¥å—åˆ°ä¼šä¿®æ”¹æ•°æ®é›†çš„å‘½ä»¤æ—¶ï¼Œå°±ä¼šæŠŠå‘½ä»¤è¿½åŠ åˆ°AOFæ–‡ä»¶é‡Œï¼Œå½“ä½ é‡å¯Redisæ—¶ï¼ŒAOFé‡Œçš„å‘½ä»¤ä¼šè¢«é‡æ–°æ‰§è¡Œä¸€æ¬¡ï¼Œé‡å»ºæ•°æ®ã€‚</p><blockquote><p>å·¥ä½œåŸç†</p></blockquote><p><img src="/img/work/image-20210930180234429.png"></p><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ol><li>æ¯”RDBå¯é ã€‚ä½ å¯ä»¥åˆ¶å®šä¸åŒçš„fsyncç­–ç•¥ï¼šä¸è¿›è¡Œfsyncã€æ¯ç§’fsyncä¸€æ¬¡å’Œæ¯æ¬¡æŸ¥è¯¢è¿›è¡Œfsyncã€‚é»˜è®¤æ˜¯æ¯ç§’fsyncä¸€æ¬¡ã€‚è¿™æ„å‘³ç€ä½ æœ€å¤šä¸¢å¤±ä¸€ç§’é’Ÿçš„æ•°æ®ã€‚</li><li>AOFæ—¥å¿—æ–‡ä»¶æ˜¯ä¸€ä¸ªçº¯è¿½åŠ çš„æ–‡ä»¶ã€‚å°±ç®—æ˜¯é‡åˆ°çªç„¶åœç”µçš„æƒ…å†µï¼Œä¹Ÿä¸ä¼šå‡ºç°æ—¥å¿—çš„å®šä½æˆ–è€…æŸåé—®é¢˜ã€‚ç”šè‡³å¦‚æœå› ä¸ºæŸäº›åŸå› ï¼ˆä¾‹å¦‚ç£ç›˜æ»¡äº†ï¼‰å‘½ä»¤åªå†™äº†ä¸€åŠåˆ°æ—¥å¿—æ–‡ä»¶é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨<code>redis-check-aof</code>è¿™ä¸ªå·¥å…·å¾ˆç®€å•çš„è¿›è¡Œä¿®å¤</li><li> å½“AOFæ–‡ä»¶å¤ªå¤§æ—¶ï¼ŒRedisä¼šè‡ªåŠ¨åœ¨åå°è¿›è¡Œé‡å†™ã€‚é‡å†™å¾ˆå®‰å…¨ï¼Œå› ä¸ºé‡å†™æ˜¯åœ¨ä¸€ä¸ªæ–°çš„æ–‡ä»¶ä¸Šè¿›è¡Œï¼ŒåŒæ—¶Redisä¼šç»§ç»­å¾€æ—§çš„æ–‡ä»¶è¿½åŠ æ•°æ®ã€‚æ–°æ–‡ä»¶ä¸Šä¼šå†™å…¥èƒ½é‡å»ºå½“å‰æ•°æ®é›†çš„æœ€å°æ“ä½œå‘½ä»¤çš„é›†åˆã€‚å½“æ–°æ–‡ä»¶é‡å†™å®Œï¼ŒRedisä¼šæŠŠæ–°æ—§æ–‡ä»¶è¿›è¡Œåˆ‡æ¢ï¼Œç„¶åå¼€å§‹æŠŠæ•°æ®å†™åˆ°æ–°æ–‡ä»¶ä¸Š </li><li> AOFæŠŠæ“ä½œå‘½ä»¤ä»¥ç®€å•æ˜“æ‡‚çš„æ ¼å¼ä¸€æ¡æ¥ä¸€æ¡çš„ä¿å­˜åœ¨æ–‡ä»¶é‡Œï¼Œå¾ˆå®¹æ˜“å¯¼å‡ºæ¥ç”¨äºæ¢å¤æ•°æ®ã€‚ä¾‹å¦‚æˆ‘ä»¬ä¸å°å¿ƒç”¨<code>FLUSHALL</code>å‘½ä»¤æŠŠæ‰€æœ‰æ•°æ®åˆ·æ‰äº†ï¼Œåªè¦æ–‡ä»¶æ²¡æœ‰è¢«é‡å†™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæœåŠ¡åœæ‰ï¼ŒæŠŠæœ€åé‚£æ¡å‘½ä»¤åˆ æ‰ï¼Œç„¶åé‡å¯æœåŠ¡ï¼Œè¿™æ ·å°±èƒ½æŠŠè¢«åˆ·æ‰çš„æ•°æ®æ¢å¤å›æ¥ </li></ol><h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ol><li> åœ¨ç›¸åŒçš„æ•°æ®é›†ä¸‹ï¼ŒAOFæ–‡ä»¶çš„å¤§å°ä¸€èˆ¬ä¼šæ¯”RDBæ–‡ä»¶å¤§ </li><li> åœ¨æŸäº›fsyncç­–ç•¥ä¸‹ï¼ŒAOFçš„é€Ÿåº¦ä¼šæ¯”RDBæ…¢ã€‚é€šå¸¸fsyncè®¾ç½®ä¸ºæ¯ç§’ä¸€æ¬¡å°±èƒ½è·å¾—æ¯”è¾ƒé«˜çš„æ€§èƒ½ï¼Œè€Œåœ¨ç¦æ­¢fsyncçš„æƒ…å†µä¸‹é€Ÿåº¦å¯ä»¥è¾¾åˆ°RDBçš„æ°´å¹³ </li><li> åœ¨è¿‡å»æ›¾ç»å‘ç°ä¸€äº›å¾ˆç½•è§çš„BUGå¯¼è‡´ä½¿ç”¨AOFé‡å»ºçš„æ•°æ®è·ŸåŸæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ </li></ol><h3 id="å¯ç”¨AOF"><a href="#å¯ç”¨AOF" class="headerlink" title="å¯ç”¨AOF"></a>å¯ç”¨AOF</h3><p> æŠŠé…ç½®é¡¹<code>appendonly</code>è®¾ä¸º<code>yes</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">è®¾ç½®å¼€å¯aof</span><br>appendonly yes<br></code></pre></td></tr></table></figure><h3 id="æ–‡ä»¶è·¯å¾„å’Œåç§°-1"><a href="#æ–‡ä»¶è·¯å¾„å’Œåç§°-1" class="headerlink" title="æ–‡ä»¶è·¯å¾„å’Œåç§°"></a>æ–‡ä»¶è·¯å¾„å’Œåç§°</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œä¸RDBå…±ç”¨ã€‚é»˜è®¤ä¸ºå½“å‰å·¥ä½œç›®å½•ã€‚</span><br>dir ./<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> é»˜è®¤æ–‡ä»¶åä¸ºappendonly.aof</span><br>appendfilename &quot;appendonly.aof&quot;<br></code></pre></td></tr></table></figure><h3 id="å¯é æ€§"><a href="#å¯é æ€§" class="headerlink" title="å¯é æ€§"></a>å¯é æ€§</h3><p> ä½ å¯ä»¥é…ç½®Redisè°ƒç”¨fsyncçš„é¢‘ç‡ï¼Œæœ‰ä¸‰ä¸ªé€‰é¡¹ï¼š </p><ol><li>æ¯å½“æœ‰æ–°å‘½ä»¤è¿½åŠ åˆ°AOFçš„æ—¶å€™è°ƒç”¨fsyncã€‚é€Ÿåº¦æœ€æ…¢ï¼Œä½†æ˜¯æœ€å®‰å…¨</li><li> æ¯ç§’fsyncä¸€æ¬¡ã€‚é€Ÿåº¦å¿«ï¼ˆ2.4ç‰ˆæœ¬è·Ÿå¿«ç…§æ–¹å¼é€Ÿåº¦å·®ä¸å¤šï¼‰ï¼Œå®‰å…¨æ€§ä¸é”™ï¼ˆæœ€å¤šä¸¢å¤±1ç§’çš„æ•°æ®ï¼‰ </li><li> ä»ä¸fsyncï¼Œäº¤ç”±ç³»ç»Ÿå»å¤„ç†ã€‚è¿™ä¸ªæ–¹å¼é€Ÿåº¦æœ€å¿«ï¼Œä½†æ˜¯å®‰å…¨æ€§ä¸€èˆ¬ </li></ol><p> æ¨èä½¿ç”¨æ¯ç§’fsyncä¸€æ¬¡çš„æ–¹å¼ï¼ˆé»˜è®¤çš„æ–¹å¼ï¼‰ï¼Œå› ä¸ºå®ƒé€Ÿåº¦å¿«ï¼Œå®‰å…¨æ€§ä¹Ÿä¸é”™ã€‚ç›¸å…³é…ç½®å¦‚ä¸‹ï¼š </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> appendfsync always</span><br>appendfsync everysec<br><span class="hljs-meta">#</span><span class="bash"> appendfsync no</span><br></code></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="æ—¥å¿—é‡å†™"><a href="#æ—¥å¿—é‡å†™" class="headerlink" title="æ—¥å¿—é‡å†™"></a>æ—¥å¿—é‡å†™</h3><p>â€‹       éšç€å†™æ“ä½œçš„ä¸æ–­å¢åŠ ï¼ŒAOFæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ã€‚ä¾‹å¦‚ä½ é€’å¢ä¸€ä¸ªè®¡æ•°å™¨100æ¬¡ï¼Œé‚£ä¹ˆæœ€ç»ˆç»“æœå°±æ˜¯æ•°æ®é›†é‡Œçš„è®¡æ•°å™¨çš„å€¼ä¸ºæœ€ç»ˆçš„é€’å¢ç»“æœï¼Œä½†æ˜¯AOFæ–‡ä»¶é‡Œå´ä¼šæŠŠè¿™100æ¬¡æ“ä½œå®Œæ•´çš„è®°å½•ä¸‹æ¥ã€‚è€Œäº‹å®ä¸Šè¦æ¢å¤è¿™ä¸ªè®°å½•ï¼Œåªéœ€è¦1ä¸ªå‘½ä»¤å°±è¡Œäº†ï¼Œä¹Ÿå°±æ˜¯è¯´AOFæ–‡ä»¶é‡Œé‚£100æ¡å‘½ä»¤å…¶å®å¯ä»¥ç²¾ç®€ä¸º1æ¡ã€‚æ‰€ä»¥Redisæ”¯æŒè¿™æ ·ä¸€ä¸ªåŠŸèƒ½ï¼šåœ¨ä¸ä¸­æ–­æœåŠ¡çš„æƒ…å†µä¸‹åœ¨åå°é‡å»ºAOFæ–‡ä»¶ </p><p> <strong>å·¥ä½œåŸç†å¦‚ä¸‹ :</strong></p><ol><li> Redisè°ƒç”¨fork()ï¼Œäº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ </li><li> å­è¿›ç¨‹æŠŠæ–°çš„AOFå†™åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶é‡Œ </li><li> ä¸»è¿›ç¨‹æŒç»­æŠŠæ–°çš„å˜åŠ¨å†™åˆ°å†…å­˜é‡Œçš„bufferï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¿™äº›æ–°çš„å˜åŠ¨å†™åˆ°æ—§çš„AOFé‡Œï¼Œè¿™æ ·å³ä½¿é‡å†™å¤±è´¥ä¹Ÿèƒ½ä¿è¯æ•°æ®çš„å®‰å…¨ </li><li> å½“å­è¿›ç¨‹å®Œæˆæ–‡ä»¶çš„é‡å†™åï¼Œä¸»è¿›ç¨‹ä¼šè·å¾—ä¸€ä¸ªä¿¡å·ï¼Œç„¶åæŠŠå†…å­˜é‡Œçš„bufferè¿½åŠ åˆ°å­è¿›ç¨‹ç”Ÿæˆçš„é‚£ä¸ªæ–°AOFé‡Œ </li></ol><p><strong>æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®è®¾ç½®æ—¥å¿—é‡å†™çš„æ¡ä»¶ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Redisä¼šè®°ä½è‡ªä»ä¸Šä¸€æ¬¡é‡å†™åAOFæ–‡ä»¶çš„å¤§å°ï¼ˆå¦‚æœè‡ªRediså¯åŠ¨åè¿˜æ²¡é‡å†™è¿‡ï¼Œåˆ™è®°ä½å¯åŠ¨æ—¶ä½¿ç”¨çš„AOFæ–‡ä»¶çš„å¤§å°ï¼‰ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> å¦‚æœå½“å‰çš„æ–‡ä»¶å¤§å°æ¯”èµ·è®°ä½çš„é‚£ä¸ªå¤§å°è¶…è¿‡æŒ‡å®šçš„ç™¾åˆ†æ¯”ï¼Œåˆ™ä¼šè§¦å‘é‡å†™ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> åŒæ—¶éœ€è¦è®¾ç½®ä¸€ä¸ªæ–‡ä»¶å¤§å°æœ€å°å€¼ï¼Œåªæœ‰å¤§äºè¿™ä¸ªå€¼æ–‡ä»¶æ‰ä¼šé‡å†™ï¼Œä»¥é˜²æ–‡ä»¶å¾ˆå°ï¼Œä½†æ˜¯å·²ç»è¾¾åˆ°ç™¾åˆ†æ¯”çš„æƒ…å†µã€‚</span><br><br>auto-aof-rewrite-percentage 100<br>auto-aof-rewrite-min-size 64mb<br></code></pre></td></tr></table></figure><p> è¦ç¦ç”¨è‡ªåŠ¨çš„æ—¥å¿—é‡å†™åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç™¾åˆ†æ¯”è®¾ç½®ä¸º0ï¼š </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">auto-aof-rewrite-percentage 0<br></code></pre></td></tr></table></figure><p><strong>Redis 2.4ä»¥ä¸Šæ‰å¯ä»¥è‡ªåŠ¨è¿›è¡Œæ—¥å¿—é‡å†™ï¼Œä¹‹å‰çš„ç‰ˆæœ¬éœ€è¦æ‰‹åŠ¨è¿è¡Œ<a href="http://redis.io/commands/bgrewriteaof">BGREWRITEAOF</a>è¿™ä¸ªå‘½ä»¤ã€‚</strong> </p><h3 id="æ•°æ®æŸåä¿®å¤"><a href="#æ•°æ®æŸåä¿®å¤" class="headerlink" title="æ•°æ®æŸåä¿®å¤"></a>æ•°æ®æŸåä¿®å¤</h3><p> å¦‚æœå› ä¸ºæŸäº›åŸå› ï¼ˆä¾‹å¦‚æœåŠ¡å™¨å´©æºƒï¼‰AOFæ–‡ä»¶æŸåäº†ï¼Œå¯¼è‡´RedisåŠ è½½ä¸äº†ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œä¿®å¤ï¼š </p><ul><li> å¤‡ä»½AOFæ–‡ä»¶ </li><li> ä½¿ç”¨<code>redis-check-aof</code>å‘½ä»¤ä¿®å¤åŸå§‹çš„AOFæ–‡ä»¶</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-check-aof --fix   aofæ–‡ä»¶<br></code></pre></td></tr></table></figure><ul><li> å¯ä»¥ä½¿ç”¨<code>diff -u</code>å‘½ä»¤çœ‹ä¸‹ä¸¤ä¸ªæ–‡ä»¶çš„å·®å¼‚ </li><li> ä½¿ç”¨ä¿®å¤è¿‡çš„æ–‡ä»¶é‡å¯RedisæœåŠ¡ </li></ul><h3 id="ä»RDBåˆ‡æ¢åˆ°AOF"><a href="#ä»RDBåˆ‡æ¢åˆ°AOF" class="headerlink" title="ä»RDBåˆ‡æ¢åˆ°AOF"></a>ä»RDBåˆ‡æ¢åˆ°AOF</h3><p> è¿™é‡Œåªè¯´Redis &gt;= 2.2ç‰ˆæœ¬çš„æ–¹å¼ï¼š </p><ul><li><p>å¤‡ä»½ä¸€ä¸ªæœ€æ–°çš„<code>dump.rdb</code>çš„æ–‡ä»¶ï¼Œå¹¶æŠŠå¤‡ä»½æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªå®‰å…¨çš„åœ°æ–¹ã€‚</p></li><li><p>è¿è¡Œä»¥ä¸‹ä¸¤æ¡å‘½ä»¤ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">$ redis-cli<span class="hljs-built_in"> config </span><span class="hljs-builtin-name">set</span> appendonly <span class="hljs-literal">yes</span><br>$ redis-cli<span class="hljs-built_in"> config </span><span class="hljs-builtin-name">set</span> save <span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure></li><li><p>ç¡®ä¿æ•°æ®è·Ÿåˆ‡æ¢å‰ä¸€è‡´ã€‚</p></li><li><p>ç¡®ä¿æ•°æ®æ­£ç¡®çš„å†™åˆ°AOFæ–‡ä»¶é‡Œã€‚</p></li></ul><p><strong>ç¬¬äºŒæ¡å‘½ä»¤æ˜¯ç”¨æ¥ç¦ç”¨RDBçš„æŒä¹…åŒ–æ–¹å¼ï¼Œä½†æ˜¯è¿™ä¸æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºä½ å¯ä»¥åŒæ—¶å¯ç”¨ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ã€‚</strong></p><p><strong>è®°å¾—å¯¹é…ç½®æ–‡ä»¶<code>redis.conf</code>è¿›è¡Œç¼–è¾‘å¯ç”¨AOFï¼Œå› ä¸ºå‘½ä»¤è¡Œæ–¹å¼ä¿®æ”¹é…ç½®åœ¨é‡å¯Redisåå°±ä¼šå¤±æ•ˆã€‚</strong></p><h2 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h2><h3 id="å»ºè®®çš„å¤‡ä»½æ–¹æ³•ï¼š"><a href="#å»ºè®®çš„å¤‡ä»½æ–¹æ³•ï¼š" class="headerlink" title="å»ºè®®çš„å¤‡ä»½æ–¹æ³•ï¼š"></a>å»ºè®®çš„å¤‡ä»½æ–¹æ³•ï¼š</h3><ul><li>åˆ›å»ºä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¯å°æ—¶å’Œæ¯å¤©åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼Œä¿å­˜åœ¨ä¸åŒçš„æ–‡ä»¶å¤¹é‡Œã€‚</li><li>å®šæ—¶ä»»åŠ¡è¿è¡Œæ—¶ï¼ŒæŠŠå¤ªæ—§çš„æ–‡ä»¶è¿›è¡Œåˆ é™¤ã€‚ä¾‹å¦‚åªä¿ç•™48å°æ—¶çš„æŒ‰å°æ—¶åˆ›å»ºçš„å¿«ç…§å’Œä¸€åˆ°ä¸¤ä¸ªæœˆçš„æŒ‰å¤©åˆ›å»ºçš„å¿«ç…§ã€‚</li><li>æ¯å¤©ç¡®ä¿ä¸€æ¬¡æŠŠå¿«ç…§æ–‡ä»¶ä¼ è¾“åˆ°æ•°æ®ä¸­å¿ƒå¤–çš„åœ°æ–¹è¿›è¡Œä¿å­˜ï¼Œè‡³å°‘ä¸èƒ½ä¿å­˜åœ¨RedisæœåŠ¡æ‰€åœ¨çš„æœåŠ¡å™¨ã€‚</li></ul><p>å‚è€ƒï¼š</p><hr><p>â€‹      <a href="https://segmentfault.com/a/1190000002906345">https://segmentfault.com/a/1190000002906345</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redis.confè¯¦è§£</title>
    <link href="/2021/09/29/redis-conf%E8%AF%A6%E8%A7%A3/"/>
    <url>/2021/09/29/redis-conf%E8%AF%A6%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>ä»¥ä¸‹å°†ä»é…ç½®æ–‡ä»¶ä¸­é¡ºåºå¾€ä¸‹è®²è§£</strong>,<strong>æ¶‰åŠä¸»ä»å¤åˆ¶ï¼ŒæŒä¹…åŒ–å°†ä¼šå¦èµ·è®²è§£</strong></p><h4 id="å•ä½"><a href="#å•ä½" class="headerlink" title="å•ä½"></a>å•ä½</h4><p><img src="/img/work/1632924192904.png"></p><p>1.é…ç½®æ–‡ä»¶unitå•ä½å¤§å°å†™ä¸æ•æ„Ÿ</p><h4 id="åŒ…å«"><a href="#åŒ…å«" class="headerlink" title="åŒ…å«"></a>åŒ…å«</h4><p><img src="/img/work/1632924269484.png"></p><p>ç±»ä¼¼æˆ‘ä»¬nginxä¸­çš„includeä¸­çš„åŒ…å«æ–‡ä»¶</p> <span id="more"></span><h4 id="ç½‘ç»œ"><a href="#ç½‘ç»œ" class="headerlink" title="ç½‘ç»œ"></a>ç½‘ç»œ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">bind 127.0.0.1 # ç»‘å®šçš„ip<br>protected-mode yes # ä¿æŠ¤æ¨¡å¼<br>port 6379 #ç«¯å£è®¾ç½®<br></code></pre></td></tr></table></figure><h4 id="é€šç”¨-GENERAL"><a href="#é€šç”¨-GENERAL" class="headerlink" title="é€šç”¨ GENERAL"></a>é€šç”¨ GENERAL</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell"> daemonize yes #ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œé»˜è®¤æ˜¯noï¼Œå½“æˆ‘ä»¬éœ€è¦åå°å¯åŠ¨æ—¶éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è®¾ç½®ä¸ºyes<br> <br> pidfile /var/run/redis_6379.pid  #å¦‚æœæˆ‘ä»¬ä»¥åå°æ–¹å¼è¿è¡Œï¼Œæˆ‘ä»¬å°±éœ€è¦æŒ‡å®šä¸€ä¸ªpidæ–‡ä»¶<br> <br><span class="hljs-meta"> </span><br><span class="hljs-meta">#</span><span class="bash">æ—¥å¿—</span> <br><span class="hljs-meta">#</span><span class="bash"> Specify the server verbosity level.</span><br><span class="hljs-meta">#</span><span class="bash">ze yes This can be one of:</span><br><span class="hljs-meta">#</span><span class="bash"> debug (a lot of information, useful <span class="hljs-keyword">for</span> development/testing)</span><br><span class="hljs-meta">#</span><span class="bash"> verbose (many rarely useful info, but not a mess like the debug level)</span><br><span class="hljs-meta">#</span><span class="bash"> notice (moderately verbose, what you want <span class="hljs-keyword">in</span> production probably) ç”Ÿäº§ç¯å¢ƒ</span><br><span class="hljs-meta">#</span><span class="bash"> warning (only very important / critical messages are logged)</span><br>loglevel notice<br><br>logfile &quot;&quot; #æ—¥å¿—çš„æ–‡ä»¶ä½ç½®å<br><br>databases 16  #æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯16ä¸ªæ•°æ®åº“<br><br>always-show-logo no #æ˜¯å¦æ€»æ˜¯æ˜¾ç¤ºæ—¥å¿—<br><br> <br></code></pre></td></tr></table></figure><h4 id="å¿«ç…§"><a href="#å¿«ç…§" class="headerlink" title="å¿«ç…§"></a>å¿«ç…§</h4><p><strong>æŒä¹…åŒ–ï¼Œåœ¨è§„å®šçš„æ—¶é—´å†…ï¼Œæ‰§è¡Œäº†å¤šå°‘æ¬¡æ“ä½œï¼Œåˆ™ä¼šæŒä¹…åŒ–åˆ°æ–‡ä»¶.rdb.aof</strong>, <strong>redisæ˜¯å†…å­˜æ•°æ®åº“,å¦‚æœæ²¡æœ‰æŒä¹…åŒ–ï¼Œé‚£ä¹ˆæ•°æ®æ–­ç”µå³ä¸¢å¤±</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">å¦‚æœ3600så†…ï¼Œå¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªkeyè¿›è¡Œäº†ä¿®æ”¹ï¼Œå³è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span><br>save 3600 1<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">å¦‚æœ300Så†…ï¼Œå¦‚æœè‡³å°‘300Så†…ï¼Œè‡³å°‘æœ‰10ä¸ªå¯ä»¥è¿›è¡Œäº†ä¿®æ”¹ï¼Œå³è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span><br>save 300 10<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">å¦‚æœ60Så†…ï¼Œå¦‚æœè‡³å°‘10000ä¸ªè¿›è¡Œäº†ä¿®æ”¹ï¼Œå³è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span><br>save 60 10000<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">åç»­æŒä¹…åŒ–é…ç½®éœ€è¦ç”¨åˆ°è¿™é‡Œ</span><br><br>stop-writes-on-bgsave-error yes #æŒä¹…åŒ–å¦‚æœå‡ºé”™ï¼Œæ˜¯å¦ç»§ç»­æŒä¹…åŒ–<br><br>rdbcompression yes #æ˜¯å¦å‹ç¼©rdbæ–‡ä»¶,ä¼šæ¶ˆè€—ä¸€äº›CPUèµ„æº<br><br>rdbchecksum yes  #ä¿å­˜rdbæ–‡ä»¶çš„æ—¶å€™ï¼Œè¿›è¡Œé”™è¯¯çš„æ ¸æŸ¥æ ¡éªŒï¼<br><br>dbfilename dump.rdb # æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œä¸€èˆ¬é‡‡ç”¨é»˜è®¤çš„ dump.rdb<br><br>dir ./  #æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼Œä¸€èˆ¬ä¹Ÿç”¨é»˜è®¤é…ç½®<br><br><br><br><br><br></code></pre></td></tr></table></figure><h4 id="SECURITY-å®‰å…¨"><a href="#SECURITY-å®‰å…¨" class="headerlink" title="SECURITY å®‰å…¨"></a>SECURITY å®‰å…¨</h4><p><img src="/img/work/1632927510924.png"></p><p> <strong>å¯ä»¥åœ¨è¿™é‡Œè®¾ç½®redisçš„å¯†ç ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯†ç ï¼</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">               <br>requirepass 123456  #è®¾ç½®å¯†ç ï¼Œè®¾ç½®åéœ€è¦é‡å¯æœåŠ¡æ‰æœ‰æ•ˆ,è¿™é‡Œè®¾ç½®çš„æ˜¯123456<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">å½“æˆ‘ä»¬ç™»å½•ä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤å°†ä¼šå‡ºç°ä»¥ä¸‹æç¤ºéœ€è¦è®¤è¯</span><br>(error) NOAUTH Authentication required.<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è®¤è¯å³å¯æ­£å¸¸æ“ä½œ</span><br>127.0.0.1:6379&gt; auth 123456<br>OK<br><br>127.0.0.1:6379&gt; set k1 v1<br>OK<br>127.0.0.1:6379&gt; get k1<br>&quot;v1&quot;<br><br></code></pre></td></tr></table></figure><h4 id="é™åˆ¶-CLIENTS"><a href="#é™åˆ¶-CLIENTS" class="headerlink" title="é™åˆ¶ CLIENTS"></a>é™åˆ¶ CLIENTS</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br>maxclients 10000  #è®¾ç½®èƒ½è¿æ¥ä¸Šredisçš„æœ€å¤§å®¢æˆ·ç«¯çš„æ•°é‡<br><br>maxmemory &lt;bytes&gt; #redisé…ç½®æœ€å¤§çš„å†…å­˜å®¹é‡<br><br><br><br>maxmemory-policy noeviction # å†…å­˜è¾¾åˆ°ä¸Šé™åçš„å¤„ç†ç­–ç•¥<br><span class="hljs-meta">#</span><span class="bash"> volatile-lru -&gt; Evict using approximated LRU, only keys with an expire <span class="hljs-built_in">set</span>.</span><br><span class="hljs-meta">#</span><span class="bash"> allkeys-lru -&gt; Evict any key using approximated LRU.</span><br><span class="hljs-meta">#</span><span class="bash"> volatile-lfu -&gt; Evict using approximated LFU, only keys with an expire <span class="hljs-built_in">set</span>.</span><br><span class="hljs-meta">#</span><span class="bash"> allkeys-lfu -&gt; Evict any key using approximated LFU.</span><br><span class="hljs-meta">#</span><span class="bash"> volatile-random -&gt; Remove a random key having an expire <span class="hljs-built_in">set</span>.</span><br><span class="hljs-meta">#</span><span class="bash"> allkeys-random -&gt; Remove a random key, any key.</span><br><span class="hljs-meta">#</span><span class="bash"> volatile-ttl -&gt; Remove the key with the nearest expire time (minor TTL)</span><br><span class="hljs-meta">#</span><span class="bash"> noeviction -&gt; Don<span class="hljs-string">&#x27;t evict anything, just return an error on write operations.</span></span><br>        1. volatile-lru: åªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyè¿›è¡ŒLRU(é»˜è®¤å€¼)<br>        2. allkeys-lruï¼š åˆ é™¤lruç®—æ³•çš„key<br>        3. volatile-randomï¼šéšæœºåˆ é™¤å³å°†è¿‡æœŸkey<br>        4. allkeys-randomï¼šéšæœºåˆ é™¤<br>        5. volatile-ttlï¼š åˆ é™¤å³å°†è¿‡æœŸçš„<br>        6. noeviction ï¼š æ°¸ä¸è¿‡æœŸï¼Œè¿”å›é”™è¯¯<br>        7. volatile-lfuï¼šä½¿ç”¨è¿‘ä¼¼ LFU é©±é€ï¼Œåªæœ‰è®¾ç½®è¿‡æœŸçš„é”®<br><br></code></pre></td></tr></table></figure><h4 id="APPEND-ONLY-æ¨¡å¼-aofé…ç½®"><a href="#APPEND-ONLY-æ¨¡å¼-aofé…ç½®" class="headerlink" title="APPEND ONLY æ¨¡å¼ aofé…ç½®"></a>APPEND ONLY æ¨¡å¼ aofé…ç½®</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">appendonly no #é»˜è®¤æ˜¯ä¸å¼€å¯aofæ¨¡å¼çš„ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨rdbæ–¹å¼æŒä¹…åŒ–çš„ï¼Œåœ¨å¤§éƒ¨åˆ†æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œrdbå®Œå…¨å¤Ÿç”¨ï¼<br>appendfilename &quot;appendonly.aof&quot; #æŒä¹…åŒ–åç§°<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> appendfsync always   <span class="hljs-comment">#æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsyncã€‚æ¶ˆè€—æ€§èƒ½</span></span><br>appendfsync everysec   #æ¯ç§’æ‰§è¡Œä¸€æ¬¡syncï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™1Sçš„æ•°æ®<br><span class="hljs-meta">#</span><span class="bash"> appendfsync no       <span class="hljs-comment">#ä¸æ‰§è¡Œ syncï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«ï¼</span></span><br></code></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><p>â€‹       Bç«™ç‹‚ç¥è¯´Java:<a href="https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0</a></p><p>â€‹      Redis.Confé…ç½®æ–‡ä»¶</p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisäº‹åŠ¡</title>
    <link href="/2021/09/28/Redis%E4%BA%8B%E5%8A%A1/"/>
    <url>/2021/09/28/Redis%E4%BA%8B%E5%8A%A1/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>äº‹åŠ¡</p></blockquote><p> rediså•æ¡å‘½ä»¤æ˜¯åŸå­æ€§çš„ï¼Œä½†æ˜¯äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§ </p><p>redisäº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆï¼ä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ï¼Œåœ¨äº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¼šæŒ‰ç…§é¡ºåºæ‰§è¡Œ</p><p> <strong>ä¸€æ¬¡æ€§ã€é¡ºåºæ€§ã€æ’ä»–æ€§</strong>ï¼æ‰§è¡Œä¸€ç³»åˆ—å‘½ä»¤ï¼ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">------ é˜Ÿåˆ— set set set æ‰§è¡Œ------<br></code></pre></td></tr></table></figure><p> <strong>äº‹åŠ¡æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</strong> </p><p>æ‰€æœ‰çš„å‘½ä»¤åœ¨äº‹åŠ¡ä¸­ï¼Œå¹¶æ²¡æœ‰è¢«æ‰§è¡Œï¼åªæœ‰å‘èµ·æ‰§è¡Œçš„å‘½ä»¤çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œï¼Exec</p><p><strong>Rediså•æ¡å‘½ä»¤å¼ä¿å­˜åŸå­æ€§çš„ï¼Œä½†æ˜¯äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§ï¼</strong></p><p>redisäº‹åŠ¡:</p><ul><li>å¼€å§‹äº‹åŠ¡(multi)</li><li>å‘½ä»¤å…¥é˜Ÿ(ã€‚ã€‚ï¼‰</li><li>æ‰§è¡Œäº‹åŠ¡(exec)</li></ul> <span id="more"></span><blockquote><p>æ­£å¸¸æ‰§è¡Œäº‹åŠ¡</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; multi # å¼€å¯äº‹åŠ¡<br>OK<br><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤å…¥é˜Ÿ</span><br>127.0.0.1:6379&gt; set k1 v1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; get k2<br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; exec # æ‰§è¡Œäº‹åŠ¡<br>1) OK<br>2) OK<br>3) &quot;v2&quot;<br>4) OK<br></code></pre></td></tr></table></figure><blockquote><p>æ”¾å¼ƒäº‹åŠ¡</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; set key1 v1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2 <br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; set k4 v4<br>QUEUED<br>127.0.0.1:6379&gt; DISCARD  # å–æ¶ˆäº‹åŠ¡<br>OK<br>127.0.0.1:6379&gt; GET k4  # äº‹åŠ¡é˜Ÿåˆ—ä¸­å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œ<br>(nil)<br></code></pre></td></tr></table></figure><blockquote><p> ç¼–è¯‘å‹å¼‚å¸¸(ä»£ç æœ‰é—®é¢˜ï¼Œå‘½ä»¤æœ‰é”™è¯¯)ï¼Œäº‹åŠ¡ä¸­æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œ </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; MULTI <br>OK<br>127.0.0.1:6379&gt; set k1 v1 <br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2 <br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3 <br>QUEUED<br>127.0.0.1:6379&gt; getset k3  # é”™è¯¯çš„å‘½ä»¤<br>(error) ERR wrong number of arguments for &#x27;getset&#x27; command<br>127.0.0.1:6379&gt; et k4 v4  # é”™è¯¯çš„å‘½ä»¤<br>(error) ERR unknown command `et`, with args beginning with: `k4`, `v4`, <br>127.0.0.1:6379&gt; set k4 v4<br>QUEUED<br>127.0.0.1:6379&gt; exec<br>(error) EXECABORT Transaction discarded because of previous errors.<br>127.0.0.1:6379&gt; get k4 # æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼<br>(nil)<br></code></pre></td></tr></table></figure><blockquote><p> è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆ1/0ï¼‰ï¼Œ å¦‚æœäº‹åŠ¡é˜Ÿåˆ—ä¸­å­˜åœ¨è¯­æ³•æ€§ï¼Œé‚£ä¹ˆæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œå…¶ä»–å‘½ä»¤æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œ çš„ï¼Œé”™è¯¯å‘½ä»¤æŠ›å‡ºå¼‚å¸¸ï¼  </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; set k1 &quot;v1&quot;<br>OK<br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; incr k1 # ä¼šæ‰§è¡Œçš„æ—¶å€™å¤±è´¥ï¼<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; get k3<br>QUEUED<br>127.0.0.1:6379&gt; exec<br>1) (error) ERR value is not an integer or out of range # è™½ç„¶ç¬¬ä¸€æ¡å‘½ä»¤æŠ¥é”™äº†ï¼Œä½†æ˜¯<br>ä¾æ—§æ­£å¸¸æ‰§è¡ŒæˆåŠŸäº†ï¼<br>2) OK<br>3) OK<br>4) &quot;v3&quot;<br>127.0.0.1:6379&gt; get k2<br>&quot;v2&quot;<br>127.0.0.1:6379&gt; get k3<br>&quot;v3&quot;<br></code></pre></td></tr></table></figure><blockquote><p> ç›‘æ§ï¼ Watch ï¼ˆé¢è¯•å¸¸é—®ï¼ï¼‰  </p></blockquote><p> <strong>æ‚²è§‚é”</strong>ï¼š</p><ul><li>å¾ˆæ‚²è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¼šå‡ºé—®é¢˜ï¼Œæ— è®ºåšä»€ä¹ˆéƒ½ä¼šåŠ é”ï¼ </li></ul><p> ä¹è§‚é”ï¼š </p><ul><li> å¾ˆä¹è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¸ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼ æ›´æ–°æ•°æ®çš„æ—¶å€™å»åˆ¤æ–­ä¸€ä¸‹ï¼Œåœ¨æ­¤æœŸé—´æ˜¯å¦ æœ‰äººä¿®æ”¹è¿‡è¿™ä¸ªæ•°æ®ï¼Œ è·å–version </li><li> æ›´æ–°çš„æ—¶å€™æ¯”è¾ƒ version</li></ul><blockquote><p> Redisæµ‹ç›‘è§†æµ‹è¯• </p></blockquote><p> æ­£å¸¸æ‰§è¡ŒæˆåŠŸï¼ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; set money 100<br>OK<br>127.0.0.1:6379&gt; set out 0<br>OK<br>127.0.0.1:6379&gt; watch money # ç›‘è§† money å¯¹è±¡<br>OK<br>127.0.0.1:6379&gt; multi # äº‹åŠ¡æ­£å¸¸ç»“æŸï¼Œæ•°æ®æœŸé—´æ²¡æœ‰å‘ç”Ÿå˜åŠ¨ï¼Œè¿™ä¸ªæ—¶å€™å°±æ­£å¸¸æ‰§è¡ŒæˆåŠŸï¼<br>OK<br>127.0.0.1:6379&gt; DECRBY money 20<br>QUEUED<br>127.0.0.1:6379&gt; INCRBY out 20<br>QUEUED<br>127.0.0.1:6379&gt; exec<br>1) (integer) 80<br>2) (integer) 20<br></code></pre></td></tr></table></figure><p> æµ‹è¯•å¤šçº¿ç¨‹ä¿®æ”¹å€¼ , ä½¿ç”¨watch å¯ä»¥å½“åšredisçš„ä¹è§‚é”æ“ä½œï¼ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; watch money # ç›‘è§† money<br>OK<br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; DECRBY money 10<br>QUEUED<br>127.0.0.1:6379&gt; INCRBY out 10<br>QUEUED<br>127.0.0.1:6379&gt; exec # æ‰§è¡Œä¹‹å‰ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œä¿®æ”¹äº†æˆ‘ä»¬çš„å€¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šå¯¼è‡´äº‹åŠ¡æ‰§è¡Œå¤±<br>è´¥ï¼<br>(nil)<br></code></pre></td></tr></table></figure><p> å¦‚æœä¿®æ”¹å¤±è´¥ï¼Œè·å–æœ€æ–°çš„å€¼å°±å¥½  </p><p>å‚è€ƒï¼š<a href="https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=8440565446323209776&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=8440565446323209776&amp;spm_id_from=333.337.0.0</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redisçš„ä¸‰ç§ç‰¹æ®Šç±»å‹</title>
    <link href="/2021/09/26/Redis%E7%9A%84%E4%B8%89%E7%A7%8D%E7%89%B9%E6%AE%8A%E7%B1%BB%E5%9E%8B/"/>
    <url>/2021/09/26/Redis%E7%9A%84%E4%B8%89%E7%A7%8D%E7%89%B9%E6%AE%8A%E7%B1%BB%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹"><a href="#ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹" class="headerlink" title="ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹"></a>ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹</h2><h3 id="Geospatial-åœ°ç†ä½ç½®"><a href="#Geospatial-åœ°ç†ä½ç½®" class="headerlink" title="Geospatial åœ°ç†ä½ç½®"></a>Geospatial åœ°ç†ä½ç½®</h3><p><strong>æœ‹å‹çš„å®šä½ï¼Œé™„è¿‘çš„äººï¼Œæ‰“è½¦è·ç¦»è®¡ç®—ï¼Ÿ Redis çš„ Geo åœ¨Redis3.2 ç‰ˆæœ¬å°±æ¨å‡ºäº†ï¼ è¿™ä¸ªåŠŸèƒ½å¯ä»¥æ¨ç®—åœ°ç†ä½ç½®çš„ä¿¡æ¯ï¼Œä¸¤åœ°ä¹‹é—´çš„è·ç¦»ï¼Œæ–¹åœ† å‡ é‡Œçš„äººï¼</strong> </p> <span id="more"></span><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.redis.net.cn/order/3685.html">https://www.redis.net.cn/order/3685.html</a></p><p>ä»å®˜ç½‘ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ­¤æ•°æ®ç±»å‹åªæœ‰<strong>å…­ä¸ªå‘½ä»¤</strong></p><p><img src="/img/work/1632661034050.png"></p><p>ä¸‹é¢å°±åˆ†åˆ«ä¸¾ä¾‹æ¥åšä»‹ç»</p><blockquote><h4 id="GEOADD"><a href="#GEOADD" class="headerlink" title="GEOADD"></a><strong>GEOADD</strong></h4></blockquote><p>å®˜æ–¹è¯´æ˜ï¼šå°†æŒ‡å®šçš„åœ°ç†ç©ºé—´ä½ç½®ï¼ˆçº¬åº¦ã€ç»åº¦ã€åç§°ï¼‰æ·»åŠ åˆ°æŒ‡å®šçš„keyä¸­</p><p> è¯¥å‘½ä»¤ä»¥é‡‡ç”¨æ ‡å‡†æ ¼å¼çš„å‚æ•°x,y,æ‰€ä»¥ç»åº¦å¿…é¡»åœ¨çº¬åº¦ä¹‹å‰ ï¼Œ è§„å®šæœ‰å¦‚ä¸‹</p><ol><li> æœ‰æ•ˆçš„ç»åº¦ä»-180åº¦åˆ°180åº¦ </li><li>æœ‰æ•ˆçš„çº¬åº¦ä»-85.05112878åº¦åˆ°85.05112878åº¦ã€‚</li><li> å½“åæ ‡ä½ç½®è¶…å‡ºä¸Šè¿°æŒ‡å®šèŒƒå›´æ—¶ï¼Œè¯¥å‘½ä»¤å°†ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ </li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">geoä½¿ç”¨ä¸¾ä¾‹</span><br><span class="hljs-meta">#</span><span class="bash">é€šè¿‡ç™¾åº¦åæ ‡æ‹¾å–å¯ä»¥è·å–æŒ‡å®šåŸå¸‚åæ ‡ 106.680848,26.642216 å½“å‰æˆ‘è·å–çš„æ˜¯è‡ªå·±æ‰€åœ¨åŸå¸‚çš„åæ ‡</span><br>127.0.0.1:6379&gt; GEOADD china:city 106.680848 26.642216 guiyang<br>(integer) 1<br><br>127.0.0.1:6379&gt; GEOADD china:city 121.466742 31.231236 shanghai<br>(integer) 1<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">å¯ä»¥åŒæ—¶æ·»åŠ å¤šä¸ªåæ ‡</span><br>127.0.0.1:6379&gt; GEOADD china:city 114.100924 22.675499 shengzhen  106.561887 29.564724 chongqing<br>(integer) 2<br><br></code></pre></td></tr></table></figure><blockquote><p><strong>GEOPOS</strong>  </p></blockquote><p> ä»<code>key</code>é‡Œè¿”å›æ‰€æœ‰ç»™å®šä½ç½®å…ƒç´ çš„ä½ç½®ï¼ˆç»åº¦å’Œçº¬åº¦ï¼‰ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">éœ€è¦å…ˆæŒ‡å®š</span><br>127.0.0.1:6379&gt; GEOPOS china:city shanghai shengzhen<br>1) 1) &quot;121.46674007177352905&quot;<br>   2) &quot;31.23123598368359666&quot;<br>2) 1) &quot;114.10092204809188843&quot;<br>   2) &quot;22.6755001616335008&quot;<br></code></pre></td></tr></table></figure><blockquote><p> <strong>GEODIST</strong> </p></blockquote><p>è·å–ä¸¤ä¸ªç»™å®šä½ç½®ä¹‹é—´çš„è·ç¦», å¦‚æœä¸¤ä¸ªä½ç½®ä¹‹é—´çš„å…¶ä¸­ä¸€ä¸ªä¸å­˜åœ¨ï¼Œ é‚£ä¹ˆå‘½ä»¤è¿”å›ç©ºå€¼ </p><p>æŒ‡å®šå•ä½çš„å‚æ•° unit å¿…é¡»æ˜¯ä»¥ä¸‹å•ä½çš„å…¶ä¸­ä¸€ä¸ªï¼š</p><ul><li><strong>m</strong> è¡¨ç¤ºå•ä½ä¸ºç±³ã€‚</li><li><strong>km</strong> è¡¨ç¤ºå•ä½ä¸ºåƒç±³ã€‚</li><li><strong>mi</strong> è¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œã€‚</li><li><strong>ft</strong> è¡¨ç¤ºå•ä½ä¸ºè‹±å°ºã€‚</li></ul><p>å¦‚æœç”¨æˆ·æ²¡æœ‰æ˜¾å¼åœ°æŒ‡å®šå•ä½å‚æ•°ï¼Œ é‚£ä¹ˆ <code>GEODIST</code> é»˜è®¤ä½¿ç”¨ç±³ä½œä¸ºå•ä½ã€‚</p><p><code>GEODIST</code> å‘½ä»¤åœ¨è®¡ç®—è·ç¦»æ—¶ä¼šå‡è®¾åœ°çƒä¸ºå®Œç¾çš„çƒå½¢ï¼Œ åœ¨æé™æƒ…å†µä¸‹ï¼Œ è¿™ä¸€å‡è®¾æœ€å¤§ä¼šé€ æˆ 0.5% çš„è¯¯å·®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">è¾“å…¥ä¸¤ä¸ªåŸå¸‚  å¹¶æŒ‡å®šè®¡é‡å•ä½ è¿™é‡ŒæŒ‡å®šçš„km</span><br>127.0.0.1:6379&gt; GEODIST china:city shanghai chongqing km<br>&quot;1440.7483&quot;<br><br></code></pre></td></tr></table></figure><blockquote><p><strong>GEORADIUS</strong></p></blockquote><p>ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ æ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ </p><p>èŒƒå›´å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å…¶ä¸­ä¸€ä¸ªå•ä½ï¼š</p><ul><li><strong>m</strong> è¡¨ç¤ºå•ä½ä¸ºç±³ã€‚</li><li><strong>km</strong> è¡¨ç¤ºå•ä½ä¸ºåƒç±³ã€‚</li><li><strong>mi</strong> è¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œã€‚</li><li><strong>ft</strong> è¡¨ç¤ºå•ä½ä¸ºè‹±å°ºã€‚</li></ul><p>åœ¨ç»™å®šä»¥ä¸‹å¯é€‰é¡¹æ—¶ï¼Œ å‘½ä»¤ä¼šè¿”å›é¢å¤–çš„ä¿¡æ¯ï¼š</p><ul><li><code>WITHDIST</code>: åœ¨è¿”å›ä½ç½®å…ƒç´ çš„åŒæ—¶ï¼Œ å°†ä½ç½®å…ƒç´ ä¸ä¸­å¿ƒä¹‹é—´çš„è·ç¦»ä¹Ÿä¸€å¹¶è¿”å›ã€‚ è·ç¦»çš„å•ä½å’Œç”¨æˆ·ç»™å®šçš„èŒƒå›´å•ä½ä¿æŒä¸€è‡´ã€‚</li><li><code>WITHCOORD</code>: å°†ä½ç½®å…ƒç´ çš„ç»åº¦å’Œç»´åº¦ä¹Ÿä¸€å¹¶è¿”å›ã€‚</li><li><code>WITHHASH</code>: ä»¥ 52 ä½æœ‰ç¬¦å·æ•´æ•°çš„å½¢å¼ï¼Œ è¿”å›ä½ç½®å…ƒç´ ç»è¿‡åŸå§‹ geohash ç¼–ç çš„æœ‰åºé›†åˆåˆ†å€¼ã€‚ è¿™ä¸ªé€‰é¡¹ä¸»è¦ç”¨äºåº•å±‚åº”ç”¨æˆ–è€…è°ƒè¯•ï¼Œ å®é™…ä¸­çš„ä½œç”¨å¹¶ä¸å¤§ã€‚</li></ul><p>å‘½ä»¤é»˜è®¤è¿”å›æœªæ’åºçš„ä½ç½®å…ƒç´ ã€‚ é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°ï¼Œ ç”¨æˆ·å¯ä»¥æŒ‡å®šè¢«è¿”å›ä½ç½®å…ƒç´ çš„æ’åºæ–¹å¼ï¼š</p><ul><li><code>ASC</code>: æ ¹æ®ä¸­å¿ƒçš„ä½ç½®ï¼Œ æŒ‰ç…§ä»è¿‘åˆ°è¿œçš„æ–¹å¼è¿”å›ä½ç½®å…ƒç´ ã€‚</li><li><code>DESC</code>: æ ¹æ®ä¸­å¿ƒçš„ä½ç½®ï¼Œ æŒ‰ç…§ä»è¿œåˆ°è¿‘çš„æ–¹å¼è¿”å›ä½ç½®å…ƒç´ ã€‚</li></ul><p>ä¾‹å¦‚ï¼š</p><p> æˆ‘é™„è¿‘çš„äººï¼Ÿ ï¼ˆè·å¾—æ‰€æœ‰é™„è¿‘çš„äººçš„åœ°å€ï¼Œå®šä½ï¼ï¼‰é€šè¿‡åŠå¾„æ¥æŸ¥è¯¢ï¼ è·å¾—æŒ‡å®šæ•°é‡çš„äºº</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">ä»¥110ï¼Œ30 è¿™ä¸ªç»åº¦ä¸ºä¸­å¿ƒå¯»æ‰¾æ–¹åœ†ä¸€åƒå…¬é‡Œä»¥å†…çš„åŸå¸‚</span><br>127.0.0.1:6379&gt; GEORADIUS china:city  110 30 1000 km<br>1) &quot;guiyang&quot;<br>2) &quot;chongqing&quot;<br>3) &quot;shengzhen&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> å°†å…·ä½“è·ç¦»ã€ç»çº¬åº¦ä¿¡æ¯ä¹Ÿä¸€å¹¶è¿”å›</span><br>127.0.0.1:6379&gt; GEORADIUS china:city  110 30 1000 km WITHCOORD WITHDIST<br>1) 1) &quot;guiyang&quot;<br>   2) &quot;495.0114&quot;<br>   3) 1) &quot;106.68084830045700073&quot;<br>      2) &quot;26.64221710938331711&quot;<br>2) 1) &quot;chongqing&quot;<br>   2) &quot;335.3982&quot;<br>   3) 1) &quot;106.56188696622848511&quot;<br>      2) &quot;29.56472525888953129&quot;<br>3) 1) &quot;shengzhen&quot;<br>   2) &quot;911.2583&quot;<br>   3) 1) &quot;114.10092204809188843&quot;<br>      2) &quot;22.6755001616335008&quot;<br></code></pre></td></tr></table></figure><blockquote><p>GEORADIUSBYMEMBER</p></blockquote><p>æ‰¾å‡ºä½äºæŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼Œä¸­å¿ƒç‚¹æ˜¯ç”±ç»™å®šçš„ä½ç½®å…ƒç´ å†³å®š</p><p>è¿™ä¸ªå‘½ä»¤å’Œ <a href="https://www.redis.net.cn/order/3689.html">GEORADIUS</a> å‘½ä»¤ä¸€æ ·ï¼Œ éƒ½å¯ä»¥æ‰¾å‡ºä½äºæŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼Œ ä½†æ˜¯ <code>GEORADIUSBYMEMBER</code> çš„ä¸­å¿ƒç‚¹æ˜¯ç”±ç»™å®šçš„ä½ç½®å…ƒç´ å†³å®šçš„ï¼Œ è€Œä¸æ˜¯åƒ <a href="https://www.redis.net.cn/order/3689.html">GEORADIUS</a> é‚£æ ·ï¼Œ ä½¿ç”¨è¾“å…¥çš„ç»åº¦å’Œçº¬åº¦æ¥å†³å®šä¸­å¿ƒç‚¹ </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ‰¾å‡ºä½äºæŒ‡å®šå…ƒç´ å‘¨å›´çš„å…¶ä»–å…ƒç´ ï¼</span><br>127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city chongqing 500 km<br>1) &quot;guiyang&quot;<br>2) &quot;chongqing&quot;<br></code></pre></td></tr></table></figure><p> GEO åº•å±‚çš„å®ç°åŸç†å…¶å®å°±æ˜¯ Zsetï¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Zsetå‘½ä»¤æ¥æ“ä½œgeo </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; ZRANGE china:city 0 -1 # æŸ¥çœ‹åœ°å›¾ä¸­å…¨éƒ¨çš„å…ƒç´ <br>1) &quot;chongqi&quot;<br>2) &quot;xian&quot;<br>3) &quot;shengzhen&quot;<br>4) &quot;hangzhou&quot;<br>5) &quot;shanghai&quot;<br>6) &quot;beijing&quot;<br>127.0.0.1:6379&gt; zrem china:city beijing # ç§»é™¤æŒ‡å®šå…ƒç´ ï¼<br>(integer) 1<br>127.0.0.1:6379&gt; ZRANGE china:city 0 -1<br>1) &quot;chongqi&quot;<br>2) &quot;xian&quot;<br>3) &quot;shengzhen&quot;<br>4) &quot;hangzhou&quot;<br>5) &quot;shanghai&quot;<br></code></pre></td></tr></table></figure><h3 id="Hyperloglog"><a href="#Hyperloglog" class="headerlink" title="Hyperloglog"></a>Hyperloglog</h3><blockquote><p>ä»€ä¹ˆæ˜¯åŸºæ•°ï¼Ÿ</p></blockquote><p> æ¯”å¦‚æ•°æ®é›† {1, 3, 5, 7, 5, 7, 8}ï¼Œ é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†çš„åŸºæ•°é›†ä¸º {1, 3, 5 ,7, 8}, åŸºæ•°(ä¸é‡å¤å…ƒç´ )ä¸º5ã€‚ åŸºæ•°ä¼°è®¡å°±æ˜¯åœ¨è¯¯å·®å¯æ¥å—çš„èŒƒå›´å†…ï¼Œå¿«é€Ÿè®¡ç®—åŸºæ•°ã€‚ </p><blockquote><p>ç®€ä»‹</p></blockquote><p>Redis 2.8.9 ç‰ˆæœ¬å°±æ›´æ–°äº† Hyperloglog æ•°æ®ç»“æ„ï¼ Redis Hyperloglog åŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼</p><p>ä¼˜ç‚¹ï¼šå ç”¨çš„å†…å­˜æ˜¯å›ºå®šï¼Œ2^64 ä¸åŒçš„å…ƒç´ çš„æŠ€æœ¯ï¼Œåªéœ€è¦åºŸ 12KBå†…å­˜ï¼å¦‚æœè¦ä»å†…å­˜è§’åº¦æ¥æ¯”è¾ƒçš„è¯ Hyperloglog é¦–é€‰ï¼</p><p>ç½‘é¡µçš„ UV ï¼ˆä¸€ä¸ªäººè®¿é—®ä¸€ä¸ªç½‘ç«™å¤šæ¬¡ï¼Œä½†æ˜¯è¿˜æ˜¯ç®—ä½œä¸€ä¸ªäººï¼ï¼‰</p><p>ä¼ ç»Ÿçš„æ–¹å¼ï¼Œ set ä¿å­˜ç”¨æˆ·çš„idï¼Œç„¶åå°±å¯ä»¥ç»Ÿè®¡ set ä¸­çš„å…ƒç´ æ•°é‡ä½œä¸ºæ ‡å‡†åˆ¤æ–­ ! è¿™ä¸ªæ–¹å¼å¦‚æœä¿å­˜å¤§é‡çš„ç”¨æˆ·idï¼Œå°±ä¼šæ¯”è¾ƒéº»çƒ¦ï¼æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è®¡æ•°ï¼Œè€Œä¸æ˜¯ä¿å­˜ç”¨æˆ·idï¼›</p><p>0.81% é”™è¯¯ç‡ï¼ ç»Ÿè®¡UVä»»åŠ¡ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡çš„ï¼</p><blockquote><p>å®ä¾‹</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql">redis <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> PFADD w3ckey &quot;redis&quot;<br> <br><span class="hljs-number">1</span>) (<span class="hljs-type">integer</span>) <span class="hljs-number">1</span><br> <br>redis <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> PFADD w3ckey &quot;mongodb&quot;<br> <br><span class="hljs-number">1</span>) (<span class="hljs-type">integer</span>) <span class="hljs-number">1</span><br> <br>redis <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> PFADD w3ckey &quot;mysql&quot;<br> <br><span class="hljs-number">1</span>) (<span class="hljs-type">integer</span>) <span class="hljs-number">1</span><br> <br>redis <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> PFCOUNT w3ckey<br> <br>(<span class="hljs-type">integer</span>) <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>å¦‚æœå…è®¸å®¹é”™ï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥ä½¿ç”¨ Hyperloglog</p><p>å¦‚æœä¸å…è®¸å®¹é”™ï¼Œå°±ä½¿ç”¨ set æˆ–è€…è‡ªå·±çš„æ•°æ®ç±»å‹å³å¯</p><h3 id="Bitmap"><a href="#Bitmap" class="headerlink" title="Bitmap"></a>Bitmap</h3><blockquote><p>ä½å­˜å‚¨</p></blockquote><p>ç»Ÿè®¡ç”¨æˆ·ä¿¡æ¯ï¼Œæ´»è·ƒï¼Œä¸æ´»è·ƒï¼ ç™»å½• ã€ æœªç™»å½•ï¼ æ‰“å¡ï¼Œ365æ‰“å¡ï¼ ä¸¤ä¸ªçŠ¶æ€çš„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Bitmapsï¼ Bitmap ä½å›¾ï¼Œæ•°æ®ç»“æ„ï¼ éƒ½æ˜¯æ“ä½œäºŒè¿›åˆ¶ä½æ¥è¿›è¡Œè®°å½•ï¼Œå°±åªæœ‰0 å’Œ 1 ä¸¤ä¸ªçŠ¶æ€ï¼ 365 å¤© = 365 bit 1å­—èŠ‚ = 8bit 46 ä¸ªå­—èŠ‚å·¦å³ï¼</p><blockquote><p>æµ‹è¯•</p></blockquote><p>ä½¿ç”¨bitmap æ¥è®°å½• å‘¨ä¸€åˆ°å‘¨æ—¥çš„æ‰“å¡ï¼</p><p>å‘¨ä¸€ï¼š1 å‘¨äºŒï¼š0 å‘¨ä¸‰ï¼š0 å‘¨å››ï¼š1 â€¦â€¦</p><p><img src="/img/work/1632664931110.png"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> setbit sign <span class="hljs-number">0</span> <span class="hljs-number">1</span> <br>(<span class="hljs-type">integer</span>) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> setbit sign <span class="hljs-number">1</span> <span class="hljs-number">0</span><br>(<span class="hljs-type">integer</span>) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> setbit sign <span class="hljs-number">2</span> <span class="hljs-number">0</span><br>(<span class="hljs-type">integer</span>) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> setbit sign <span class="hljs-number">3</span> <span class="hljs-number">1</span> <br>(<span class="hljs-type">integer</span>) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> setbit sign <span class="hljs-number">4</span> <span class="hljs-number">1</span> <br>(<span class="hljs-type">integer</span>) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> setbit sign <span class="hljs-number">5</span> <span class="hljs-number">1</span><br>(<span class="hljs-type">integer</span>) <span class="hljs-number">0</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> setbit sign <span class="hljs-number">6</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æŸä¸€å¤©æ˜¯å¦æœ‰æ‰“å¡ï¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> getbit sign <span class="hljs-number">3</span><br>(<span class="hljs-type">integer</span>) <span class="hljs-number">1</span><br><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> getbit sign <span class="hljs-number">6</span><br>(<span class="hljs-type">integer</span>) <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>ç»Ÿè®¡æ“ä½œï¼Œç»Ÿè®¡ æ‰“å¡çš„å¤©æ•°ï¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">6379</span><span class="hljs-operator">&gt;</span> bitcount sign # ç»Ÿè®¡è¿™å‘¨çš„æ‰“å¡è®°å½•ï¼Œå°±å¯ä»¥çœ‹åˆ°æ˜¯å¦æœ‰å…¨å‹¤ï¼<br>(<span class="hljs-type">integer</span>) <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><p>â€‹       Rediså®˜ç½‘ï¼š<a href="https://www.redis.net.cn/">https://www.redis.net.cn/</a></p><p>â€‹       Bç«™ç‹‚ç¥è¯´Java:<a href="https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=18051804489571055526&amp;spm_id_from=333.337.0.0</a></p><p>â€‹      </p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RedisåŸºç¡€</title>
    <link href="/2021/09/25/redis%E5%9F%BA%E7%A1%80/"/>
    <url>/2021/09/25/redis%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><blockquote><p>Redisæ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p> Redisï¼ˆRemote Dictionary Server )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI <a href="https://baike.baidu.com/item/C%E8%AF%AD%E8%A8%80">Cè¯­è¨€</a>ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Value<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93/103728">æ•°æ®åº“</a>ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ä»2010å¹´3æœˆ15æ—¥èµ·ï¼ŒRedisçš„å¼€å‘å·¥ä½œç”±VMwareä¸»æŒã€‚ä»2013å¹´5æœˆå¼€å§‹ï¼ŒRedisçš„å¼€å‘ç”±<a href="https://baike.baidu.com/item/Pivotal">Pivotal</a>èµåŠ©ã€‚ </p><p> å…è´¹å’Œå¼€æºï¼æ˜¯å½“ä¸‹æœ€çƒ­é—¨çš„ NoSQL æŠ€æœ¯ä¹‹ä¸€ï¼ä¹Ÿè¢«äººä»¬ç§°ä¹‹ä¸ºç»“æ„åŒ–æ•°æ®åº“ï¼ </p> <span id="more"></span><blockquote><p>Redisä½œç”¨äºé‚£äº›</p></blockquote><ol><li> å†…å­˜å­˜å‚¨ã€æŒä¹…åŒ–ï¼Œå†…å­˜ä¸­æ˜¯æ–­ç”µå³å¤±ã€æ‰€ä»¥è¯´æŒä¹…åŒ–å¾ˆé‡è¦ï¼ˆrdbã€aofï¼‰ </li><li> æ•ˆç‡é«˜ï¼Œå¯ä»¥ç”¨äºé«˜é€Ÿç¼“å­˜ </li><li> å‘å¸ƒè®¢é˜…ç³»ç»Ÿ </li><li> åœ°å›¾ä¿¡æ¯åˆ†æ  </li><li> è®¡æ—¶å™¨ã€è®¡æ•°å™¨ï¼ˆæµè§ˆé‡ï¼ï¼‰  </li><li>â€¦</li></ol><blockquote><p>ä¸»è¦ç‰¹æ€§</p></blockquote><ol><li> å¤šæ ·çš„æ•°æ®ç±»å‹ </li></ol><p>   2ã€æŒä¹…åŒ–</p><p>   3ã€é›†ç¾¤ </p><p>   4ã€äº‹åŠ¡ </p><h2 id="Rediså®‰è£…"><a href="#Rediså®‰è£…" class="headerlink" title="Rediså®‰è£…"></a>Rediså®‰è£…</h2><blockquote><p>Linuxå®‰è£…</p></blockquote><p>Rediså®˜ç½‘åœ°å€: <a href="https://redis.io/">https://redis.io/</a></p><p><img src="/img/work/1632572684797.png"></p><p>1.ä¸‹è½½å,å¯è·å¾—ä¸€ä¸ªtarå‹ç¼©ï¼Œæˆ‘è¿™é‡Œæ”¾åˆ°äº† /optç›®å½•ä¸‹</p><p><img src="/img/work/1632573739375.png"></p><p>2.è§£å‹Rediså®‰è£…åŒ… è§£å‹å‘½ä»¤: tar zxvf redis-6.2.5.tar.gz</p><p><img src="/img/work/1632574069385.png"></p><p>3.è§£å‹ä¹‹åå¯ä»¥çœ‹åˆ°ä¸€ä¸ªredisç›®å½•,è¿›å…¥Redisç›®å½•å¯ä»¥çœ‹åˆ°redis.confçš„ä¸€ä¸ªæ–‡ä»¶</p><p><img src="/img/work/1632574182949.png"></p><p>4.åœ¨redisä¸‹æˆ‘ä»¬é¦–å…ˆè¿›è¡ŒåŸºæœ¬å®‰è£…åŠç¼–è¯‘å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">åŸºç¡€ç¯å¢ƒå®‰è£…</span><br>yum install gcc-c++<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">ç¼–è¯‘</span><br>make<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">å®‰è£… rediså®‰è£…ä¹‹åé»˜è®¤å®‰è£…åœ¨ /usr/<span class="hljs-built_in">local</span>/bin ä¸‹</span><br>make install<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">make PREFIX=/data/redis install  æŒ‡å®šç›®å½•å®‰è£…</span><br><br></code></pre></td></tr></table></figure><p><img src="/img/work/1632575400027.png"></p><p>5.åœ¨å®‰è£…ç›®å½•ä¸‹å¤åˆ¶redis.confæ–‡ä»¶å¤åˆ¶åˆ°å®‰è£…ç›®å½•ä¸‹å³ï¼š/usr/local/bin</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cp redis.conf /usr/local/bin/<br></code></pre></td></tr></table></figure><p>6.ä¿®æ”¹rediså¯åŠ¨æ–¹å¼ï¼Œå› ä¸ºredisé»˜è®¤å¯åŠ¨æ–¹å¼ä¸æ˜¯åå°å¯åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¿›å…¥redis.confä¸­ä¿®æ”¹ä¸ºyes</p><p><img src="/img/work/1632575702117.png"></p><p>7.å¯åŠ¨redisæœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">å¯åŠ¨redisæœåŠ¡</span><br>redis-server etc/redis.conf   #åœ¨binç›®å½•ä¸‹åˆ›å»ºäº†etcç›®å½•  rediså¯åŠ¨éœ€è¦å°†é…ç½®æ–‡ä»¶ä¸€åŒæ“ä½œ<br><br></code></pre></td></tr></table></figure><p>8.è¿æ¥æµ‹è¯•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">è¿æ¥å®¢æˆ·ç«¯å‘½ä»¤ -p æŒ‡å®šç«¯å£</span><br>redis-cli -p 6379<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">å¯ä»¥çœ‹åˆ°è¿æ¥å¹¶pingé€š</span><br>127.0.0.1:6379&gt; ping<br>PONG<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è¿æ¥ä¹‹åå¦‚ä½•æ­£å¸¸é€€å‡ºï¼Ÿ</span><br>127.0.0.1:6379&gt; shutdown #å…ˆå…³é—­ï¼Œé˜²æ­¢æœ‰æ•°æ®è¢«ä¸­æ–­<br>not connected&gt; exit  #é€€å‡º<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æ­¤æ—¶é€šè¿‡æŸ¥çœ‹è¿›ç¨‹æ˜¯å¦å­˜åœ¨</span><br>ps -ef | grep redis<br><br></code></pre></td></tr></table></figure><p>9.æŸ¥çœ‹redisè¿›ç¨‹</p><p><img src="/img/work/1632576417517.png"></p><p>å½“å®¢æˆ·ç«¯è¿æ¥é€€å‡ºåï¼Œä»»åŠ¡è¿›ç¨‹å°†ä¼šä¸å­˜åœ¨</p><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id="redisé»˜è®¤æ•°æ®åº“"><a href="#redisé»˜è®¤æ•°æ®åº“" class="headerlink" title="redisé»˜è®¤æ•°æ®åº“"></a>redisé»˜è®¤æ•°æ®åº“</h3><p>é€šè¿‡æŸ¥çœ‹é…ç½®æ–‡ä»¶</p><p><strong>redisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬0ä¸ªæ•°æ®åº“</strong> </p><p><img src="/img/work/1632576644195.png"></p><p>æˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®åº“è¿›è¡Œé€‰æ‹©</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æ•°æ®ä½¿ç”¨é€‰æ‹©ï¼Œredisé»˜è®¤ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨tableé”®è¿›è¡Œå‘½ä»¤è¡¥å…¨</span><br>127.0.0.1:6379&gt; SELECT 2<br>OK<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹åº“å¤§å°</span><br>127.0.0.1:6379[2]&gt; DBSIZE<br>(integer) 0<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹æ‰€æœ‰key</span><br>127.0.0.1:6379[2]&gt; KEYS *<br></code></pre></td></tr></table></figure><p><strong>æ¸…é™¤å½“å‰æ•°æ®åº“ flushdb</strong></p><p><strong>æ¸…é™¤å…¨éƒ¨æ•°æ®åº“çš„å†…å®¹ FLUSHALL</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; KEYS * <br>1) &quot;name&quot;<br>127.0.0.1:6379&gt; FLUSHDB<br>OK<br>127.0.0.1:6379&gt; KEYS * <br>(empty array)<br>127.0.0.1:6379&gt; <br><br></code></pre></td></tr></table></figure><blockquote><p>Redisæ˜¯å•çº¿ç¨‹</p></blockquote><p> å¤§å®¶åº”è¯¥çŸ¥é“Redisæ˜¯å¾ˆå¿«çš„ï¼Œå®˜æ–¹è¡¨ç¤ºï¼ŒRedisæ˜¯åŸºäºå†…å­˜æ“ä½œï¼ŒCPUä¸æ˜¯Redisæ€§èƒ½ç“¶é¢ˆï¼ŒRedisçš„ç“¶é¢ˆæ˜¯æ ¹æ® æœºå™¨çš„å†…å­˜å’Œç½‘ç»œå¸¦å®½ï¼Œæ—¢ç„¶å¯ä»¥ä½¿ç”¨å•çº¿ç¨‹æ¥å®ç°ï¼Œå°±ä½¿ç”¨å•çº¿ç¨‹äº†ï¼æ‰€æœ‰å°±ä½¿ç”¨äº†å•çº¿ç¨‹äº†ï¼</p><p> Redis æ˜¯C è¯­è¨€å†™çš„ï¼Œå®˜æ–¹æä¾›çš„æ•°æ®ä¸º 100000+ çš„QPSï¼Œå®Œå…¨ä¸æ¯”åŒæ ·æ˜¯ä½¿ç”¨ key-valeçš„ Memecacheå·®ï¼ </p><h3 id="Rediså•çº¿ç¨‹ä¸ºä»€ä¹ˆè¿˜è¿™ä¹ˆå¿«ï¼Ÿ"><a href="#Rediså•çº¿ç¨‹ä¸ºä»€ä¹ˆè¿˜è¿™ä¹ˆå¿«ï¼Ÿ" class="headerlink" title="Rediså•çº¿ç¨‹ä¸ºä»€ä¹ˆè¿˜è¿™ä¹ˆå¿«ï¼Ÿ"></a>Rediså•çº¿ç¨‹ä¸ºä»€ä¹ˆè¿˜è¿™ä¹ˆå¿«ï¼Ÿ</h3><p>äº†è§£è®¡ç®—æœºåŸç†çš„åº”è¯¥çŸ¥é“   CPU &gt;  å†…å­˜ &gt; ç£ç›˜</p><p><strong>æ ¸å¿ƒï¼šredis æ˜¯å°†æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥è¯´ä½¿ç”¨å•çº¿ç¨‹å»æ“ä½œæ•ˆç‡å°±æ˜¯æœ€é«˜çš„ï¼Œå¤šçº¿ç¨‹ ï¼ˆCPUä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ï¼šè€—æ—¶çš„æ“ä½œï¼ï¼ï¼ï¼‰ï¼Œå¯¹äºå†…å­˜ç³»ç»Ÿæ¥è¯´ï¼Œå¦‚æœæ²¡æœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢æ•ˆç‡å°±æ˜¯æœ€é«˜ çš„ï¼å¤šæ¬¡è¯»å†™éƒ½æ˜¯åœ¨ä¸€ä¸ªCPUä¸Šçš„ï¼Œåœ¨å†…å­˜æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå°±æ˜¯æœ€ä½³çš„æ–¹æ¡ˆï¼</strong></p><h2 id="äº”å¤§ç±»å‹"><a href="#äº”å¤§ç±»å‹" class="headerlink" title="äº”å¤§ç±»å‹"></a>äº”å¤§ç±»å‹</h2><blockquote><p>å®˜æ–¹æ–‡æ¡£è¯´æ˜</p></blockquote><p> Redis æ˜¯ä¸€ä¸ªå¼€æºï¼ˆBSDè®¸å¯ï¼‰çš„ï¼Œå†…å­˜ä¸­çš„æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒå¯ä»¥ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚ å®ƒæ”¯æŒå¤šç§ç±»å‹çš„æ•°æ®ç»“æ„ï¼Œå¦‚ <a href="http://www.redis.cn/topics/data-types-intro.html#strings">å­—ç¬¦ä¸²ï¼ˆstringsï¼‰</a>ï¼Œ <a href="http://www.redis.cn/topics/data-types-intro.html#hashes">æ•£åˆ—ï¼ˆhashesï¼‰</a>ï¼Œ <a href="http://www.redis.cn/topics/data-types-intro.html#lists">åˆ—è¡¨ï¼ˆlistsï¼‰</a>ï¼Œ <a href="http://www.redis.cn/topics/data-types-intro.html#sets">é›†åˆï¼ˆsetsï¼‰</a>ï¼Œ <a href="http://www.redis.cn/topics/data-types-intro.html#sorted-sets">æœ‰åºé›†åˆï¼ˆsorted setsï¼‰</a> ä¸èŒƒå›´æŸ¥è¯¢ï¼Œ <a href="http://www.redis.cn/topics/data-types-intro.html#bitmaps">bitmaps</a>ï¼Œ <a href="http://www.redis.cn/topics/data-types-intro.html#hyperloglogs">hyperloglogs</a> å’Œ <a href="http://www.redis.cn/commands/geoadd.html">åœ°ç†ç©ºé—´ï¼ˆgeospatialï¼‰</a> ç´¢å¼•åŠå¾„æŸ¥è¯¢ã€‚ Redis å†…ç½®äº† <a href="http://www.redis.cn/topics/replication.html">å¤åˆ¶ï¼ˆreplicationï¼‰</a>ï¼Œ<a href="http://www.redis.cn/commands/eval.html">LUAè„šæœ¬ï¼ˆLua scriptingï¼‰</a>ï¼Œ <a href="http://www.redis.cn/topics/lru-cache.html">LRUé©±åŠ¨äº‹ä»¶ï¼ˆLRU evictionï¼‰</a>ï¼Œ<a href="http://www.redis.cn/topics/transactions.html">äº‹åŠ¡ï¼ˆtransactionsï¼‰</a> å’Œä¸åŒçº§åˆ«çš„ <a href="http://www.redis.cn/topics/persistence.html">ç£ç›˜æŒä¹…åŒ–ï¼ˆpersistenceï¼‰</a>ï¼Œ å¹¶é€šè¿‡ <a href="http://www.redis.cn/topics/sentinel.html">Rediså“¨å…µï¼ˆSentinelï¼‰</a>å’Œè‡ªåŠ¨ <a href="http://www.redis.cn/topics/cluster-tutorial.html">åˆ†åŒºï¼ˆClusterï¼‰</a>æä¾›é«˜å¯ç”¨æ€§ï¼ˆhigh availabilityï¼‰ã€‚ </p><blockquote><p>ä¸‹é¢å‘½ä»¤éœ€è¦æˆ‘ä»¬è®°ä½ï¼Œç°åœ¨æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„spring bootï¼ŒJedisæ–¹æ³•åŸºæœ¬éƒ½æ˜¯è¿™äº›å‘½ä»¤</p></blockquote><h3 id="RedisåŸºæœ¬æ“ä½œ"><a href="#RedisåŸºæœ¬æ“ä½œ" class="headerlink" title="RedisåŸºæœ¬æ“ä½œ"></a>RedisåŸºæœ¬æ“ä½œ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æŸ¥è¯¢æ‰€æœ‰key</span><br>127.0.0.1:6379&gt; KEYS * <br>(empty array)<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-built_in">set</span> key</span><br>127.0.0.1:6379&gt; SET name pudewu<br>OK<br><br><br>127.0.0.1:6379&gt; KEYS * <br>1) &quot;name&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">åˆ¤æ–­keyå€¼æ˜¯ä¸æ˜¯å­˜åœ¨</span><br>127.0.0.1:6379&gt; EXISTS name<br>(integer) 1<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> ç§»é™¤å½“å‰çš„key</span><br>127.0.0.1:6379&gt; MOVE name 1<br>(integer) 1<br><br><br>127.0.0.1:6379&gt; KEYS *<br>(empty array)<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è·å–key</span><br>127.0.0.1:6379&gt; get name<br>&quot;pudewu&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´ï¼Œå•ä½æ˜¯ç§’</span><br>127.0.0.1:6379&gt; EXPIRE name 20<br>(integer) 1<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æŸ¥çœ‹å½“å‰keyçš„å‰©ä½™æ—¶é—´</span><br>127.0.0.1:6379&gt; TTL name<br>(integer) 17<br>127.0.0.1:6379&gt; TTL name<br>(integer) 13<br>127.0.0.1:6379&gt; TTL name<br>(integer) 12<br>127.0.0.1:6379&gt; TTL name<br>(integer) 11<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹keyçš„ç±»å‹</span><br>127.0.0.1:6379&gt; type name<br>string<br></code></pre></td></tr></table></figure><p><strong>å¦‚æœå¯¹æœ‰äº›å‘½ä»¤ä¸ä¼šçš„å¯ä»¥åœ¨å®˜ç½‘æŸ¥çœ‹å¸®åŠ©å‘½ä»¤</strong></p><h3 id="Stringï¼ˆå­—ç¬¦ä¸²ï¼‰"><a href="#Stringï¼ˆå­—ç¬¦ä¸²ï¼‰" class="headerlink" title="Stringï¼ˆå­—ç¬¦ä¸²ï¼‰"></a>Stringï¼ˆå­—ç¬¦ä¸²ï¼‰</h3><p>ç›¸ä¿¡è¿™ä¸ªå‘½ä»¤æ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨åˆ°çš„</p><blockquote><p>æ·»åŠ Keyï¼Œè·å–Key</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; SET k2 v2<br>OK<br>127.0.0.1:6379&gt; GET k2<br>&quot;v2&quot;<br>127.0.0.1:6379&gt; EXISTS k2<br>(integer) 1<br>127.0.0.1:6379&gt; APPEND k2 &quot;hello&quot;<br>(integer) 7<br>127.0.0.1:6379&gt; get k2<br>&quot;v2hello&quot;<br>127.0.0.1:6379&gt; STRLEN k2<br>(integer) 7<br>127.0.0.1:6379&gt; APPEND k2 &quot;rediså­¦ä¹ &quot;<br>(integer) 18<br>127.0.0.1:6379&gt; STRLEN k2<br>(integer) 18<br>127.0.0.1:6379&gt; GET k2<br>&quot;v2helloredis\xe5\xad\xa6\xe4\xb9\xa0&quot;<br></code></pre></td></tr></table></figure><blockquote><p>Stringè‡ªå¢è‡ªå‡</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">è®¾ç½®é»˜è®¤å€¼ä¸º0</span><br>127.0.0.1:6379&gt; set number 0<br>OK<br>127.0.0.1:6379&gt; get number<br>&quot;0&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è‡ªå¢1</span><br>127.0.0.1:6379&gt; INCR number <br>(integer) 1<br>127.0.0.1:6379&gt; INCR number <br>(integer) 2<br>127.0.0.1:6379&gt; INCR number <br>(integer) 3<br>127.0.0.1:6379&gt; INCR number <br>(integer) 4<br>127.0.0.1:6379&gt; get number<br>&quot;4&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è‡ªå‡1</span><br>127.0.0.1:6379&gt; DECR number <br>(integer) 3<br>127.0.0.1:6379&gt; DECR number <br>(integer) 2<br>127.0.0.1:6379&gt; DECR number <br>(integer) 1<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è‡ªå®šä¹‰ å¢åŠ å€¼</span><br>127.0.0.1:6379&gt; INCRBY number 10<br>(integer) 11<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è‡ªå®šä¹‰ å‡å€¼</span><br>127.0.0.1:6379&gt; DECRBY number 5<br>(integer) 6<br></code></pre></td></tr></table></figure><blockquote><p>å­—ç¬¦ä¸²èŒƒå›´</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è®¾ç½® keyçš„å€¼</span><br>127.0.0.1:6379&gt; set key &quot;hello redis&quot;<br>OK<br>127.0.0.1:6379&gt; get key1<br>(nil)<br>127.0.0.1:6379&gt; get key<br>&quot;hello redis&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æˆªå–å­—ç¬¦ä¸² [0,3]</span><br>127.0.0.1:6379&gt; GETRANGE key 0 3<br>&quot;hell&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> è·å–å…¨éƒ¨çš„å­—ç¬¦ä¸² å’Œ get keyæ˜¯ä¸€æ ·çš„</span><br>127.0.0.1:6379&gt; GETRANGE key 0 -1<br>&quot;hello redis&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æ›¿æ¢ï¼</span><br>127.0.0.1:6379&gt; set key2 &quot;redis fast&quot;<br>OK<br>127.0.0.1:6379&gt; get key2<br>&quot;redis fast&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æ›¿æ¢æŒ‡å®šä½ç½®å¼€å§‹çš„å­—ç¬¦ä¸²ï¼</span><br>127.0.0.1:6379&gt; SETRANGE key2 1 realy<br>(integer) 10<br>127.0.0.1:6379&gt; get key2<br>&quot;rrealyfast&quot;<br></code></pre></td></tr></table></figure><blockquote><p> è®¾ç½®è¿‡æœŸæ—¶é—´ </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> setex (<span class="hljs-built_in">set</span> with expire) <span class="hljs-comment"># è®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="hljs-meta">#</span><span class="bash"> setnx (<span class="hljs-built_in">set</span> <span class="hljs-keyword">if</span> not exist) <span class="hljs-comment"># ä¸å­˜åœ¨åœ¨è®¾ç½® ï¼ˆåœ¨åˆ†å¸ƒå¼é”ä¸­ä¼šå¸¸å¸¸ä½¿ç”¨ï¼ï¼‰</span></span><br>127.0.0.1:6379&gt; setex key3 30 &quot;hello&quot; # è®¾ç½®key3 çš„å€¼ä¸º hello,30ç§’åè¿‡æœŸ<br>OK<br>127.0.0.1:6379&gt; ttl key3<br>(integer) 26<br>127.0.0.1:6379&gt; get key3<br>&quot;hello&quot;<br>127.0.0.1:6379&gt; setnx mykey &quot;redis&quot; # å¦‚æœmykey ä¸å­˜åœ¨ï¼Œåˆ›å»ºmykey<br>(integer) 1<br>127.0.0.1:6379&gt; keys *<br>1) &quot;key2&quot;<br>2) &quot;mykey&quot;<br>3) &quot;key1&quot;<br>127.0.0.1:6379&gt; ttl key3<br>(integer) -2<br>127.0.0.1:6379&gt; setnx mykey &quot;MongoDB&quot; # å¦‚æœmykeyå­˜åœ¨ï¼Œåˆ›å»ºå¤±è´¥ï¼<br>(integer) 0<br>127.0.0.1:6379&gt; get mykey<br>&quot;redis&quot;<br></code></pre></td></tr></table></figure><blockquote><p>mset mget</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; mset k1 v1 k2 v2 k3 v3 # åŒæ—¶è®¾ç½®å¤šä¸ªå€¼<br>OK<br>127.0.0.1:6379&gt; keys *<br>1) &quot;k1&quot;<br>2) &quot;k2&quot;<br>3) &quot;k3&quot;<br>127.0.0.1:6379&gt; mget k1 k2 k3 # åŒæ—¶è·å–å¤šä¸ªå€¼<br>1) &quot;v1&quot;<br>2) &quot;v2&quot;<br>3) &quot;v3&quot;<br>127.0.0.1:6379&gt; msetnx k1 v1 k4 v4 # msetnx æ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·<br>å¤±è´¥ï¼<br>(integer) 0<br>127.0.0.1:6379&gt; get k4<br>(nil)<br><span class="hljs-meta">#</span><span class="bash"> å¯¹è±¡</span><br>set user:1 &#123;name:zhangsan,age:3&#125; # è®¾ç½®ä¸€ä¸ªuser:1 å¯¹è±¡ å€¼ä¸º jsonå­—ç¬¦æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡ï¼<br><span class="hljs-meta">#</span><span class="bash"> è¿™é‡Œçš„keyæ˜¯ä¸€ä¸ªå·§å¦™çš„è®¾è®¡ï¼š user:&#123;id&#125;:&#123;filed&#125; , å¦‚æ­¤è®¾è®¡åœ¨Redisä¸­æ˜¯å®Œå…¨OKäº†ï¼</span><br>127.0.0.1:6379&gt; mset user:1:name zhangsan user:1:age 2<br>OK<br>127.0.0.1:6379&gt; mget user:1:name user:1:age<br>1) &quot;zhangsan&quot;<br>2) &quot;2&quot;<br></code></pre></td></tr></table></figure><blockquote><p><strong>getset</strong> </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; getset db redis # å¦‚æœä¸å­˜åœ¨å€¼ï¼Œåˆ™è¿”å› nil<br>(nil)<br>127.0.0.1:6379&gt; get db<br>&quot;redis<br>127.0.0.1:6379&gt; getset db mongodb # å¦‚æœå­˜åœ¨å€¼ï¼Œè·å–åŸæ¥çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼<br>&quot;redis&quot;<br>127.0.0.1:6379&gt; get db<br>&quot;mongodb&quot;<br></code></pre></td></tr></table></figure><h3 id="List-åˆ—è¡¨"><a href="#List-åˆ—è¡¨" class="headerlink" title="List(åˆ—è¡¨)"></a>List(åˆ—è¡¨)</h3><p> åœ¨redisé‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠlistç©æˆ ï¼Œæ ˆã€é˜Ÿåˆ—ã€é˜»å¡é˜Ÿåˆ—ï¼ æ‰€æœ‰çš„listå‘½ä»¤éƒ½æ˜¯ç”¨lå¼€å¤´çš„ï¼ŒRedisä¸åŒºåˆ†å¤§å°å‘½ä»¤  </p><blockquote><p>lrange list 0 -1 æŸ¥è¯¢listä¸­æ‰€æœ‰ </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ ï¼ˆå·¦ï¼‰</span><br>127.0.0.1:6379&gt; lpush list one<br><br>127.0.0.1:6379&gt; lpush list two<br><br>127.0.0.1:6379&gt; lpush list three<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> 0 -1 è¡¨ç¤ºæŸ¥è¯¢å½“å‰keyä¸‹æ‰€æœ‰å€¼</span><br>127.0.0.1:6379&gt; lrange list 0 -1<br><br>1) &quot;three&quot;<br>2) &quot;two&quot;<br>3) &quot;one&quot;<br></code></pre></td></tr></table></figure><blockquote><p> RPushå°†ä¸€ä¸ªå€¼æˆ–å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨ä½éƒ¨(å³) </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; Rpush list righr<br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;three&quot;<br>2) &quot;two&quot;<br>3) &quot;one&quot;<br>4) &quot;righr&quot;<br></code></pre></td></tr></table></figure><blockquote><p><strong>Lpopå·¦ç§»é™¤åˆ—è¡¨</strong>  <strong>Rpopå³ç§»é™¤åˆ—è¡¨</strong></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ </span><br>127.0.0.1:6379&gt; Lpop list<br>&quot;three&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">ç§»é™¤æœ€åä¸€ä¸ªå…ƒç´ </span><br>127.0.0.1:6379&gt; Rpop list<br>&quot;righr&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æŸ¥è¯¢listä¸­æ‰€æœ‰æ•°æ®</span><br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;two&quot;<br>2) &quot;one&quot;<br></code></pre></td></tr></table></figure><blockquote><h3 id="Lindex"><a href="#Lindex" class="headerlink" title="Lindex"></a>Lindex</h3></blockquote><p>é€šè¿‡ä¸‹è¡¨è·å¾—listä¸­çš„æŸä¸€ä¸ªå€¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; lindex list 1<br>&quot;one&quot;<br></code></pre></td></tr></table></figure><blockquote><p> Llenè·å–åˆ—è¡¨é•¿åº¦ </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; llen list<br>(integer) 4<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æŒ‡å®šç§»é™¤åˆ—</span>   <br>127.0.0.1:6379&gt; lrem list 1 one<br></code></pre></td></tr></table></figure><blockquote><p>å°ç»“</p></blockquote><ul><li>ä»–å®é™…ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œbefore Node after ï¼Œ leftï¼Œright éƒ½å¯ä»¥æ’å…¥å€¼</li><li>å¦‚æœkey ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„é“¾è¡¨</li><li>å¦‚æœkeyå­˜åœ¨ï¼Œæ–°å¢å†…å®¹</li><li>å¦‚æœç§»é™¤äº†æ‰€æœ‰å€¼ï¼Œç©ºé“¾è¡¨ï¼Œä¹Ÿä»£è¡¨ä¸å­˜åœ¨ï¼</li><li>åœ¨ä¸¤è¾¹æ’å…¥æˆ–è€…æ”¹åŠ¨å€¼ï¼Œæ•ˆç‡æœ€é«˜ï¼ ä¸­é—´å…ƒç´ ï¼Œç›¸å¯¹æ¥è¯´æ•ˆç‡ä¼šä½ä¸€ç‚¹~</li></ul><p><strong>åœ¨ä¸¤è¾¹æ’å…¥æˆ–è€…æ”¹åŠ¨å€¼ï¼Œæ•ˆç‡æœ€é«˜ï¼ ä¸­é—´å…ƒç´ ï¼Œç›¸å¯¹æ¥è¯´æ•ˆç‡ä¼šä½ä¸€ç‚¹~</strong></p><h3 id="Set-é›†åˆ"><a href="#Set-é›†åˆ" class="headerlink" title="Set(é›†åˆ)"></a>Set(é›†åˆ)</h3><p> setä¸­çš„å€¼ä¸èƒ½é‡å¤,æ— åº </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># seté›†åˆä¸­æ·»åŠ å…ƒç´   SADD</span></span><br>127.0.0.1:6379&gt; sadd myset &quot;hello set&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æŸ¥è¯¢<span class="hljs-built_in">set</span>ä¸­æ‰€æœ‰å…ƒç´  SMEMBERS</span> <br>127.0.0.1:6379&gt; Smembers myset<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> SISMEMBER æŸ¥è¯¢<span class="hljs-built_in">set</span>ä¸­æŸä¸ªå€¼æ˜¯å¦å­˜åœ¨</span><br>127.0.0.1:6379&gt; SISMEMBER myset hello<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è·å–Setä¸­é›†åˆå…ƒç´ ä¸ªæ•°</span><br>127.0.0.1:6379&gt; scard myset<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">rem ç§»é™¤<span class="hljs-built_in">set</span>ä¸­å…ƒç´ </span><br>127.0.0.1:6379&gt; srem myset yes<br>(integer) 1<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> SRANDMEMBER éšæœºæŠ½å–<span class="hljs-built_in">set</span>é›†åˆä¸­æ•°æ®</span><br>127.0.0.1:6379&gt; SRANDMEMBER myset<br><br><br>==============================================================================<br>åˆ é™¤æŒ‡å®šSetæ•°æ®ã€éšæœºåˆ é™¤Setæ•°æ®<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">SMOVE  å°†ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œç§»åŠ¨åˆ°å¦ä¸€ä¸ª<span class="hljs-built_in">set</span>å€¼ä¸­</span><br>127.0.0.1:6379&gt; smove myset myset2 &quot;dewu1&quot;    <br><br><br>==============================================================================<br>æ•°å­—é›†åˆç±»ï¼š<br>- å·®é›† SDIFF<br>- äº¤é›†<br>- å¹¶é›†<br><br>127.0.0.1:6379&gt; SDIFF key1 key2  # å·®é›†<br><br>127.0.0.1:6379&gt; SINTER key1 key2 # äº¤é›† å…±åŒå¥½å‹å°±å¯ä»¥è¿™æ ·å®ç°<br><br>127.0.0.1:6379&gt; SUNION key1 key2 # å¹¶é›†<br></code></pre></td></tr></table></figure><h3 id="Hash-å“ˆå¸Œ"><a href="#Hash-å“ˆå¸Œ" class="headerlink" title="Hash(å“ˆå¸Œ)"></a>Hash(å“ˆå¸Œ)</h3><p> <strong>Mapé›†åˆï¼Œkey-map! æ—¶å€™è¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªmapé›†åˆï¼ æœ¬è´¨å’ŒStringç±»å‹æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œè¿˜æ˜¯ä¸€ä¸ªç®€å•çš„ key-vlaueï¼</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># æ·»åŠ hashå€¼  hset</span></span><br>127.0.0.1:6379&gt; hset myhash field kuangshen<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> è·å–<span class="hljs-built_in">hash</span>å€¼  hget</span><br>127.0.0.1:6379&gt; hget myhash field<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">set</span>å¤šä¸ª key-vlaue</span><br>127.0.0.1:6379&gt; hmset myhash field1 hello field2 world<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è·å–å¤šä¸ª<span class="hljs-built_in">hash</span>å€¼</span><br>127.0.0.1:6379&gt; hmget myhash field1 field2<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è·å–æ‰€æœ‰<span class="hljs-built_in">hash</span>ä¸­çš„å€¼</span><br>127.0.0.1:6379&gt;  hgetall myhash<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">åˆ é™¤<span class="hljs-built_in">hash</span>æ“ä½œ  hdel</span><br>127.0.0.1:6379&gt; hdel myhash field1<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> åªè·å¾—æ‰€æœ‰field</span><br><span class="hljs-meta">#</span><span class="bash"> åªè·å¾—æ‰€æœ‰value</span><br>127.0.0.1:6379&gt; hkeys myhash # åªè·å¾—æ‰€æœ‰field<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">åªè·å¾—æ‰€æœ‰value</span><br>127.0.0.1:6379&gt; hvals myhash<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">incr decr</span><br>127.0.0.1:6379&gt; hset myhash field3 5 #æŒ‡å®šå¢é‡ï¼<br>127.0.0.1:6379&gt; HINCRby myhash field3 1<br>127.0.0.1:6379&gt; hincrby myhash field3 -1<br><br>127.0.0.1:6379&gt; hsetnx myhash field4 hello # å¦‚æœä¸å­˜åœ¨åˆ™å¯ä»¥è®¾ç½®<br>127.0.0.1:6379&gt; hsetnx myhash field4 world # å¦‚æœå­˜åœ¨åˆ™ä¸èƒ½è®¾ç½®<br></code></pre></td></tr></table></figure><p> <strong>hashå˜æ›´çš„æ•°æ® user name age,å°¤å…¶æ˜¯æ˜¯ç”¨æˆ·ä¿¡æ¯ä¹‹ç±»çš„ï¼Œç»å¸¸å˜åŠ¨çš„ä¿¡æ¯ï¼ hash æ›´é€‚åˆäºå¯¹è±¡çš„ å­˜å‚¨ï¼ŒStringæ›´åŠ é€‚åˆå­—ç¬¦ä¸²å­˜å‚¨ï¼</strong> </p><h3 id="Zset-æœ‰åºé›†åˆ"><a href="#Zset-æœ‰åºé›†åˆ" class="headerlink" title="Zset(æœ‰åºé›†åˆ)"></a>Zset(æœ‰åºé›†åˆ)</h3><p> <strong>åœ¨setåŸºç¡€ä¸Šå¢åŠ äº†ä¸€ä¸ªå€¼ï¼Œset k1 v1   zset k1 score1  v1</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æ·»åŠ æœ‰åºé›†åˆ</span><br>127.0.0.1:6379&gt; zadd dewu 1 redis<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">å¤šä¸ªæ·»åŠ </span><br>127.0.0.1:6379&gt; zadd dewu 2 two 3 three<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æŸ¥è¯¢é›†åˆå…ƒç´ </span><br>127.0.0.1:6379&gt; zrange dewu 0 -1<br><br><br>=====================================================<br>æ’åºå¦‚ä½•å®ç°<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æ·»åŠ ä¸‰ä¸ªç”¨æˆ·</span><br>127.0.0.1:6379&gt; zadd salary 2500 xiaoming <br>(integer) 1<br>127.0.0.1:6379&gt; zadd salary 3000 xiaohong <br>(integer) 1<br>127.0.0.1:6379&gt; zadd salary 3500 zhangsan<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> ZRANGEBYSCORE key min max</span><br>127.0.0.1:6379&gt;  ZRANGEBYSCORE salary -inf +inf<br>1) &quot;xiaoming&quot;<br>2) &quot;xiaohong&quot;<br>3) &quot;zhangsan&quot;  # æ˜¾ç¤ºå…¨éƒ¨çš„ç”¨æˆ· ä»å°åˆ°å¤§ï¼<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">ä»å¤§åˆ°å°æ’åº</span><br>127.0.0.1:6379&gt; zrevrange salary 0 -1<br>1) &quot;zhangsan&quot;<br>2) &quot;xiaohong&quot;<br>3) &quot;xiaoming&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æ˜¾ç¤ºå…¨éƒ¨ç”¨æˆ·å¹¶ä¸”é™„å¸¦æˆç»©</span><br>127.0.0.1:6379&gt; ZRANGEBYSCORE salary -inf +inf withscores<br>1) &quot;xiaoming&quot;<br>2) &quot;2500&quot;<br>3) &quot;xiaohong&quot;<br>4) &quot;3000&quot;<br>5) &quot;zhangsan&quot;<br>6) &quot;3500&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">æ˜¾ç¤ºå·¥èµ„å°äº2500çš„å‘˜å·¥å‡åºæ’åº</span><br>127.0.0.1:6379&gt; ZRANGEBYSCORE salary -inf 2500 withscores<br>1) &quot;xiaoming&quot;<br>2) &quot;2500&quot;<br><br><br>=================================================================<br><span class="hljs-meta">#</span><span class="bash"> ç§»é™¤remä¸­çš„å…ƒç´ </span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">ç§»é™¤é›†åˆä¸­æŒ‡å®šå…ƒç´ </span><br>127.0.0.1:6379&gt; zrem salary xiaoming<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è·å–æœ‰åºé›†åˆä¸­çš„ä¸ªæ•°</span><br>127.0.0.1:6379&gt; zcard salary<br><br>==================================================================<br><br>127.0.0.1:6379&gt; zadd xiaolong 1 hello<br>127.0.0.1:6379&gt; zadd xiaolong 2 world 3 kuangsheng<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">è·å–æŒ‡å®šåŒºé—´çš„æˆå‘˜æ•°é‡ï¼</span><br>127.0.0.1:6379&gt; zcount xiaolong 1 3<br> <br></code></pre></td></tr></table></figure><p>å‚è€ƒï¼š<a href="https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=8440565446323209776&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1S54y1R7SB?from=search&amp;seid=8440565446323209776&amp;spm_id_from=333.337.0.0</a></p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootæ•´åˆFlowableå·¥ä½œæµ(1)</title>
    <link href="/2021/09/17/SpringBoot%E6%95%B4%E5%90%88Flowable%E5%B7%A5%E4%BD%9C%E6%B5%81/"/>
    <url>/2021/09/17/SpringBoot%E6%95%B4%E5%90%88Flowable%E5%B7%A5%E4%BD%9C%E6%B5%81/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Flowableæµç¨‹å›¾"><a href="#Flowableæµç¨‹å›¾" class="headerlink" title="Flowableæµç¨‹å›¾"></a>Flowableæµç¨‹å›¾</h1><h3 id="Flowableæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Flowableæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Flowableæ˜¯ä»€ä¹ˆï¼Ÿ"></a>Flowableæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p> Flowableæ˜¯ä¸€ä¸ªä½¿ç”¨Javaç¼–å†™çš„è½»é‡çº§ä¸šåŠ¡æµç¨‹å¼•æ“ã€‚Flowableæµç¨‹å¼•æ“å¯ç”¨äºéƒ¨ç½²BPMN 2.0æµç¨‹å®šä¹‰ï¼ˆç”¨äºå®šä¹‰æµç¨‹çš„è¡Œä¸šXMLæ ‡å‡†ï¼‰ï¼Œ åˆ›å»ºè¿™äº›æµç¨‹å®šä¹‰çš„æµç¨‹å®ä¾‹ï¼Œè¿›è¡ŒæŸ¥è¯¢ï¼Œè®¿é—®è¿è¡Œä¸­æˆ–å†å²çš„æµç¨‹å®ä¾‹ä¸ç›¸å…³æ•°æ®ï¼Œç­‰ç­‰ã€‚</p><p> Flowableå¯ä»¥ååˆ†çµæ´»åœ°åŠ å…¥ä½ çš„åº”ç”¨/æœåŠ¡/æ„æ¶ã€‚å¯ä»¥å°†JARå½¢å¼å‘å¸ƒçš„Flowableåº“åŠ å…¥åº”ç”¨æˆ–æœåŠ¡ï¼Œæ¥<em>åµŒå…¥</em>å¼•æ“ã€‚ ä»¥JARå½¢å¼å‘å¸ƒä½¿Flowableå¯ä»¥è½»æ˜“åŠ å…¥ä»»ä½•Javaç¯å¢ƒï¼šJava SEï¼›Tomcatã€Jettyæˆ–Springä¹‹ç±»çš„servletå®¹å™¨ï¼›JBossæˆ–WebSphereä¹‹ç±»çš„Java EEæœåŠ¡å™¨ï¼Œç­‰ç­‰ã€‚ å¦å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Flowable REST APIè¿›è¡ŒHTTPè°ƒç”¨ã€‚ä¹Ÿæœ‰è®¸å¤šFlowableåº”ç”¨ï¼ˆFlowable Modeler, Flowable Admin, Flowable IDM ä¸ Flowable Taskï¼‰ï¼Œæä¾›äº†ç›´æ¥å¯ç”¨çš„UIç¤ºä¾‹ï¼Œå¯ä»¥ä½¿ç”¨æµç¨‹ä¸ä»»åŠ¡ã€‚ </p> <span id="more"></span><p>Flowableæµç¨‹éœ€è¦å…ˆç”»æµç¨‹å›¾ï¼Œç„¶åå†æ ¹æ®æµç¨‹å›¾å¼•ç”¨è‡ªé¡¹ç›®ä¸­ï¼Œæ‰€ä»¥ä»¥ä¸‹å…ˆç”»å¥½æµç¨‹å›¾ï¼Œç„¶åå†è¿›è¡Œé›†æˆSpring bootç”Ÿæˆ</p><blockquote><p>éƒ¨ç½²FlowableUi</p></blockquote><ol><li><p>å®˜æ–¹ç½‘å€ä¸‹è½½FlowableUIï¼š<a href="https://flowable.com/open-source/downloads/">https://flowable.com/open-source/downloads/</a></p></li><li><p>å°†ä¸‹è½½å¥½ä¹‹åçš„å‹ç¼©åŒ…è¿›è¡Œè§£å‹è¿›å…¥æ–‡ä»¶å¤¹ä¹‹åä¼šçœ‹åˆ°ä¸€ä¸ªwaråŒ…æ–‡ä»¶ä¸‹ï¼Œæ‰“å¼€æ–‡ä»¶å¤¹å°†ä¼šæœ‰ä¸€ä¸ªï¼ˆflowable-ui.warï¼‰æ–‡ä»¶</p></li><li><p>å®‰è£…éƒ¨ç½²Tomcatï¼Œå®‰è£…éƒ¨ç½²å°±ç•¥è¿‡äº†ç™¾åº¦éƒ½æœ‰ï¼Œå°†ä¸Šé¢çš„waråŒ…æ”¾å…¥tomcatçš„webappsç›®å½•ä¸‹ï¼Œå¹¶åœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">java </span>-<span class="hljs-keyword">jar </span>flowable-ui.war<br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨ä¹‹åï¼Œæœ‰ä¸€è¡Œæ—¥å¿—ï¼šTomcat started on port(s): 8080 (http) with context path â€˜/flowable-uiâ€™ï¼Œä»ä»¥ä¸Šå¯ä»¥çœ‹å‡ºç«¯å£é»˜è®¤ä¸º8080ï¼Œè·¯å¾„ä¸ºï¼š/flowable-ui ã€‚å³è®¿é—®ï¼š<a href="http://localhost:8080/flowable-ui%EF%BC%8C">http://localhost:8080/flowable-uiï¼Œ</a></p><p>  è´¦å·ï¼šadmin å¯†ç ï¼štest </p></li></ol><blockquote><p>ç”»æµç¨‹å›¾</p></blockquote><p><strong>ç™»å½•ä¹‹å</strong> </p><p>![](/img/work/ <a href="https://res.cloudinary.com/dlzf16hlo/image/upload/v1632027508/blog/1632027486_1_qqpru0.png">https://res.cloudinary.com/dlzf16hlo/image/upload/v1632027508/blog/1632027486_1_qqpru0.png</a> )</p><p><strong>é€‰æ‹©å»ºæ¨¡å™¨åº”ç”¨ç¨‹åº</strong></p>]]></content>
    
    
    <categories>
      
      <category>SpringBoot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
